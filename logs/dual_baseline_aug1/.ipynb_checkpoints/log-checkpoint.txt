====> load config from dual_baseline_aug1
====> set seed 42
====> /datasets/aicitychallenge2023/train.json data load, ids: 2055
====> /datasets/aicitychallenge2023/test-tracks.json data load, ids: 10424
====> SSM Siamese Collator:
====> Using visual backbone: SiameseLocalandMotionModelBIG_DualTextCat
Loaded pretrained weights for efficientnet-b2
Loaded pretrained weights for efficientnet-b2
====> load checkpoint from default
===> Building meters
DataParallel
4
Epoch: [0][ 1/32]	Time 22.414 (22.414)	Data 18.870 (18.870)	Loss 1.2485e+01 (1.2485e+01)	Clip_Loss 1.2485e+01 (1.2485e+01)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 5.9259 (5.9259)	Acc@5 6.2500 (6.2500)	Acc@10 9.3750 (9.3750)
Epoch: [0][21/32]	Time  0.625 ( 3.542)	Data  0.007 ( 2.785)	Loss 1.2426e+01 (1.2469e+01)	Clip_Loss 1.2426e+01 (1.2469e+01)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 11.6904 (8.9675)	Acc@5 17.1875 (11.1607)	Acc@10 35.9375 (20.1637)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 0 running time:  0:02:45.272471
===> Building meters
DataParallel
4
Epoch: [1][33/32]	Time 12.996 (12.996)	Data 12.384 (12.384)	Loss 1.2273e+01 (1.2273e+01)	Clip_Loss 1.2273e+01 (1.2273e+01)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 12.6083 (12.6083)	Acc@5 18.7500 (18.7500)	Acc@10 31.2500 (31.2500)
Epoch: [1][53/32]	Time  0.613 ( 2.389)	Data  0.007 ( 1.785)	Loss 1.2169e+01 (1.2193e+01)	Clip_Loss 1.2169e+01 (1.2193e+01)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 13.7777 (13.2826)	Acc@5 17.1875 (17.4107)	Acc@10 28.1250 (30.8780)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_1.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_1.pth
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 1 running time:  0:02:43.225910
===> Building meters
DataParallel
4
Epoch: [2][65/32]	Time 12.714 (12.714)	Data 12.115 (12.115)	Loss 1.1702e+01 (1.1702e+01)	Clip_Loss 1.1702e+01 (1.1702e+01)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 16.9812 (16.9812)	Acc@5 18.7500 (18.7500)	Acc@10 37.5000 (37.5000)
Epoch: [2][85/32]	Time  0.627 ( 2.274)	Data  0.008 ( 1.671)	Loss 1.1593e+01 (1.1750e+01)	Clip_Loss 1.1593e+01 (1.1750e+01)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 21.1769 (16.6897)	Acc@5 29.6875 (23.4375)	Acc@10 42.1875 (39.4345)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 2 running time:  0:01:45.512147
===> Building meters
DataParallel
4
Epoch: [3][97/32]	Time 12.972 (12.972)	Data 12.358 (12.358)	Loss 1.1006e+01 (1.1006e+01)	Clip_Loss 1.1006e+01 (1.1006e+01)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 20.6748 (20.6748)	Acc@5 40.6250 (40.6250)	Acc@10 57.8125 (57.8125)
Epoch: [3][117/32]	Time  0.649 ( 2.256)	Data  0.008 ( 1.648)	Loss 1.1245e+01 (1.1136e+01)	Clip_Loss 1.1245e+01 (1.1136e+01)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 17.4759 (21.9139)	Acc@5 26.5625 (33.9286)	Acc@10 43.7500 (52.5298)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 3 running time:  0:02:05.176962
===> Building meters
DataParallel
4
Epoch: [4][129/32]	Time 13.586 (13.586)	Data 12.963 (12.963)	Loss 1.0777e+01 (1.0777e+01)	Clip_Loss 1.0777e+01 (1.0777e+01)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 22.3056 (22.3056)	Acc@5 32.8125 (32.8125)	Acc@10 50.0000 (50.0000)
Epoch: [4][149/32]	Time  0.590 ( 2.286)	Data  0.007 ( 1.682)	Loss 1.0755e+01 (1.0935e+01)	Clip_Loss 1.0755e+01 (1.0935e+01)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 24.2361 (22.4396)	Acc@5 40.6250 (32.2173)	Acc@10 53.1250 (52.6786)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 4 running time:  0:02:04.259225
===> Building meters
DataParallel
4
Epoch: [5][161/32]	Time 11.791 (11.791)	Data 11.157 (11.157)	Loss 1.0376e+01 (1.0376e+01)	Clip_Loss 1.0376e+01 (1.0376e+01)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 31.6187 (31.6187)	Acc@5 45.3125 (45.3125)	Acc@10 71.8750 (71.8750)
Epoch: [5][181/32]	Time  0.649 ( 2.364)	Data  0.007 ( 1.758)	Loss 1.0374e+01 (1.0413e+01)	Clip_Loss 1.0374e+01 (1.0413e+01)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 24.5821 (27.1540)	Acc@5 35.9375 (42.5595)	Acc@10 60.9375 (63.9137)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 5 running time:  0:01:47.493732
===> Building meters
DataParallel
4
Epoch: [6][193/32]	Time 10.838 (10.838)	Data 10.212 (10.212)	Loss 1.0557e+01 (1.0557e+01)	Clip_Loss 1.0557e+01 (1.0557e+01)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 26.7874 (26.7874)	Acc@5 40.6250 (40.6250)	Acc@10 57.8125 (57.8125)
Epoch: [6][213/32]	Time  0.624 ( 2.043)	Data  0.007 ( 1.435)	Loss 1.0318e+01 (1.0283e+01)	Clip_Loss 1.0318e+01 (1.0283e+01)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 29.4312 (27.1737)	Acc@5 43.7500 (43.8988)	Acc@10 57.8125 (64.2857)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 6 running time:  0:01:43.089496
===> Building meters
DataParallel
4
Epoch: [7][225/32]	Time 11.225 (11.225)	Data 10.597 (10.597)	Loss 1.0611e+01 (1.0611e+01)	Clip_Loss 1.0611e+01 (1.0611e+01)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 25.6919 (25.6919)	Acc@5 35.9375 (35.9375)	Acc@10 54.6875 (54.6875)
Epoch: [7][245/32]	Time  0.592 ( 2.094)	Data  0.007 ( 1.493)	Loss 1.0329e+01 (1.0225e+01)	Clip_Loss 1.0329e+01 (1.0225e+01)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 24.5024 (29.2570)	Acc@5 39.0625 (44.7173)	Acc@10 56.2500 (66.2946)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 7 running time:  0:01:42.293247
===> Building meters
DataParallel
4
Epoch: [8][257/32]	Time 11.395 (11.395)	Data 10.741 (10.741)	Loss 1.0234e+01 (1.0234e+01)	Clip_Loss 1.0234e+01 (1.0234e+01)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 27.1918 (27.1918)	Acc@5 39.0625 (39.0625)	Acc@10 60.9375 (60.9375)
Epoch: [8][277/32]	Time  0.625 ( 2.090)	Data  0.007 ( 1.474)	Loss 1.0167e+01 (9.9506e+00)	Clip_Loss 1.0167e+01 (9.9506e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 28.6619 (30.3866)	Acc@5 43.7500 (48.3631)	Acc@10 67.1875 (68.2292)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 8 running time:  0:01:49.366895
===> Building meters
DataParallel
4
Epoch: [9][289/32]	Time 11.182 (11.182)	Data 10.532 (10.532)	Loss 9.4968e+00 (9.4968e+00)	Clip_Loss 9.4968e+00 (9.4968e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 36.4075 (36.4075)	Acc@5 56.2500 (56.2500)	Acc@10 76.5625 (76.5625)
Epoch: [9][309/32]	Time  0.588 ( 2.074)	Data  0.007 ( 1.463)	Loss 9.4943e+00 (9.9045e+00)	Clip_Loss 9.4943e+00 (9.9045e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 36.4535 (31.1943)	Acc@5 60.9375 (49.1071)	Acc@10 76.5625 (70.0149)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 9 running time:  0:01:40.499322
===> Building meters
DataParallel
4
Epoch: [10][321/32]	Time 10.785 (10.785)	Data 10.169 (10.169)	Loss 9.9733e+00 (9.9733e+00)	Clip_Loss 9.9733e+00 (9.9733e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 30.0478 (30.0478)	Acc@5 48.4375 (48.4375)	Acc@10 71.8750 (71.8750)
Epoch: [10][341/32]	Time  0.623 ( 1.967)	Data  0.007 ( 1.354)	Loss 9.8110e+00 (9.8109e+00)	Clip_Loss 9.8110e+00 (9.8109e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 32.7709 (31.6612)	Acc@5 46.8750 (50.0744)	Acc@10 65.6250 (69.9405)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 10 running time:  0:01:30.062349
===> Building meters
DataParallel
4
Epoch: [11][353/32]	Time 10.037 (10.037)	Data  9.410 ( 9.410)	Loss 9.3438e+00 (9.3438e+00)	Clip_Loss 9.3438e+00 (9.3438e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 37.7950 (37.7950)	Acc@5 59.3750 (59.3750)	Acc@10 78.1250 (78.1250)
Epoch: [11][373/32]	Time  0.591 ( 1.922)	Data  0.007 ( 1.314)	Loss 1.0690e+01 (9.6717e+00)	Clip_Loss 1.0690e+01 (9.6717e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 23.5907 (32.7114)	Acc@5 35.9375 (52.1577)	Acc@10 56.2500 (71.5030)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 11 running time:  0:01:30.878461
===> Building meters
DataParallel
4
Epoch: [12][385/32]	Time  9.934 ( 9.934)	Data  9.264 ( 9.264)	Loss 9.9012e+00 (9.9012e+00)	Clip_Loss 9.9012e+00 (9.9012e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 29.5133 (29.5133)	Acc@5 56.2500 (56.2500)	Acc@10 70.3125 (70.3125)
Epoch: [12][405/32]	Time  0.615 ( 1.843)	Data  0.007 ( 1.229)	Loss 9.9280e+00 (9.6502e+00)	Clip_Loss 9.9280e+00 (9.6502e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 27.7748 (32.1815)	Acc@5 51.5625 (51.7857)	Acc@10 71.8750 (73.1399)
Epoch 12 running time:  0:00:55.393456
===> Building meters
DataParallel
4
Epoch: [13][417/32]	Time  8.622 ( 8.622)	Data  7.986 ( 7.986)	Loss 9.2404e+00 (9.2404e+00)	Clip_Loss 9.2404e+00 (9.2404e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 36.9854 (36.9854)	Acc@5 64.0625 (64.0625)	Acc@10 81.2500 (81.2500)
Epoch: [13][437/32]	Time  0.677 ( 1.684)	Data  0.007 ( 1.076)	Loss 9.8690e+00 (9.5105e+00)	Clip_Loss 9.8690e+00 (9.5105e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 28.1374 (33.4126)	Acc@5 45.3125 (53.6458)	Acc@10 70.3125 (72.9167)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 13 running time:  0:01:21.126009
===> Building meters
DataParallel
4
Epoch: [14][449/32]	Time 12.262 (12.262)	Data 11.642 (11.642)	Loss 9.3120e+00 (9.3120e+00)	Clip_Loss 9.3120e+00 (9.3120e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 39.1119 (39.1119)	Acc@5 60.9375 (60.9375)	Acc@10 71.8750 (71.8750)
Epoch: [14][469/32]	Time  0.663 ( 2.543)	Data  0.008 ( 1.934)	Loss 1.0228e+01 (9.4462e+00)	Clip_Loss 1.0228e+01 (9.4462e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 26.7838 (35.1084)	Acc@5 39.0625 (54.3155)	Acc@10 64.0625 (73.9583)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 14 running time:  0:01:51.618655
===> Building meters
DataParallel
4
Epoch: [15][481/32]	Time 10.853 (10.853)	Data 10.237 (10.237)	Loss 8.9689e+00 (8.9689e+00)	Clip_Loss 8.9689e+00 (8.9689e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 37.2190 (37.2190)	Acc@5 57.8125 (57.8125)	Acc@10 84.3750 (84.3750)
Epoch: [15][501/32]	Time  0.621 ( 1.830)	Data  0.007 ( 1.223)	Loss 1.0382e+01 (9.2971e+00)	Clip_Loss 1.0382e+01 (9.2971e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 27.5997 (34.7916)	Acc@5 39.0625 (56.1756)	Acc@10 56.2500 (75.6696)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 15 running time:  0:01:25.203414
===> Building meters
DataParallel
4
Epoch: [16][513/32]	Time  9.310 ( 9.310)	Data  8.666 ( 8.666)	Loss 9.6469e+00 (9.6469e+00)	Clip_Loss 9.6469e+00 (9.6469e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 27.7139 (27.7139)	Acc@5 48.4375 (48.4375)	Acc@10 76.5625 (76.5625)
Epoch: [16][533/32]	Time  0.649 ( 1.713)	Data  0.007 ( 1.102)	Loss 8.9383e+00 (9.3333e+00)	Clip_Loss 8.9383e+00 (9.3333e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 38.5114 (35.4491)	Acc@5 60.9375 (54.6131)	Acc@10 82.8125 (76.2649)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 16 running time:  0:01:29.594522
===> Building meters
DataParallel
4
Epoch: [17][545/32]	Time  9.686 ( 9.686)	Data  9.057 ( 9.057)	Loss 9.2825e+00 (9.2825e+00)	Clip_Loss 9.2825e+00 (9.2825e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 31.2888 (31.2888)	Acc@5 54.6875 (54.6875)	Acc@10 75.0000 (75.0000)
Epoch: [17][565/32]	Time  0.629 ( 1.904)	Data  0.008 ( 1.301)	Loss 9.4825e+00 (9.3672e+00)	Clip_Loss 9.4825e+00 (9.3672e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 32.1006 (33.8113)	Acc@5 57.8125 (55.9524)	Acc@10 64.0625 (75.3720)
Epoch 17 running time:  0:00:56.857738
===> Building meters
DataParallel
4
Epoch: [18][577/32]	Time  9.076 ( 9.076)	Data  8.481 ( 8.481)	Loss 9.0447e+00 (9.0447e+00)	Clip_Loss 9.0447e+00 (9.0447e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 44.2834 (44.2834)	Acc@5 62.5000 (62.5000)	Acc@10 78.1250 (78.1250)
Epoch: [18][597/32]	Time  0.589 ( 1.569)	Data  0.007 ( 0.960)	Loss 9.6520e+00 (9.3567e+00)	Clip_Loss 9.6520e+00 (9.3567e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 29.8690 (34.9122)	Acc@5 56.2500 (55.8780)	Acc@10 73.4375 (74.3304)
Epoch 18 running time:  0:00:50.711449
====> Test::::/datasets/aicitychallenge2023/val.json
====> Query /datasets/aicitychallenge2023/val.json load
Test Epoch: [19][162/163]	Time 216.570 (216.570)	Data  0.000 ( 0.000)	Clip Loss 4.4177e+00 (4.4177e+00)	MRR 18.0292 (18.0292)	Acc@1 6.0000 (6.0000)	Acc@5 29.0000 (29.0000)
Epoch 19 running time:  0:03:36.576075
Logs dir: logs/dual_baseline_aug1 
====> results in csv format: 
| Method             | Dataset                                | Epoch   | Loss   | MRR    | Acc-5   | Acc-10   |
|:-------------------|:---------------------------------------|:--------|:-------|:-------|:--------|:---------|
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 19      | 4.418  | 18.029 | 6.000   | 29.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | Max_19  | 4.418  | 18.029 | 6.000   | 29.000   |
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best_eval.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best_eval.pth
===> Building meters
DataParallel
4
Epoch: [19][609/32]	Time  9.702 ( 9.702)	Data  9.100 ( 9.100)	Loss 8.8671e+00 (8.8671e+00)	Clip_Loss 8.8671e+00 (8.8671e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 40.4304 (40.4304)	Acc@5 62.5000 (62.5000)	Acc@10 79.6875 (79.6875)
Epoch: [19][629/32]	Time  0.614 ( 1.683)	Data  0.007 ( 1.074)	Loss 8.9097e+00 (9.2505e+00)	Clip_Loss 8.9097e+00 (9.2505e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 39.7600 (36.1098)	Acc@5 65.6250 (57.8125)	Acc@10 87.5000 (76.3393)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 19 running time:  0:01:45.410314
===> Building meters
DataParallel
4
Epoch: [20][641/32]	Time 10.308 (10.308)	Data  9.691 ( 9.691)	Loss 9.0723e+00 (9.0723e+00)	Clip_Loss 9.0723e+00 (9.0723e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 32.5166 (32.5166)	Acc@5 54.6875 (54.6875)	Acc@10 78.1250 (78.1250)
Epoch: [20][661/32]	Time  0.595 ( 1.717)	Data  0.007 ( 1.112)	Loss 9.1150e+00 (9.1143e+00)	Clip_Loss 9.1150e+00 (9.1143e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 31.1334 (35.9997)	Acc@5 53.1250 (57.1429)	Acc@10 75.0000 (77.9762)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 20 running time:  0:01:18.484237
===> Building meters
DataParallel
4
Epoch: [21][673/32]	Time  8.401 ( 8.401)	Data  7.768 ( 7.768)	Loss 8.8226e+00 (8.8226e+00)	Clip_Loss 8.8226e+00 (8.8226e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 39.9431 (39.9431)	Acc@5 56.2500 (56.2500)	Acc@10 82.8125 (82.8125)
Epoch: [21][693/32]	Time  0.595 ( 1.597)	Data  0.007 ( 0.992)	Loss 8.4144e+00 (9.0763e+00)	Clip_Loss 8.4144e+00 (9.0763e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 42.8295 (37.1875)	Acc@5 65.6250 (57.5893)	Acc@10 84.3750 (78.1994)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 21 running time:  0:01:23.288387
===> Building meters
DataParallel
4
Epoch: [22][705/32]	Time  9.590 ( 9.590)	Data  8.954 ( 8.954)	Loss 9.3233e+00 (9.3233e+00)	Clip_Loss 9.3233e+00 (9.3233e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 32.2937 (32.2937)	Acc@5 56.2500 (56.2500)	Acc@10 82.8125 (82.8125)
Epoch: [22][725/32]	Time  0.612 ( 1.650)	Data  0.007 ( 1.039)	Loss 9.4999e+00 (9.1884e+00)	Clip_Loss 9.4999e+00 (9.1884e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 29.9944 (34.5834)	Acc@5 56.2500 (56.5476)	Acc@10 73.4375 (78.1250)
Epoch 22 running time:  0:00:50.812283
===> Building meters
DataParallel
4
Epoch: [23][737/32]	Time  8.600 ( 8.600)	Data  7.986 ( 7.986)	Loss 8.8873e+00 (8.8873e+00)	Clip_Loss 8.8873e+00 (8.8873e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 40.3752 (40.3752)	Acc@5 56.2500 (56.2500)	Acc@10 75.0000 (75.0000)
Epoch: [23][757/32]	Time  0.616 ( 1.422)	Data  0.007 ( 0.813)	Loss 9.2343e+00 (9.0616e+00)	Clip_Loss 9.2343e+00 (9.0616e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 35.0927 (37.8410)	Acc@5 57.8125 (59.3006)	Acc@10 75.0000 (76.8601)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 23 running time:  0:01:12.901869
===> Building meters
DataParallel
4
Epoch: [24][769/32]	Time  8.968 ( 8.968)	Data  8.342 ( 8.342)	Loss 8.7791e+00 (8.7791e+00)	Clip_Loss 8.7791e+00 (8.7791e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 39.9398 (39.9398)	Acc@5 65.6250 (65.6250)	Acc@10 78.1250 (78.1250)
Epoch: [24][789/32]	Time  0.610 ( 1.647)	Data  0.007 ( 1.034)	Loss 8.8340e+00 (9.1302e+00)	Clip_Loss 8.8340e+00 (9.1302e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 32.9865 (36.5923)	Acc@5 60.9375 (59.2262)	Acc@10 79.6875 (76.4881)
Epoch 24 running time:  0:00:50.221294
===> Building meters
DataParallel
4
Epoch: [25][801/32]	Time  8.240 ( 8.240)	Data  7.643 ( 7.643)	Loss 9.8690e+00 (9.8690e+00)	Clip_Loss 9.8690e+00 (9.8690e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 33.1455 (33.1455)	Acc@5 53.1250 (53.1250)	Acc@10 64.0625 (64.0625)
Epoch: [25][821/32]	Time  0.628 ( 1.357)	Data  0.007 ( 0.746)	Loss 9.6953e+00 (9.1015e+00)	Clip_Loss 9.6953e+00 (9.1015e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 30.7462 (36.6453)	Acc@5 50.0000 (58.9286)	Acc@10 73.4375 (77.5298)
Epoch 25 running time:  0:00:42.187118
===> Building meters
DataParallel
4
Epoch: [26][833/32]	Time  7.967 ( 7.967)	Data  7.375 ( 7.375)	Loss 8.7235e+00 (8.7235e+00)	Clip_Loss 8.7235e+00 (8.7235e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 38.0613 (38.0613)	Acc@5 57.8125 (57.8125)	Acc@10 84.3750 (84.3750)
Epoch: [26][853/32]	Time  0.589 ( 1.564)	Data  0.007 ( 0.963)	Loss 9.1155e+00 (9.1434e+00)	Clip_Loss 9.1155e+00 (9.1434e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 30.2590 (36.6248)	Acc@5 50.0000 (55.6548)	Acc@10 85.9375 (76.6369)
Epoch 26 running time:  0:00:46.915171
===> Building meters
DataParallel
4
Epoch: [27][865/32]	Time  8.128 ( 8.128)	Data  7.536 ( 7.536)	Loss 8.6073e+00 (8.6073e+00)	Clip_Loss 8.6073e+00 (8.6073e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 43.3660 (43.3660)	Acc@5 59.3750 (59.3750)	Acc@10 79.6875 (79.6875)
Epoch: [27][885/32]	Time  0.840 ( 1.458)	Data  0.199 ( 0.846)	Loss 9.4363e+00 (8.9518e+00)	Clip_Loss 9.4363e+00 (8.9518e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 31.6925 (38.7961)	Acc@5 54.6875 (59.2262)	Acc@10 81.2500 (79.0923)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 27 running time:  0:01:25.004004
===> Building meters
DataParallel
4
Epoch: [28][897/32]	Time  8.933 ( 8.933)	Data  8.341 ( 8.341)	Loss 7.9972e+00 (7.9972e+00)	Clip_Loss 7.9972e+00 (7.9972e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 44.3108 (44.3108)	Acc@5 76.5625 (76.5625)	Acc@10 90.6250 (90.6250)
Epoch: [28][917/32]	Time  0.648 ( 1.708)	Data  0.007 ( 1.097)	Loss 9.2794e+00 (9.0139e+00)	Clip_Loss 9.2794e+00 (9.0139e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 35.0348 (36.7562)	Acc@5 53.1250 (59.7470)	Acc@10 73.4375 (79.3899)
Epoch 28 running time:  0:00:51.404881
===> Building meters
DataParallel
4
Epoch: [29][929/32]	Time  7.627 ( 7.627)	Data  6.996 ( 6.996)	Loss 8.8910e+00 (8.8910e+00)	Clip_Loss 8.8910e+00 (8.8910e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 36.8399 (36.8399)	Acc@5 56.2500 (56.2500)	Acc@10 81.2500 (81.2500)
Epoch: [29][949/32]	Time  0.623 ( 1.396)	Data  0.007 ( 0.790)	Loss 9.0252e+00 (9.0180e+00)	Clip_Loss 9.0252e+00 (9.0180e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 38.4178 (37.9742)	Acc@5 64.0625 (57.8125)	Acc@10 71.8750 (78.1250)
Epoch 29 running time:  0:00:43.516692
===> Building meters
DataParallel
4
Epoch: [30][ 1/32]	Time  8.186 ( 8.186)	Data  7.543 ( 7.543)	Loss 8.2318e+00 (8.2318e+00)	Clip_Loss 8.2318e+00 (8.2318e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 43.0471 (43.0471)	Acc@5 60.9375 (60.9375)	Acc@10 81.2500 (81.2500)
Epoch: [30][21/32]	Time  0.612 ( 1.511)	Data  0.007 ( 0.899)	Loss 9.2258e+00 (8.8397e+00)	Clip_Loss 9.2258e+00 (8.8397e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 34.5722 (40.6463)	Acc@5 60.9375 (62.6488)	Acc@10 79.6875 (79.2411)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 30 running time:  0:01:19.718896
===> Building meters
DataParallel
4
Epoch: [31][33/32]	Time  8.746 ( 8.746)	Data  8.130 ( 8.130)	Loss 8.7422e+00 (8.7422e+00)	Clip_Loss 8.7422e+00 (8.7422e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 43.6605 (43.6605)	Acc@5 67.1875 (67.1875)	Acc@10 82.8125 (82.8125)
Epoch: [31][53/32]	Time  0.617 ( 1.641)	Data  0.007 ( 1.038)	Loss 8.8518e+00 (8.9071e+00)	Clip_Loss 8.8518e+00 (8.9071e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 39.4881 (38.8858)	Acc@5 59.3750 (60.8631)	Acc@10 82.8125 (80.4315)
Epoch 31 running time:  0:00:48.671735
===> Building meters
DataParallel
4
Epoch: [32][65/32]	Time  7.311 ( 7.311)	Data  6.686 ( 6.686)	Loss 8.5399e+00 (8.5399e+00)	Clip_Loss 8.5399e+00 (8.5399e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 40.7393 (40.7393)	Acc@5 68.7500 (68.7500)	Acc@10 81.2500 (81.2500)
Epoch: [32][85/32]	Time  0.593 ( 1.427)	Data  0.007 ( 0.825)	Loss 8.9370e+00 (8.9306e+00)	Clip_Loss 8.9370e+00 (8.9306e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 42.1128 (39.5935)	Acc@5 62.5000 (62.4256)	Acc@10 82.8125 (80.1339)
Epoch 32 running time:  0:00:44.273283
===> Building meters
DataParallel
4
Epoch: [33][97/32]	Time  8.292 ( 8.292)	Data  7.697 ( 7.697)	Loss 8.1772e+00 (8.1772e+00)	Clip_Loss 8.1772e+00 (8.1772e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 45.5027 (45.5027)	Acc@5 71.8750 (71.8750)	Acc@10 85.9375 (85.9375)
Epoch: [33][117/32]	Time  1.020 ( 1.660)	Data  0.410 ( 1.051)	Loss 8.8116e+00 (8.9182e+00)	Clip_Loss 8.8116e+00 (8.9182e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 40.5471 (38.5781)	Acc@5 59.3750 (60.1935)	Acc@10 71.8750 (77.8274)
Epoch 33 running time:  0:00:52.575333
===> Building meters
DataParallel
4
Epoch: [34][129/32]	Time 11.550 (11.550)	Data 10.925 (10.925)	Loss 8.8422e+00 (8.8422e+00)	Clip_Loss 8.8422e+00 (8.8422e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 39.0944 (39.0944)	Acc@5 57.8125 (57.8125)	Acc@10 76.5625 (76.5625)
Epoch: [34][149/32]	Time  0.594 ( 1.612)	Data  0.007 ( 1.000)	Loss 8.9628e+00 (8.9875e+00)	Clip_Loss 8.9628e+00 (8.9875e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 36.8114 (38.3419)	Acc@5 56.2500 (58.3333)	Acc@10 78.1250 (78.3482)
Epoch 34 running time:  0:00:47.501062
===> Building meters
DataParallel
4
Epoch: [35][161/32]	Time  7.824 ( 7.824)	Data  7.146 ( 7.146)	Loss 8.8084e+00 (8.8084e+00)	Clip_Loss 8.8084e+00 (8.8084e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 43.7157 (43.7157)	Acc@5 67.1875 (67.1875)	Acc@10 84.3750 (84.3750)
Epoch: [35][181/32]	Time  0.615 ( 1.436)	Data  0.007 ( 0.832)	Loss 8.6519e+00 (8.8264e+00)	Clip_Loss 8.6519e+00 (8.8264e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 36.7375 (38.7731)	Acc@5 70.3125 (62.0536)	Acc@10 89.0625 (79.7619)
Epoch 35 running time:  0:00:44.603795
===> Building meters
DataParallel
4
Epoch: [36][193/32]	Time  8.244 ( 8.244)	Data  7.632 ( 7.632)	Loss 8.5455e+00 (8.5455e+00)	Clip_Loss 8.5455e+00 (8.5455e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 46.0416 (46.0416)	Acc@5 67.1875 (67.1875)	Acc@10 82.8125 (82.8125)
Epoch: [36][213/32]	Time  0.624 ( 1.461)	Data  0.007 ( 0.854)	Loss 8.7173e+00 (8.7721e+00)	Clip_Loss 8.7173e+00 (8.7721e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 43.3542 (41.2096)	Acc@5 67.1875 (61.6815)	Acc@10 82.8125 (80.2083)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 36 running time:  0:01:38.971251
===> Building meters
DataParallel
4
Epoch: [37][225/32]	Time  8.832 ( 8.832)	Data  8.238 ( 8.238)	Loss 9.0522e+00 (9.0522e+00)	Clip_Loss 9.0522e+00 (9.0522e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 41.2677 (41.2677)	Acc@5 64.0625 (64.0625)	Acc@10 85.9375 (85.9375)
Epoch: [37][245/32]	Time  0.910 ( 1.558)	Data  0.301 ( 0.952)	Loss 8.6918e+00 (8.7817e+00)	Clip_Loss 8.6918e+00 (8.7817e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 37.7615 (39.5133)	Acc@5 65.6250 (62.3512)	Acc@10 85.9375 (79.4643)
Epoch 37 running time:  0:00:46.506866
===> Building meters
DataParallel
4
Epoch: [38][257/32]	Time  7.061 ( 7.061)	Data  6.434 ( 6.434)	Loss 8.3817e+00 (8.3817e+00)	Clip_Loss 8.3817e+00 (8.3817e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 52.3539 (52.3539)	Acc@5 68.7500 (68.7500)	Acc@10 87.5000 (87.5000)
Epoch: [38][277/32]	Time  1.579 ( 1.336)	Data  0.972 ( 0.727)	Loss 8.3492e+00 (8.7408e+00)	Clip_Loss 8.3492e+00 (8.7408e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 39.0891 (41.0164)	Acc@5 64.0625 (62.9464)	Acc@10 85.9375 (80.8036)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 38 running time:  0:01:20.161526
====> Test::::/datasets/aicitychallenge2023/val.json
====> Query /datasets/aicitychallenge2023/val.json load
Test Epoch: [39][162/163]	Time 118.694 (118.694)	Data  0.000 ( 0.000)	Clip Loss 4.3183e+00 (4.3183e+00)	MRR 25.6399 (25.6399)	Acc@1 12.0000 (12.0000)	Acc@5 39.0000 (39.0000)
Epoch 39 running time:  0:01:58.699398
Logs dir: logs/dual_baseline_aug1 
====> results in csv format: 
| Method             | Dataset                                | Epoch   | Loss   | MRR    | Acc-5   | Acc-10   |
|:-------------------|:---------------------------------------|:--------|:-------|:-------|:--------|:---------|
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 19      | 4.418  | 18.029 | 6.000   | 29.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 39      | 4.318  | 25.640 | 12.000  | 39.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | Max_39  | 4.318  | 25.640 | 12.000  | 39.000   |
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best_eval.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best_eval.pth
===> Building meters
DataParallel
4
Epoch: [39][289/32]	Time  8.467 ( 8.467)	Data  7.845 ( 7.845)	Loss 8.3185e+00 (8.3185e+00)	Clip_Loss 8.3185e+00 (8.3185e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 45.7417 (45.7417)	Acc@5 64.0625 (64.0625)	Acc@10 81.2500 (81.2500)
Epoch: [39][309/32]	Time  0.590 ( 1.610)	Data  0.007 ( 1.007)	Loss 8.6040e+00 (8.5185e+00)	Clip_Loss 8.6040e+00 (8.5185e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 39.5071 (41.3417)	Acc@5 62.5000 (64.5089)	Acc@10 79.6875 (81.9196)
Epoch 39 running time:  0:00:49.468908
===> Building meters
DataParallel
4
Epoch: [40][321/32]	Time  7.183 ( 7.183)	Data  6.556 ( 6.556)	Loss 8.6848e+00 (8.6848e+00)	Clip_Loss 8.6848e+00 (8.6848e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 40.5249 (40.5249)	Acc@5 53.1250 (53.1250)	Acc@10 71.8750 (71.8750)
Epoch: [40][341/32]	Time  0.625 ( 1.318)	Data  0.007 ( 0.710)	Loss 9.1903e+00 (8.7715e+00)	Clip_Loss 9.1903e+00 (8.7715e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 37.1358 (40.0239)	Acc@5 51.5625 (61.6815)	Acc@10 75.0000 (79.0923)
Epoch 40 running time:  0:00:42.030251
===> Building meters
DataParallel
4
Epoch: [41][353/32]	Time  7.720 ( 7.720)	Data  7.074 ( 7.074)	Loss 9.4851e+00 (9.4851e+00)	Clip_Loss 9.4851e+00 (9.4851e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 38.4260 (38.4260)	Acc@5 53.1250 (53.1250)	Acc@10 73.4375 (73.4375)
Epoch: [41][373/32]	Time  0.620 ( 1.506)	Data  0.007 ( 0.895)	Loss 8.8627e+00 (8.5409e+00)	Clip_Loss 8.8627e+00 (8.5409e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 41.3436 (41.8409)	Acc@5 62.5000 (63.0208)	Acc@10 73.4375 (82.4405)
Epoch 41 running time:  0:00:45.958992
===> Building meters
DataParallel
4
Epoch: [42][385/32]	Time  7.127 ( 7.127)	Data  6.517 ( 6.517)	Loss 9.0518e+00 (9.0518e+00)	Clip_Loss 9.0518e+00 (9.0518e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 42.2877 (42.2877)	Acc@5 53.1250 (53.1250)	Acc@10 78.1250 (78.1250)
Epoch: [42][405/32]	Time  0.824 ( 1.260)	Data  0.181 ( 0.650)	Loss 7.7951e+00 (8.6980e+00)	Clip_Loss 7.7951e+00 (8.6980e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 44.6318 (40.9090)	Acc@5 73.4375 (62.8720)	Acc@10 93.7500 (81.5476)
Epoch 42 running time:  0:00:38.934593
===> Building meters
DataParallel
4
Epoch: [43][417/32]	Time  7.901 ( 7.901)	Data  7.307 ( 7.307)	Loss 8.6587e+00 (8.6587e+00)	Clip_Loss 8.6587e+00 (8.6587e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 42.8390 (42.8390)	Acc@5 67.1875 (67.1875)	Acc@10 81.2500 (81.2500)
Epoch: [43][437/32]	Time  0.592 ( 1.422)	Data  0.007 ( 0.814)	Loss 8.2546e+00 (8.5114e+00)	Clip_Loss 8.2546e+00 (8.5114e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 36.1258 (42.5883)	Acc@5 60.9375 (65.3274)	Acc@10 89.0625 (82.9613)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 43 running time:  0:01:19.551651
===> Building meters
DataParallel
4
Epoch: [44][449/32]	Time  8.760 ( 8.760)	Data  8.107 ( 8.107)	Loss 8.4589e+00 (8.4589e+00)	Clip_Loss 8.4589e+00 (8.4589e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 41.3153 (41.3153)	Acc@5 68.7500 (68.7500)	Acc@10 85.9375 (85.9375)
Epoch: [44][469/32]	Time  0.625 ( 1.590)	Data  0.007 ( 0.978)	Loss 9.4850e+00 (8.4956e+00)	Clip_Loss 9.4850e+00 (8.4956e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 38.8318 (43.3639)	Acc@5 51.5625 (67.1875)	Acc@10 76.5625 (83.4077)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 44 running time:  0:01:19.146804
===> Building meters
DataParallel
4
Epoch: [45][481/32]	Time  7.973 ( 7.973)	Data  7.347 ( 7.347)	Loss 8.0303e+00 (8.0303e+00)	Clip_Loss 8.0303e+00 (8.0303e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 45.6776 (45.6776)	Acc@5 70.3125 (70.3125)	Acc@10 90.6250 (90.6250)
Epoch: [45][501/32]	Time  0.625 ( 1.523)	Data  0.007 ( 0.914)	Loss 8.1343e+00 (8.5664e+00)	Clip_Loss 8.1343e+00 (8.5664e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 41.5080 (41.4531)	Acc@5 62.5000 (63.3929)	Acc@10 92.1875 (82.2173)
Epoch 45 running time:  0:00:44.901954
===> Building meters
DataParallel
4
Epoch: [46][513/32]	Time  7.294 ( 7.294)	Data  6.700 ( 6.700)	Loss 8.2621e+00 (8.2621e+00)	Clip_Loss 8.2621e+00 (8.2621e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 44.4935 (44.4935)	Acc@5 65.6250 (65.6250)	Acc@10 81.2500 (81.2500)
Epoch: [46][533/32]	Time  0.591 ( 1.273)	Data  0.007 ( 0.672)	Loss 8.6621e+00 (8.4302e+00)	Clip_Loss 8.6621e+00 (8.4302e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 41.3815 (42.0405)	Acc@5 60.9375 (64.2113)	Acc@10 79.6875 (82.2173)
Epoch 46 running time:  0:00:38.165710
===> Building meters
DataParallel
4
Epoch: [47][545/32]	Time  8.276 ( 8.276)	Data  7.653 ( 7.653)	Loss 8.2411e+00 (8.2411e+00)	Clip_Loss 8.2411e+00 (8.2411e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 49.4816 (49.4816)	Acc@5 67.1875 (67.1875)	Acc@10 84.3750 (84.3750)
Epoch: [47][565/32]	Time  0.625 ( 1.646)	Data  0.007 ( 1.036)	Loss 8.2310e+00 (8.4166e+00)	Clip_Loss 8.2310e+00 (8.4166e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 44.3602 (43.3813)	Acc@5 67.1875 (66.5923)	Acc@10 82.8125 (84.3750)
Epoch 47 running time:  0:00:47.272355
===> Building meters
DataParallel
4
Epoch: [48][577/32]	Time  6.935 ( 6.935)	Data  6.282 ( 6.282)	Loss 9.1541e+00 (9.1541e+00)	Clip_Loss 9.1541e+00 (9.1541e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 35.4669 (35.4669)	Acc@5 54.6875 (54.6875)	Acc@10 71.8750 (71.8750)
Epoch: [48][597/32]	Time  0.648 ( 1.299)	Data  0.007 ( 0.688)	Loss 8.8482e+00 (8.3045e+00)	Clip_Loss 8.8482e+00 (8.3045e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 35.6732 (42.5534)	Acc@5 64.0625 (66.0714)	Acc@10 81.2500 (83.5565)
Epoch 48 running time:  0:00:39.938746
===> Building meters
DataParallel
4
Epoch: [49][609/32]	Time  8.057 ( 8.057)	Data  7.431 ( 7.431)	Loss 8.2410e+00 (8.2410e+00)	Clip_Loss 8.2410e+00 (8.2410e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 43.5745 (43.5745)	Acc@5 62.5000 (62.5000)	Acc@10 89.0625 (89.0625)
Epoch: [49][629/32]	Time  0.616 ( 1.362)	Data  0.007 ( 0.750)	Loss 8.8795e+00 (8.4646e+00)	Clip_Loss 8.8795e+00 (8.4646e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 41.8183 (42.9290)	Acc@5 64.0625 (65.4762)	Acc@10 76.5625 (83.1101)
Epoch 49 running time:  0:00:40.771152
===> Building meters
DataParallel
4
Epoch: [50][641/32]	Time  7.712 ( 7.712)	Data  7.095 ( 7.095)	Loss 7.8897e+00 (7.8897e+00)	Clip_Loss 7.8897e+00 (7.8897e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 43.1993 (43.1993)	Acc@5 71.8750 (71.8750)	Acc@10 90.6250 (90.6250)
Epoch: [50][661/32]	Time  0.622 ( 1.470)	Data  0.007 ( 0.862)	Loss 9.1945e+00 (8.1573e+00)	Clip_Loss 9.1945e+00 (8.1573e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 35.6758 (44.7133)	Acc@5 54.6875 (66.9643)	Acc@10 75.0000 (84.5238)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 50 running time:  0:01:48.377054
===> Building meters
DataParallel
4
Epoch: [51][673/32]	Time  7.735 ( 7.735)	Data  7.116 ( 7.116)	Loss 8.2741e+00 (8.2741e+00)	Clip_Loss 8.2741e+00 (8.2741e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 44.6411 (44.6411)	Acc@5 65.6250 (65.6250)	Acc@10 81.2500 (81.2500)
Epoch: [51][693/32]	Time  0.621 ( 1.474)	Data  0.007 ( 0.867)	Loss 8.3496e+00 (8.3619e+00)	Clip_Loss 8.3496e+00 (8.3619e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 39.5179 (43.7006)	Acc@5 62.5000 (66.7411)	Acc@10 85.9375 (84.1518)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 51 running time:  0:01:13.694276
===> Building meters
DataParallel
4
Epoch: [52][705/32]	Time  8.323 ( 8.323)	Data  7.706 ( 7.706)	Loss 7.6143e+00 (7.6143e+00)	Clip_Loss 7.6143e+00 (7.6143e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 52.2490 (52.2490)	Acc@5 78.1250 (78.1250)	Acc@10 92.1875 (92.1875)
Epoch: [52][725/32]	Time  0.626 ( 1.404)	Data  0.007 ( 0.796)	Loss 8.8643e+00 (8.2419e+00)	Clip_Loss 8.8643e+00 (8.2419e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 35.2762 (45.1051)	Acc@5 62.5000 (67.8571)	Acc@10 84.3750 (84.2262)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 52 running time:  0:01:10.265186
===> Building meters
DataParallel
4
Epoch: [53][737/32]	Time  7.636 ( 7.636)	Data  6.990 ( 6.990)	Loss 8.1905e+00 (8.1905e+00)	Clip_Loss 8.1905e+00 (8.1905e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 47.1722 (47.1722)	Acc@5 68.7500 (68.7500)	Acc@10 82.8125 (82.8125)
Epoch: [53][757/32]	Time  0.627 ( 1.325)	Data  0.007 ( 0.716)	Loss 8.4282e+00 (8.4493e+00)	Clip_Loss 8.4282e+00 (8.4493e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 43.0099 (43.3158)	Acc@5 67.1875 (66.5179)	Acc@10 73.4375 (83.3333)
Epoch 53 running time:  0:00:41.992994
===> Building meters
DataParallel
4
Epoch: [54][769/32]	Time  7.251 ( 7.251)	Data  6.600 ( 6.600)	Loss 8.2000e+00 (8.2000e+00)	Clip_Loss 8.2000e+00 (8.2000e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 45.6875 (45.6875)	Acc@5 71.8750 (71.8750)	Acc@10 81.2500 (81.2500)
Epoch: [54][789/32]	Time  0.616 ( 1.316)	Data  0.008 ( 0.704)	Loss 8.2912e+00 (8.0474e+00)	Clip_Loss 8.2912e+00 (8.0474e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 46.8388 (45.5545)	Acc@5 68.7500 (69.5685)	Acc@10 89.0625 (85.8631)
Epoch 54 running time:  0:00:40.312645
===> Building meters
DataParallel
4
Epoch: [55][801/32]	Time  8.002 ( 8.002)	Data  7.371 ( 7.371)	Loss 8.5258e+00 (8.5258e+00)	Clip_Loss 8.5258e+00 (8.5258e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 45.6706 (45.6706)	Acc@5 65.6250 (65.6250)	Acc@10 84.3750 (84.3750)
Epoch: [55][821/32]	Time  3.133 ( 1.533)	Data  2.527 ( 0.925)	Loss 8.2912e+00 (8.1181e+00)	Clip_Loss 8.2912e+00 (8.1181e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 45.9409 (46.2000)	Acc@5 65.6250 (69.0476)	Acc@10 89.0625 (86.0863)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 55 running time:  0:03:22.517888
===> Building meters
DataParallel
4
Epoch: [56][833/32]	Time  8.831 ( 8.831)	Data  8.217 ( 8.217)	Loss 7.9819e+00 (7.9819e+00)	Clip_Loss 7.9819e+00 (7.9819e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 44.8731 (44.8731)	Acc@5 68.7500 (68.7500)	Acc@10 84.3750 (84.3750)
Epoch: [56][853/32]	Time  0.623 ( 1.562)	Data  0.007 ( 0.955)	Loss 9.4852e+00 (8.1065e+00)	Clip_Loss 9.4852e+00 (8.1065e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 34.1751 (45.6018)	Acc@5 48.4375 (68.8244)	Acc@10 65.6250 (84.8958)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 56 running time:  0:01:57.529156
===> Building meters
DataParallel
4
Epoch: [57][865/32]	Time  8.590 ( 8.590)	Data  7.974 ( 7.974)	Loss 7.7028e+00 (7.7028e+00)	Clip_Loss 7.7028e+00 (7.7028e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 48.1910 (48.1910)	Acc@5 73.4375 (73.4375)	Acc@10 89.0625 (89.0625)
Epoch: [57][885/32]	Time  0.611 ( 1.472)	Data  0.007 ( 0.862)	Loss 8.6541e+00 (7.8748e+00)	Clip_Loss 8.6541e+00 (7.8748e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 39.6702 (46.6684)	Acc@5 60.9375 (71.1310)	Acc@10 79.6875 (87.0536)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 57 running time:  0:01:35.466415
===> Building meters
DataParallel
4
Epoch: [58][897/32]	Time  7.900 ( 7.900)	Data  7.270 ( 7.270)	Loss 8.2196e+00 (8.2196e+00)	Clip_Loss 8.2196e+00 (8.2196e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 46.2784 (46.2784)	Acc@5 67.1875 (67.1875)	Acc@10 81.2500 (81.2500)
Epoch: [58][917/32]	Time  0.599 ( 1.419)	Data  0.007 ( 0.812)	Loss 8.3714e+00 (8.0153e+00)	Clip_Loss 8.3714e+00 (8.0153e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 44.2360 (46.5004)	Acc@5 62.5000 (70.6845)	Acc@10 84.3750 (86.4583)
Epoch 58 running time:  0:00:44.884134
====> Test::::/datasets/aicitychallenge2023/val.json
====> Query /datasets/aicitychallenge2023/val.json load
Test Epoch: [59][162/163]	Time 116.360 (116.360)	Data  0.000 ( 0.000)	Clip Loss 4.3082e+00 (4.3082e+00)	MRR 26.6011 (26.6011)	Acc@1 10.0000 (10.0000)	Acc@5 45.0000 (45.0000)
Epoch 59 running time:  0:01:56.365649
Logs dir: logs/dual_baseline_aug1 
====> results in csv format: 
| Method             | Dataset                                | Epoch   | Loss   | MRR    | Acc-5   | Acc-10   |
|:-------------------|:---------------------------------------|:--------|:-------|:-------|:--------|:---------|
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 19      | 4.418  | 18.029 | 6.000   | 29.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 39      | 4.318  | 25.640 | 12.000  | 39.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 59      | 4.308  | 26.601 | 10.000  | 45.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | Max_59  | 4.308  | 26.601 | 10.000  | 45.000   |
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best_eval.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best_eval.pth
===> Building meters
DataParallel
4
Epoch: [59][929/32]	Time  8.353 ( 8.353)	Data  7.725 ( 7.725)	Loss 7.6889e+00 (7.6889e+00)	Clip_Loss 7.6889e+00 (7.6889e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 53.3087 (53.3087)	Acc@5 76.5625 (76.5625)	Acc@10 82.8125 (82.8125)
Epoch: [59][949/32]	Time  0.624 ( 1.408)	Data  0.008 ( 0.799)	Loss 8.3297e+00 (8.0245e+00)	Clip_Loss 8.3297e+00 (8.0245e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 38.9602 (46.4721)	Acc@5 62.5000 (69.4940)	Acc@10 82.8125 (85.2679)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 59 running time:  0:01:19.395007
===> Building meters
DataParallel
4
Epoch: [60][ 1/32]	Time  7.514 ( 7.514)	Data  6.848 ( 6.848)	Loss 8.1907e+00 (8.1907e+00)	Clip_Loss 8.1907e+00 (8.1907e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 45.7009 (45.7009)	Acc@5 64.0625 (64.0625)	Acc@10 82.8125 (82.8125)
Epoch: [60][21/32]	Time  0.613 ( 1.434)	Data  0.007 ( 0.820)	Loss 8.1528e+00 (8.0706e+00)	Clip_Loss 8.1528e+00 (8.0706e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 43.7947 (46.9517)	Acc@5 70.3125 (69.9405)	Acc@10 85.9375 (85.2679)
Epoch 60 running time:  0:00:43.188216
===> Building meters
DataParallel
4
Epoch: [61][33/32]	Time  6.464 ( 6.464)	Data  5.841 ( 5.841)	Loss 7.7344e+00 (7.7344e+00)	Clip_Loss 7.7344e+00 (7.7344e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 52.7220 (52.7220)	Acc@5 75.0000 (75.0000)	Acc@10 95.3125 (95.3125)
Epoch: [61][53/32]	Time  0.626 ( 1.143)	Data  0.007 ( 0.535)	Loss 9.0320e+00 (8.0501e+00)	Clip_Loss 9.0320e+00 (8.0501e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 43.4276 (46.8051)	Acc@5 59.3750 (69.7173)	Acc@10 76.5625 (86.9048)
Epoch 61 running time:  0:00:36.061757
===> Building meters
DataParallel
4
Epoch: [62][65/32]	Time  6.699 ( 6.699)	Data  6.076 ( 6.076)	Loss 7.7097e+00 (7.7097e+00)	Clip_Loss 7.7097e+00 (7.7097e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 45.7511 (45.7511)	Acc@5 68.7500 (68.7500)	Acc@10 85.9375 (85.9375)
Epoch: [62][85/32]	Time  0.627 ( 1.315)	Data  0.008 ( 0.709)	Loss 8.3905e+00 (7.8674e+00)	Clip_Loss 8.3905e+00 (7.8674e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 43.7118 (46.8379)	Acc@5 65.6250 (70.9821)	Acc@10 90.6250 (87.3512)
Epoch 62 running time:  0:00:40.554107
===> Building meters
DataParallel
4
Epoch: [63][97/32]	Time  7.605 ( 7.605)	Data  6.987 ( 6.987)	Loss 7.8202e+00 (7.8202e+00)	Clip_Loss 7.8202e+00 (7.8202e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 47.3658 (47.3658)	Acc@5 68.7500 (68.7500)	Acc@10 81.2500 (81.2500)
Epoch: [63][117/32]	Time  0.640 ( 1.204)	Data  0.012 ( 0.596)	Loss 7.9571e+00 (7.9112e+00)	Clip_Loss 7.9571e+00 (7.9112e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 45.9837 (46.8102)	Acc@5 71.8750 (71.6518)	Acc@10 87.5000 (87.2024)
Epoch 63 running time:  0:00:37.272755
===> Building meters
DataParallel
4
Epoch: [64][129/32]	Time  6.994 ( 6.994)	Data  6.377 ( 6.377)	Loss 8.3413e+00 (8.3413e+00)	Clip_Loss 8.3413e+00 (8.3413e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 40.3702 (40.3702)	Acc@5 59.3750 (59.3750)	Acc@10 85.9375 (85.9375)
Epoch: [64][149/32]	Time  1.500 ( 1.299)	Data  0.913 ( 0.703)	Loss 7.3530e+00 (7.9001e+00)	Clip_Loss 7.3530e+00 (7.9001e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 50.1503 (47.4226)	Acc@5 73.4375 (69.8661)	Acc@10 92.1875 (86.6815)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 64 running time:  0:01:35.853940
===> Building meters
DataParallel
4
Epoch: [65][161/32]	Time  8.290 ( 8.290)	Data  7.679 ( 7.679)	Loss 7.5427e+00 (7.5427e+00)	Clip_Loss 7.5427e+00 (7.5427e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 51.1144 (51.1144)	Acc@5 71.8750 (71.8750)	Acc@10 84.3750 (84.3750)
Epoch: [65][181/32]	Time  0.593 ( 1.465)	Data  0.007 ( 0.856)	Loss 7.9865e+00 (7.8605e+00)	Clip_Loss 7.9865e+00 (7.8605e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 41.3834 (46.7632)	Acc@5 67.1875 (71.2798)	Acc@10 85.9375 (88.3929)
Epoch 65 running time:  0:00:43.391754
===> Building meters
DataParallel
4
Epoch: [66][193/32]	Time  6.893 ( 6.893)	Data  6.229 ( 6.229)	Loss 7.9257e+00 (7.9257e+00)	Clip_Loss 7.9257e+00 (7.9257e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 44.4585 (44.4585)	Acc@5 67.1875 (67.1875)	Acc@10 87.5000 (87.5000)
Epoch: [66][213/32]	Time  0.804 ( 1.198)	Data  0.186 ( 0.580)	Loss 8.4538e+00 (7.8443e+00)	Clip_Loss 8.4538e+00 (7.8443e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 42.8652 (47.2578)	Acc@5 68.7500 (71.5774)	Acc@10 79.6875 (87.5744)
Epoch 66 running time:  0:00:37.272681
===> Building meters
DataParallel
4
Epoch: [67][225/32]	Time  7.063 ( 7.063)	Data  6.466 ( 6.466)	Loss 7.8768e+00 (7.8768e+00)	Clip_Loss 7.8768e+00 (7.8768e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 49.1161 (49.1161)	Acc@5 70.3125 (70.3125)	Acc@10 87.5000 (87.5000)
Epoch: [67][245/32]	Time  0.621 ( 1.348)	Data  0.007 ( 0.746)	Loss 7.8702e+00 (7.8536e+00)	Clip_Loss 7.8702e+00 (7.8536e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 49.8689 (47.9544)	Acc@5 78.1250 (71.8006)	Acc@10 87.5000 (87.8720)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 67 running time:  0:01:42.063395
===> Building meters
DataParallel
4
Epoch: [68][257/32]	Time 10.159 (10.159)	Data  9.517 ( 9.517)	Loss 7.2927e+00 (7.2927e+00)	Clip_Loss 7.2927e+00 (7.2927e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 50.5401 (50.5401)	Acc@5 78.1250 (78.1250)	Acc@10 93.7500 (93.7500)
Epoch: [68][277/32]	Time  0.630 ( 1.503)	Data  0.007 ( 0.892)	Loss 8.9946e+00 (7.9698e+00)	Clip_Loss 8.9946e+00 (7.9698e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 36.8754 (47.0571)	Acc@5 56.2500 (69.7917)	Acc@10 76.5625 (85.1190)
Epoch 68 running time:  0:00:44.929462
===> Building meters
DataParallel
4
Epoch: [69][289/32]	Time  6.406 ( 6.406)	Data  5.755 ( 5.755)	Loss 7.8790e+00 (7.8790e+00)	Clip_Loss 7.8790e+00 (7.8790e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 49.1499 (49.1499)	Acc@5 67.1875 (67.1875)	Acc@10 84.3750 (84.3750)
Epoch: [69][309/32]	Time  0.621 ( 1.126)	Data  0.007 ( 0.513)	Loss 8.2104e+00 (7.7410e+00)	Clip_Loss 8.2104e+00 (7.7410e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 39.7604 (48.2499)	Acc@5 64.0625 (73.3631)	Acc@10 85.9375 (88.9137)
Epoch 69 running time:  0:00:34.927350
===> Building meters
DataParallel
4
Epoch: [70][321/32]	Time  6.975 ( 6.975)	Data  6.379 ( 6.379)	Loss 8.0917e+00 (8.0917e+00)	Clip_Loss 8.0917e+00 (8.0917e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 47.3427 (47.3427)	Acc@5 68.7500 (68.7500)	Acc@10 87.5000 (87.5000)
Epoch: [70][341/32]	Time  0.593 ( 1.345)	Data  0.007 ( 0.743)	Loss 8.3152e+00 (7.9280e+00)	Clip_Loss 8.3152e+00 (7.9280e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 46.0070 (48.1861)	Acc@5 65.6250 (70.0149)	Acc@10 85.9375 (86.5327)
Epoch 70 running time:  0:00:40.073799
===> Building meters
DataParallel
4
Epoch: [71][353/32]	Time  6.793 ( 6.793)	Data  6.182 ( 6.182)	Loss 7.0289e+00 (7.0289e+00)	Clip_Loss 7.0289e+00 (7.0289e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 52.1951 (52.1951)	Acc@5 82.8125 (82.8125)	Acc@10 93.7500 (93.7500)
Epoch: [71][373/32]	Time  0.619 ( 1.212)	Data  0.007 ( 0.606)	Loss 7.5745e+00 (7.7463e+00)	Clip_Loss 7.5745e+00 (7.7463e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 52.1901 (48.1629)	Acc@5 71.8750 (73.1399)	Acc@10 85.9375 (87.7976)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 71 running time:  0:01:07.690992
===> Building meters
DataParallel
4
Epoch: [72][385/32]	Time  8.076 ( 8.076)	Data  7.483 ( 7.483)	Loss 7.3998e+00 (7.3998e+00)	Clip_Loss 7.3998e+00 (7.3998e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 49.7533 (49.7533)	Acc@5 76.5625 (76.5625)	Acc@10 89.0625 (89.0625)
Epoch: [72][405/32]	Time  0.617 ( 1.357)	Data  0.007 ( 0.747)	Loss 7.7264e+00 (7.7966e+00)	Clip_Loss 7.7264e+00 (7.7966e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 46.6144 (48.4896)	Acc@5 73.4375 (71.5774)	Acc@10 89.0625 (87.5744)
Epoch 72 running time:  0:00:40.549391
===> Building meters
DataParallel
4
Epoch: [73][417/32]	Time  6.064 ( 6.064)	Data  5.449 ( 5.449)	Loss 8.1037e+00 (8.1037e+00)	Clip_Loss 8.1037e+00 (8.1037e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 43.5021 (43.5021)	Acc@5 65.6250 (65.6250)	Acc@10 87.5000 (87.5000)
Epoch: [73][437/32]	Time  0.614 ( 1.123)	Data  0.007 ( 0.507)	Loss 8.4171e+00 (7.5921e+00)	Clip_Loss 8.4171e+00 (7.5921e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 40.4866 (50.2574)	Acc@5 71.8750 (73.6607)	Acc@10 85.9375 (88.9881)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 73 running time:  0:01:07.706087
===> Building meters
DataParallel
4
Epoch: [74][449/32]	Time  7.827 ( 7.827)	Data  7.177 ( 7.177)	Loss 8.0709e+00 (8.0709e+00)	Clip_Loss 8.0709e+00 (8.0709e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 47.3522 (47.3522)	Acc@5 68.7500 (68.7500)	Acc@10 89.0625 (89.0625)
Epoch: [74][469/32]	Time  0.601 ( 1.363)	Data  0.008 ( 0.757)	Loss 8.0666e+00 (7.8360e+00)	Clip_Loss 8.0666e+00 (7.8360e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 47.3311 (48.2839)	Acc@5 68.7500 (72.3958)	Acc@10 84.3750 (87.2768)
Epoch 74 running time:  0:00:41.823380
===> Building meters
DataParallel
4
Epoch: [75][481/32]	Time  7.116 ( 7.116)	Data  6.491 ( 6.491)	Loss 7.6724e+00 (7.6724e+00)	Clip_Loss 7.6724e+00 (7.6724e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 51.9255 (51.9255)	Acc@5 73.4375 (73.4375)	Acc@10 89.0625 (89.0625)
Epoch: [75][501/32]	Time  0.625 ( 1.172)	Data  0.007 ( 0.565)	Loss 7.2132e+00 (7.4767e+00)	Clip_Loss 7.2132e+00 (7.4767e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 54.2830 (51.4170)	Acc@5 78.1250 (74.7024)	Acc@10 85.9375 (89.0625)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 75 running time:  0:01:07.127330
===> Building meters
DataParallel
4
Epoch: [76][513/32]	Time  8.465 ( 8.465)	Data  7.847 ( 7.847)	Loss 7.0175e+00 (7.0175e+00)	Clip_Loss 7.0175e+00 (7.0175e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 51.9913 (51.9913)	Acc@5 73.4375 (73.4375)	Acc@10 90.6250 (90.6250)
Epoch: [76][533/32]	Time  0.589 ( 1.664)	Data  0.007 ( 1.066)	Loss 7.7074e+00 (7.6164e+00)	Clip_Loss 7.7074e+00 (7.6164e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 51.8256 (49.1323)	Acc@5 73.4375 (73.2143)	Acc@10 84.3750 (87.7232)
Epoch 76 running time:  0:00:46.851115
===> Building meters
DataParallel
4
Epoch: [77][545/32]	Time  6.283 ( 6.283)	Data  5.586 ( 5.586)	Loss 7.3962e+00 (7.3962e+00)	Clip_Loss 7.3962e+00 (7.3962e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 52.2872 (52.2872)	Acc@5 79.6875 (79.6875)	Acc@10 95.3125 (95.3125)
Epoch: [77][565/32]	Time  0.611 ( 1.145)	Data  0.007 ( 0.534)	Loss 7.8370e+00 (7.5380e+00)	Clip_Loss 7.8370e+00 (7.5380e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 44.7533 (50.3536)	Acc@5 68.7500 (75.3720)	Acc@10 87.5000 (89.2857)
Epoch 77 running time:  0:00:34.928017
===> Building meters
DataParallel
4
Epoch: [78][577/32]	Time  7.145 ( 7.145)	Data  6.541 ( 6.541)	Loss 7.6064e+00 (7.6064e+00)	Clip_Loss 7.6064e+00 (7.6064e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 53.2864 (53.2864)	Acc@5 78.1250 (78.1250)	Acc@10 87.5000 (87.5000)
Epoch: [78][597/32]	Time  0.615 ( 1.301)	Data  0.007 ( 0.693)	Loss 7.7294e+00 (7.6142e+00)	Clip_Loss 7.7294e+00 (7.6142e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 52.9283 (50.0935)	Acc@5 71.8750 (74.7768)	Acc@10 90.6250 (89.0625)
Epoch 78 running time:  0:00:39.871461
====> Test::::/datasets/aicitychallenge2023/val.json
====> Query /datasets/aicitychallenge2023/val.json load
Test Epoch: [79][162/163]	Time 116.860 (116.860)	Data  0.000 ( 0.000)	Clip Loss 4.2560e+00 (4.2560e+00)	MRR 32.9013 (32.9013)	Acc@1 16.0000 (16.0000)	Acc@5 53.0000 (53.0000)
Epoch 79 running time:  0:01:56.865621
Logs dir: logs/dual_baseline_aug1 
====> results in csv format: 
| Method             | Dataset                                | Epoch   | Loss   | MRR    | Acc-5   | Acc-10   |
|:-------------------|:---------------------------------------|:--------|:-------|:-------|:--------|:---------|
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 19      | 4.418  | 18.029 | 6.000   | 29.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 39      | 4.318  | 25.640 | 12.000  | 39.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 59      | 4.308  | 26.601 | 10.000  | 45.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 79      | 4.256  | 32.901 | 16.000  | 53.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | Max_79  | 4.256  | 32.901 | 16.000  | 53.000   |
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best_eval.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best_eval.pth
===> Building meters
DataParallel
4
Epoch: [79][609/32]	Time  8.802 ( 8.802)	Data  8.183 ( 8.183)	Loss 7.0644e+00 (7.0644e+00)	Clip_Loss 7.0644e+00 (7.0644e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 59.9340 (59.9340)	Acc@5 84.3750 (84.3750)	Acc@10 95.3125 (95.3125)
Epoch: [79][629/32]	Time  0.593 ( 1.371)	Data  0.007 ( 0.771)	Loss 7.4914e+00 (7.5573e+00)	Clip_Loss 7.4914e+00 (7.5573e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 53.1234 (50.9678)	Acc@5 82.8125 (74.0327)	Acc@10 92.1875 (89.5089)
Epoch 79 running time:  0:00:41.529859
===> Building meters
DataParallel
4
Epoch: [80][641/32]	Time  6.585 ( 6.585)	Data  5.986 ( 5.986)	Loss 7.8357e+00 (7.8357e+00)	Clip_Loss 7.8357e+00 (7.8357e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 51.1511 (51.1511)	Acc@5 68.7500 (68.7500)	Acc@10 89.0625 (89.0625)
Epoch: [80][661/32]	Time  0.596 ( 1.149)	Data  0.007 ( 0.540)	Loss 7.4337e+00 (7.6868e+00)	Clip_Loss 7.4337e+00 (7.6868e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 49.3014 (49.6946)	Acc@5 71.8750 (73.4375)	Acc@10 85.9375 (87.7976)
Epoch 80 running time:  0:00:34.907806
===> Building meters
DataParallel
4
Epoch: [81][673/32]	Time  8.087 ( 8.087)	Data  7.440 ( 7.440)	Loss 7.6980e+00 (7.6980e+00)	Clip_Loss 7.6980e+00 (7.6980e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 45.9266 (45.9266)	Acc@5 75.0000 (75.0000)	Acc@10 93.7500 (93.7500)
Epoch: [81][693/32]	Time  0.648 ( 1.310)	Data  0.008 ( 0.702)	Loss 7.8726e+00 (7.7885e+00)	Clip_Loss 7.8726e+00 (7.7885e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 45.9847 (48.4668)	Acc@5 71.8750 (72.4702)	Acc@10 90.6250 (88.8393)
Epoch 81 running time:  0:00:39.688532
===> Building meters
DataParallel
4
Epoch: [82][705/32]	Time  6.894 ( 6.894)	Data  6.299 ( 6.299)	Loss 7.6579e+00 (7.6579e+00)	Clip_Loss 7.6579e+00 (7.6579e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 46.6437 (46.6437)	Acc@5 75.0000 (75.0000)	Acc@10 90.6250 (90.6250)
Epoch: [82][725/32]	Time  0.618 ( 1.234)	Data  0.008 ( 0.621)	Loss 7.8146e+00 (7.7114e+00)	Clip_Loss 7.8146e+00 (7.7114e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 47.7308 (48.9891)	Acc@5 71.8750 (73.6607)	Acc@10 89.0625 (86.5327)
Epoch 82 running time:  0:00:36.242997
===> Building meters
DataParallel
4
Epoch: [83][737/32]	Time  7.079 ( 7.079)	Data  6.467 ( 6.467)	Loss 7.1832e+00 (7.1832e+00)	Clip_Loss 7.1832e+00 (7.1832e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 56.3636 (56.3636)	Acc@5 79.6875 (79.6875)	Acc@10 89.0625 (89.0625)
Epoch: [83][757/32]	Time  0.630 ( 1.264)	Data  0.007 ( 0.659)	Loss 7.6515e+00 (7.5997e+00)	Clip_Loss 7.6515e+00 (7.5997e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 47.1995 (50.1931)	Acc@5 70.3125 (74.1815)	Acc@10 85.9375 (87.8720)
Epoch 83 running time:  0:00:39.244955
===> Building meters
DataParallel
4
Epoch: [84][769/32]	Time  6.567 ( 6.567)	Data  5.918 ( 5.918)	Loss 6.7343e+00 (6.7343e+00)	Clip_Loss 6.7343e+00 (6.7343e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 60.0975 (60.0975)	Acc@5 85.9375 (85.9375)	Acc@10 93.7500 (93.7500)
Epoch: [84][789/32]	Time  0.593 ( 1.179)	Data  0.007 ( 0.566)	Loss 7.9303e+00 (7.6675e+00)	Clip_Loss 7.9303e+00 (7.6675e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 49.9916 (49.5132)	Acc@5 71.8750 (72.8423)	Acc@10 87.5000 (87.5000)
Epoch 84 running time:  0:00:35.876477
===> Building meters
DataParallel
4
Epoch: [85][801/32]	Time  6.967 ( 6.967)	Data  6.345 ( 6.345)	Loss 8.4058e+00 (8.4058e+00)	Clip_Loss 8.4058e+00 (8.4058e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 45.4480 (45.4480)	Acc@5 73.4375 (73.4375)	Acc@10 82.8125 (82.8125)
Epoch: [85][821/32]	Time  0.615 ( 1.235)	Data  0.007 ( 0.628)	Loss 7.5824e+00 (7.6124e+00)	Clip_Loss 7.5824e+00 (7.6124e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 51.0948 (50.7007)	Acc@5 73.4375 (74.8512)	Acc@10 85.9375 (88.1696)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 85 running time:  0:01:06.330067
===> Building meters
DataParallel
4
Epoch: [86][833/32]	Time  6.685 ( 6.685)	Data  6.059 ( 6.059)	Loss 7.4113e+00 (7.4113e+00)	Clip_Loss 7.4113e+00 (7.4113e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 49.9763 (49.9763)	Acc@5 71.8750 (71.8750)	Acc@10 87.5000 (87.5000)
Epoch: [86][853/32]	Time  0.616 ( 1.306)	Data  0.007 ( 0.694)	Loss 7.4713e+00 (7.4021e+00)	Clip_Loss 7.4713e+00 (7.4021e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 49.6911 (51.0379)	Acc@5 81.2500 (75.2976)	Acc@10 92.1875 (90.3274)
Epoch 86 running time:  0:00:40.630874
===> Building meters
DataParallel
4
Epoch: [87][865/32]	Time  6.509 ( 6.509)	Data  5.908 ( 5.908)	Loss 7.5492e+00 (7.5492e+00)	Clip_Loss 7.5492e+00 (7.5492e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 45.8601 (45.8601)	Acc@5 76.5625 (76.5625)	Acc@10 93.7500 (93.7500)
Epoch: [87][885/32]	Time  0.629 ( 1.102)	Data  0.007 ( 0.486)	Loss 7.4858e+00 (7.6438e+00)	Clip_Loss 7.4858e+00 (7.6438e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 50.1348 (48.9719)	Acc@5 79.6875 (73.2143)	Acc@10 90.6250 (88.3185)
Epoch 87 running time:  0:00:33.766748
===> Building meters
DataParallel
4
Epoch: [88][897/32]	Time  7.011 ( 7.011)	Data  6.376 ( 6.376)	Loss 6.5428e+00 (6.5428e+00)	Clip_Loss 6.5428e+00 (6.5428e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 58.4234 (58.4234)	Acc@5 79.6875 (79.6875)	Acc@10 95.3125 (95.3125)
Epoch: [88][917/32]	Time  0.655 ( 1.223)	Data  0.007 ( 0.606)	Loss 7.7384e+00 (7.4617e+00)	Clip_Loss 7.7384e+00 (7.4617e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 51.7473 (50.6590)	Acc@5 73.4375 (76.4881)	Acc@10 87.5000 (89.8810)
Epoch 88 running time:  0:00:37.964606
===> Building meters
DataParallel
4
Epoch: [89][929/32]	Time  6.775 ( 6.775)	Data  6.155 ( 6.155)	Loss 8.1390e+00 (8.1390e+00)	Clip_Loss 8.1390e+00 (8.1390e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 45.2831 (45.2831)	Acc@5 64.0625 (64.0625)	Acc@10 89.0625 (89.0625)
Epoch: [89][949/32]	Time  1.095 ( 1.182)	Data  0.486 ( 0.575)	Loss 7.1386e+00 (7.3983e+00)	Clip_Loss 7.1386e+00 (7.3983e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 49.9104 (52.2911)	Acc@5 76.5625 (74.6280)	Acc@10 92.1875 (89.6577)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 89 running time:  0:01:12.515603
===> Building meters
DataParallel
4
Epoch: [90][ 1/32]	Time  8.011 ( 8.011)	Data  7.401 ( 7.401)	Loss 7.4665e+00 (7.4665e+00)	Clip_Loss 7.4665e+00 (7.4665e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 50.5088 (50.5088)	Acc@5 76.5625 (76.5625)	Acc@10 89.0625 (89.0625)
Epoch: [90][21/32]	Time  0.613 ( 1.333)	Data  0.007 ( 0.731)	Loss 7.4469e+00 (7.4791e+00)	Clip_Loss 7.4469e+00 (7.4791e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 51.6497 (51.4363)	Acc@5 73.4375 (75.7440)	Acc@10 87.5000 (88.8393)
Epoch 90 running time:  0:00:39.855267
===> Building meters
DataParallel
4
Epoch: [91][33/32]	Time  6.931 ( 6.931)	Data  6.311 ( 6.311)	Loss 8.3839e+00 (8.3839e+00)	Clip_Loss 8.3839e+00 (8.3839e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 47.7071 (47.7071)	Acc@5 67.1875 (67.1875)	Acc@10 85.9375 (85.9375)
Epoch: [91][53/32]	Time  0.614 ( 1.147)	Data  0.007 ( 0.540)	Loss 7.4694e+00 (7.5371e+00)	Clip_Loss 7.4694e+00 (7.5371e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 55.2759 (50.4580)	Acc@5 76.5625 (75.2976)	Acc@10 92.1875 (89.5089)
Epoch 91 running time:  0:00:34.858765
===> Building meters
DataParallel
4
Epoch: [92][65/32]	Time  6.738 ( 6.738)	Data  6.126 ( 6.126)	Loss 7.5052e+00 (7.5052e+00)	Clip_Loss 7.5052e+00 (7.5052e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 54.5751 (54.5751)	Acc@5 71.8750 (71.8750)	Acc@10 89.0625 (89.0625)
Epoch: [92][85/32]	Time  1.179 ( 1.220)	Data  0.571 ( 0.601)	Loss 7.0302e+00 (7.2446e+00)	Clip_Loss 7.0302e+00 (7.2446e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 55.0220 (53.2914)	Acc@5 82.8125 (77.8274)	Acc@10 95.3125 (90.3274)
Epoch 92 running time:  0:00:36.463881
===> Building meters
DataParallel
4
Epoch: [93][97/32]	Time  6.127 ( 6.127)	Data  5.502 ( 5.502)	Loss 7.3768e+00 (7.3768e+00)	Clip_Loss 7.3768e+00 (7.3768e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 47.7259 (47.7259)	Acc@5 70.3125 (70.3125)	Acc@10 89.0625 (89.0625)
Epoch: [93][117/32]	Time  0.615 ( 1.141)	Data  0.009 ( 0.535)	Loss 7.7255e+00 (7.3224e+00)	Clip_Loss 7.7255e+00 (7.3224e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 51.7845 (52.0684)	Acc@5 68.7500 (76.9345)	Acc@10 81.2500 (90.1786)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 93 running time:  0:01:08.536917
===> Building meters
DataParallel
4
Epoch: [94][129/32]	Time  8.106 ( 8.106)	Data  7.490 ( 7.490)	Loss 7.7461e+00 (7.7461e+00)	Clip_Loss 7.7461e+00 (7.7461e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 47.7098 (47.7098)	Acc@5 73.4375 (73.4375)	Acc@10 90.6250 (90.6250)
Epoch: [94][149/32]	Time  0.621 ( 1.362)	Data  0.007 ( 0.753)	Loss 7.4902e+00 (7.3274e+00)	Clip_Loss 7.4902e+00 (7.3274e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 54.3566 (52.9349)	Acc@5 73.4375 (77.0089)	Acc@10 92.1875 (90.4762)
Epoch 94 running time:  0:00:40.615574
===> Building meters
DataParallel
4
Epoch: [95][161/32]	Time  6.544 ( 6.544)	Data  5.951 ( 5.951)	Loss 7.0949e+00 (7.0949e+00)	Clip_Loss 7.0949e+00 (7.0949e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 53.6451 (53.6451)	Acc@5 73.4375 (73.4375)	Acc@10 90.6250 (90.6250)
Epoch: [95][181/32]	Time  0.614 ( 1.164)	Data  0.007 ( 0.558)	Loss 7.0019e+00 (7.3431e+00)	Clip_Loss 7.0019e+00 (7.3431e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 53.2279 (52.2495)	Acc@5 81.2500 (75.2976)	Acc@10 96.8750 (91.4435)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 95 running time:  0:01:18.266024
===> Building meters
DataParallel
4
Epoch: [96][193/32]	Time  8.105 ( 8.105)	Data  7.506 ( 7.506)	Loss 7.3175e+00 (7.3175e+00)	Clip_Loss 7.3175e+00 (7.3175e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 47.4007 (47.4007)	Acc@5 70.3125 (70.3125)	Acc@10 92.1875 (92.1875)
Epoch: [96][213/32]	Time  0.632 ( 1.388)	Data  0.007 ( 0.780)	Loss 7.1641e+00 (7.4482e+00)	Clip_Loss 7.1641e+00 (7.4482e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 54.4913 (50.5168)	Acc@5 82.8125 (75.5208)	Acc@10 92.1875 (89.9554)
Epoch 96 running time:  0:00:41.555104
===> Building meters
DataParallel
4
Epoch: [97][225/32]	Time  5.831 ( 5.831)	Data  5.190 ( 5.190)	Loss 7.9201e+00 (7.9201e+00)	Clip_Loss 7.9201e+00 (7.9201e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 47.0403 (47.0403)	Acc@5 70.3125 (70.3125)	Acc@10 90.6250 (90.6250)
Epoch: [97][245/32]	Time  0.617 ( 1.029)	Data  0.007 ( 0.414)	Loss 7.0120e+00 (7.3985e+00)	Clip_Loss 7.0120e+00 (7.3985e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 54.6975 (52.4938)	Acc@5 79.6875 (75.5208)	Acc@10 89.0625 (89.9554)
Epoch 97 running time:  0:00:32.588561
===> Building meters
DataParallel
4
Epoch: [98][257/32]	Time  6.632 ( 6.632)	Data  6.014 ( 6.014)	Loss 7.1596e+00 (7.1596e+00)	Clip_Loss 7.1596e+00 (7.1596e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 52.7208 (52.7208)	Acc@5 79.6875 (79.6875)	Acc@10 89.0625 (89.0625)
Epoch: [98][277/32]	Time  0.617 ( 1.231)	Data  0.007 ( 0.625)	Loss 7.5642e+00 (7.3610e+00)	Clip_Loss 7.5642e+00 (7.3610e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 55.2328 (52.5916)	Acc@5 73.4375 (77.9762)	Acc@10 89.0625 (91.1458)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 98 running time:  0:01:17.115389
====> Test::::/datasets/aicitychallenge2023/val.json
====> Query /datasets/aicitychallenge2023/val.json load
Test Epoch: [99][162/163]	Time 119.529 (119.529)	Data  0.000 ( 0.000)	Clip Loss 4.2478e+00 (4.2478e+00)	MRR 35.4849 (35.4849)	Acc@1 19.0000 (19.0000)	Acc@5 54.0000 (54.0000)
Epoch 99 running time:  0:01:59.534869
Logs dir: logs/dual_baseline_aug1 
====> results in csv format: 
| Method             | Dataset                                | Epoch   | Loss   | MRR    | Acc-5   | Acc-10   |
|:-------------------|:---------------------------------------|:--------|:-------|:-------|:--------|:---------|
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 19      | 4.418  | 18.029 | 6.000   | 29.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 39      | 4.318  | 25.640 | 12.000  | 39.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 59      | 4.308  | 26.601 | 10.000  | 45.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 79      | 4.256  | 32.901 | 16.000  | 53.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 99      | 4.248  | 35.485 | 19.000  | 54.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | Max_99  | 4.248  | 35.485 | 19.000  | 54.000   |
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best_eval.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best_eval.pth
===> Building meters
DataParallel
4
Epoch: [99][289/32]	Time  7.852 ( 7.852)	Data  7.200 ( 7.200)	Loss 7.4124e+00 (7.4124e+00)	Clip_Loss 7.4124e+00 (7.4124e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 49.8073 (49.8073)	Acc@5 70.3125 (70.3125)	Acc@10 85.9375 (85.9375)
Epoch: [99][309/32]	Time  0.619 ( 1.383)	Data  0.007 ( 0.776)	Loss 7.3211e+00 (7.2572e+00)	Clip_Loss 7.3211e+00 (7.2572e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 52.0439 (52.7455)	Acc@5 73.4375 (77.5298)	Acc@10 89.0625 (90.6994)
Epoch 99 running time:  0:00:41.593448
===> Building meters
DataParallel
4
Epoch: [100][321/32]	Time  6.672 ( 6.672)	Data  6.041 ( 6.041)	Loss 7.2415e+00 (7.2415e+00)	Clip_Loss 7.2415e+00 (7.2415e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 54.2729 (54.2729)	Acc@5 78.1250 (78.1250)	Acc@10 89.0625 (89.0625)
Epoch: [100][341/32]	Time  0.620 ( 1.124)	Data  0.008 ( 0.513)	Loss 7.6047e+00 (7.2844e+00)	Clip_Loss 7.6047e+00 (7.2844e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 50.4045 (54.6716)	Acc@5 75.0000 (77.8274)	Acc@10 87.5000 (90.5506)
Epoch 100 running time:  0:00:34.628762
===> Building meters
DataParallel
4
Epoch: [101][353/32]	Time  7.055 ( 7.055)	Data  6.417 ( 6.417)	Loss 7.0659e+00 (7.0659e+00)	Clip_Loss 7.0659e+00 (7.0659e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 58.3799 (58.3799)	Acc@5 81.2500 (81.2500)	Acc@10 95.3125 (95.3125)
Epoch: [101][373/32]	Time  0.590 ( 1.276)	Data  0.007 ( 0.665)	Loss 6.6113e+00 (7.2888e+00)	Clip_Loss 6.6113e+00 (7.2888e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 61.5958 (52.8006)	Acc@5 82.8125 (77.3810)	Acc@10 92.1875 (90.8482)
Epoch 101 running time:  0:00:38.968813
===> Building meters
DataParallel
4
Epoch: [102][385/32]	Time  6.950 ( 6.950)	Data  6.335 ( 6.335)	Loss 6.6354e+00 (6.6354e+00)	Clip_Loss 6.6354e+00 (6.6354e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 56.7719 (56.7719)	Acc@5 78.1250 (78.1250)	Acc@10 96.8750 (96.8750)
Epoch: [102][405/32]	Time  0.594 ( 1.174)	Data  0.007 ( 0.565)	Loss 7.7482e+00 (7.3126e+00)	Clip_Loss 7.7482e+00 (7.3126e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 45.0678 (51.5987)	Acc@5 71.8750 (76.7857)	Acc@10 90.6250 (90.8482)
Epoch 102 running time:  0:00:35.136188
===> Building meters
DataParallel
4
Epoch: [103][417/32]	Time  6.828 ( 6.828)	Data  6.214 ( 6.214)	Loss 7.0538e+00 (7.0538e+00)	Clip_Loss 7.0538e+00 (7.0538e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 58.0439 (58.0439)	Acc@5 75.0000 (75.0000)	Acc@10 93.7500 (93.7500)
Epoch: [103][437/32]	Time  0.628 ( 1.265)	Data  0.007 ( 0.651)	Loss 7.5237e+00 (7.2562e+00)	Clip_Loss 7.5237e+00 (7.2562e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 49.0164 (52.6326)	Acc@5 70.3125 (75.5952)	Acc@10 89.0625 (91.0714)
Epoch 103 running time:  0:00:38.241963
===> Building meters
DataParallel
4
Epoch: [104][449/32]	Time  6.852 ( 6.852)	Data  6.233 ( 6.233)	Loss 6.4769e+00 (6.4769e+00)	Clip_Loss 6.4769e+00 (6.4769e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 59.7353 (59.7353)	Acc@5 84.3750 (84.3750)	Acc@10 96.8750 (96.8750)
Epoch: [104][469/32]	Time  0.590 ( 1.150)	Data  0.007 ( 0.546)	Loss 7.0930e+00 (7.2277e+00)	Clip_Loss 7.0930e+00 (7.2277e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 51.6161 (52.9507)	Acc@5 78.1250 (76.9345)	Acc@10 93.7500 (91.8155)
Epoch 104 running time:  0:00:35.660580
===> Building meters
DataParallel
4
Epoch: [105][481/32]	Time  6.900 ( 6.900)	Data  6.286 ( 6.286)	Loss 7.7453e+00 (7.7453e+00)	Clip_Loss 7.7453e+00 (7.7453e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 50.0970 (50.0970)	Acc@5 68.7500 (68.7500)	Acc@10 84.3750 (84.3750)
Epoch: [105][501/32]	Time  0.614 ( 1.236)	Data  0.007 ( 0.619)	Loss 7.6427e+00 (7.3276e+00)	Clip_Loss 7.6427e+00 (7.3276e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 52.0222 (53.0001)	Acc@5 76.5625 (76.8601)	Acc@10 89.0625 (89.9554)
Epoch 105 running time:  0:00:37.743122
===> Building meters
DataParallel
4
Epoch: [106][513/32]	Time  6.649 ( 6.649)	Data  6.020 ( 6.020)	Loss 7.4747e+00 (7.4747e+00)	Clip_Loss 7.4747e+00 (7.4747e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 51.5414 (51.5414)	Acc@5 76.5625 (76.5625)	Acc@10 90.6250 (90.6250)
Epoch: [106][533/32]	Time  0.615 ( 1.202)	Data  0.007 ( 0.585)	Loss 7.2262e+00 (7.3673e+00)	Clip_Loss 7.2262e+00 (7.3673e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 60.7585 (52.8686)	Acc@5 82.8125 (76.1161)	Acc@10 89.0625 (90.5506)
Epoch 106 running time:  0:00:36.901457
===> Building meters
DataParallel
4
Epoch: [107][545/32]	Time  6.797 ( 6.797)	Data  6.155 ( 6.155)	Loss 7.5080e+00 (7.5080e+00)	Clip_Loss 7.5080e+00 (7.5080e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 52.7089 (52.7089)	Acc@5 73.4375 (73.4375)	Acc@10 85.9375 (85.9375)
Epoch: [107][565/32]	Time  0.617 ( 1.326)	Data  0.008 ( 0.716)	Loss 7.0445e+00 (7.2960e+00)	Clip_Loss 7.0445e+00 (7.2960e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 55.3847 (52.5019)	Acc@5 73.4375 (75.4464)	Acc@10 87.5000 (90.2530)
Epoch 107 running time:  0:00:40.120282
===> Building meters
DataParallel
4
Epoch: [108][577/32]	Time  6.669 ( 6.669)	Data  6.015 ( 6.015)	Loss 7.6215e+00 (7.6215e+00)	Clip_Loss 7.6215e+00 (7.6215e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 52.2618 (52.2618)	Acc@5 73.4375 (73.4375)	Acc@10 87.5000 (87.5000)
Epoch: [108][597/32]	Time  0.592 ( 1.173)	Data  0.007 ( 0.562)	Loss 6.7237e+00 (7.2490e+00)	Clip_Loss 6.7237e+00 (7.2490e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 60.0305 (53.9519)	Acc@5 71.8750 (76.0417)	Acc@10 96.8750 (90.6250)
Epoch 108 running time:  0:00:36.273064
===> Building meters
DataParallel
4
Epoch: [109][609/32]	Time  6.880 ( 6.880)	Data  6.262 ( 6.262)	Loss 7.9248e+00 (7.9248e+00)	Clip_Loss 7.9248e+00 (7.9248e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 48.8710 (48.8710)	Acc@5 73.4375 (73.4375)	Acc@10 84.3750 (84.3750)
Epoch: [109][629/32]	Time  0.595 ( 1.282)	Data  0.007 ( 0.676)	Loss 8.0495e+00 (7.2391e+00)	Clip_Loss 8.0495e+00 (7.2391e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 45.2259 (52.9144)	Acc@5 71.8750 (76.5625)	Acc@10 89.0625 (90.7738)
Epoch 109 running time:  0:00:37.764917
===> Building meters
DataParallel
4
Epoch: [110][641/32]	Time  6.639 ( 6.639)	Data  6.019 ( 6.019)	Loss 6.3479e+00 (6.3479e+00)	Clip_Loss 6.3479e+00 (6.3479e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 58.5249 (58.5249)	Acc@5 87.5000 (87.5000)	Acc@10 98.4375 (98.4375)
Epoch: [110][661/32]	Time  0.595 ( 1.153)	Data  0.007 ( 0.539)	Loss 7.7175e+00 (7.1441e+00)	Clip_Loss 7.7175e+00 (7.1441e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 47.9262 (55.0624)	Acc@5 70.3125 (79.1667)	Acc@10 92.1875 (92.3363)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 110 running time:  0:01:14.130589
===> Building meters
DataParallel
4
Epoch: [111][673/32]	Time  7.438 ( 7.438)	Data  6.827 ( 6.827)	Loss 7.2014e+00 (7.2014e+00)	Clip_Loss 7.2014e+00 (7.2014e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 58.7951 (58.7951)	Acc@5 73.4375 (73.4375)	Acc@10 92.1875 (92.1875)
Epoch: [111][693/32]	Time  0.628 ( 1.261)	Data  0.007 ( 0.652)	Loss 8.3303e+00 (7.0086e+00)	Clip_Loss 8.3303e+00 (7.0086e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 46.8149 (55.6705)	Acc@5 67.1875 (80.2827)	Acc@10 84.3750 (92.1131)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 111 running time:  0:01:29.910946
===> Building meters
DataParallel
4
Epoch: [112][705/32]	Time  7.207 ( 7.207)	Data  6.543 ( 6.543)	Loss 8.6672e+00 (8.6672e+00)	Clip_Loss 8.6672e+00 (8.6672e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 44.0751 (44.0751)	Acc@5 62.5000 (62.5000)	Acc@10 78.1250 (78.1250)
Epoch: [112][725/32]	Time  0.616 ( 1.318)	Data  0.007 ( 0.702)	Loss 6.5452e+00 (7.1626e+00)	Clip_Loss 6.5452e+00 (7.1626e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 59.8072 (54.6548)	Acc@5 90.6250 (78.3482)	Acc@10 95.3125 (91.2946)
Epoch 112 running time:  0:00:39.779504
===> Building meters
DataParallel
4
Epoch: [113][737/32]	Time  6.607 ( 6.607)	Data  5.981 ( 5.981)	Loss 7.5415e+00 (7.5415e+00)	Clip_Loss 7.5415e+00 (7.5415e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 56.0046 (56.0046)	Acc@5 78.1250 (78.1250)	Acc@10 85.9375 (85.9375)
Epoch: [113][757/32]	Time  0.596 ( 1.091)	Data  0.007 ( 0.482)	Loss 7.3463e+00 (7.1971e+00)	Clip_Loss 7.3463e+00 (7.1971e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 53.2305 (55.4645)	Acc@5 78.1250 (77.8274)	Acc@10 89.0625 (90.5506)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 113 running time:  0:00:59.009900
===> Building meters
DataParallel
4
Epoch: [114][769/32]	Time  6.996 ( 6.996)	Data  6.376 ( 6.376)	Loss 6.7226e+00 (6.7226e+00)	Clip_Loss 6.7226e+00 (6.7226e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 61.5763 (61.5763)	Acc@5 82.8125 (82.8125)	Acc@10 93.7500 (93.7500)
Epoch: [114][789/32]	Time  0.590 ( 1.281)	Data  0.007 ( 0.676)	Loss 7.6840e+00 (7.1537e+00)	Clip_Loss 7.6840e+00 (7.1537e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 52.4571 (55.3547)	Acc@5 75.0000 (79.7619)	Acc@10 89.0625 (91.3690)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 114 running time:  0:01:16.422237
===> Building meters
DataParallel
4
Epoch: [115][801/32]	Time  7.616 ( 7.616)	Data  7.023 ( 7.023)	Loss 6.8096e+00 (6.8096e+00)	Clip_Loss 6.8096e+00 (6.8096e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 56.2160 (56.2160)	Acc@5 76.5625 (76.5625)	Acc@10 93.7500 (93.7500)
Epoch: [115][821/32]	Time  0.592 ( 1.329)	Data  0.007 ( 0.722)	Loss 7.0123e+00 (7.3417e+00)	Clip_Loss 7.0123e+00 (7.3417e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 55.2215 (52.5071)	Acc@5 84.3750 (76.8601)	Acc@10 93.7500 (90.1042)
Epoch 115 running time:  0:00:40.519710
===> Building meters
DataParallel
4
Epoch: [116][833/32]	Time  6.396 ( 6.396)	Data  5.737 ( 5.737)	Loss 7.2152e+00 (7.2152e+00)	Clip_Loss 7.2152e+00 (7.2152e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 52.4726 (52.4726)	Acc@5 73.4375 (73.4375)	Acc@10 90.6250 (90.6250)
Epoch: [116][853/32]	Time  0.622 ( 1.136)	Data  0.007 ( 0.526)	Loss 6.7402e+00 (7.1127e+00)	Clip_Loss 6.7402e+00 (7.1127e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 59.5048 (54.8408)	Acc@5 89.0625 (79.0179)	Acc@10 93.7500 (91.4435)
Epoch 116 running time:  0:00:34.047948
===> Building meters
DataParallel
4
Epoch: [117][865/32]	Time  6.882 ( 6.882)	Data  6.280 ( 6.280)	Loss 6.7897e+00 (6.7897e+00)	Clip_Loss 6.7897e+00 (6.7897e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 61.1623 (61.1623)	Acc@5 87.5000 (87.5000)	Acc@10 92.1875 (92.1875)
Epoch: [117][885/32]	Time  0.613 ( 1.220)	Data  0.007 ( 0.613)	Loss 7.6460e+00 (7.1814e+00)	Clip_Loss 7.6460e+00 (7.1814e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 54.4963 (54.4400)	Acc@5 73.4375 (78.7946)	Acc@10 85.9375 (91.4435)
Epoch 117 running time:  0:00:37.692878
===> Building meters
DataParallel
4
Epoch: [118][897/32]	Time  6.272 ( 6.272)	Data  5.639 ( 5.639)	Loss 6.8660e+00 (6.8660e+00)	Clip_Loss 6.8660e+00 (6.8660e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 54.6614 (54.6614)	Acc@5 82.8125 (82.8125)	Acc@10 95.3125 (95.3125)
Epoch: [118][917/32]	Time  0.604 ( 1.176)	Data  0.008 ( 0.569)	Loss 7.6783e+00 (7.1333e+00)	Clip_Loss 7.6783e+00 (7.1333e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 44.9513 (53.7406)	Acc@5 71.8750 (78.4226)	Acc@10 89.0625 (92.1875)
Epoch 118 running time:  0:00:35.127610
====> Test::::/datasets/aicitychallenge2023/val.json
====> Query /datasets/aicitychallenge2023/val.json load
Test Epoch: [119][162/163]	Time 118.326 (118.326)	Data  0.000 ( 0.000)	Clip Loss 4.2779e+00 (4.2779e+00)	MRR 36.2599 (36.2599)	Acc@1 19.0000 (19.0000)	Acc@5 60.0000 (60.0000)
Epoch 119 running time:  0:01:58.332162
Logs dir: logs/dual_baseline_aug1 
====> results in csv format: 
| Method             | Dataset                                | Epoch   | Loss   | MRR    | Acc-5   | Acc-10   |
|:-------------------|:---------------------------------------|:--------|:-------|:-------|:--------|:---------|
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 19      | 4.418  | 18.029 | 6.000   | 29.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 39      | 4.318  | 25.640 | 12.000  | 39.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 59      | 4.308  | 26.601 | 10.000  | 45.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 79      | 4.256  | 32.901 | 16.000  | 53.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 99      | 4.248  | 35.485 | 19.000  | 54.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 119     | 4.278  | 36.260 | 19.000  | 60.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | Max_119 | 4.278  | 36.260 | 19.000  | 60.000   |
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best_eval.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best_eval.pth
===> Building meters
DataParallel
4
Epoch: [119][929/32]	Time  7.947 ( 7.947)	Data  7.318 ( 7.318)	Loss 7.2901e+00 (7.2901e+00)	Clip_Loss 7.2901e+00 (7.2901e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 54.3529 (54.3529)	Acc@5 73.4375 (73.4375)	Acc@10 82.8125 (82.8125)
Epoch: [119][949/32]	Time  0.631 ( 1.350)	Data  0.007 ( 0.737)	Loss 7.4733e+00 (7.1684e+00)	Clip_Loss 7.4733e+00 (7.1684e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 50.6727 (54.3015)	Acc@5 75.0000 (75.8929)	Acc@10 90.6250 (91.1458)
Epoch 119 running time:  0:00:40.774573
===> Building meters
DataParallel
4
Epoch: [120][ 1/32]	Time  6.808 ( 6.808)	Data  6.205 ( 6.205)	Loss 6.4770e+00 (6.4770e+00)	Clip_Loss 6.4770e+00 (6.4770e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 57.0272 (57.0272)	Acc@5 79.6875 (79.6875)	Acc@10 92.1875 (92.1875)
Epoch: [120][21/32]	Time  0.680 ( 1.104)	Data  0.007 ( 0.490)	Loss 8.1527e+00 (7.0801e+00)	Clip_Loss 8.1527e+00 (7.0801e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 46.2771 (55.6715)	Acc@5 70.3125 (78.4226)	Acc@10 87.5000 (91.2202)
Epoch 120 running time:  0:00:33.766764
===> Building meters
DataParallel
4
Epoch: [121][33/32]	Time  7.098 ( 7.098)	Data  6.450 ( 6.450)	Loss 7.4341e+00 (7.4341e+00)	Clip_Loss 7.4341e+00 (7.4341e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 50.0504 (50.0504)	Acc@5 79.6875 (79.6875)	Acc@10 89.0625 (89.0625)
Epoch: [121][53/32]	Time  0.640 ( 1.259)	Data  0.007 ( 0.654)	Loss 7.6169e+00 (7.1358e+00)	Clip_Loss 7.6169e+00 (7.1358e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 51.2289 (54.4413)	Acc@5 76.5625 (79.9107)	Acc@10 93.7500 (93.1548)
Epoch 121 running time:  0:00:38.600174
===> Building meters
DataParallel
4
Epoch: [122][65/32]	Time  5.847 ( 5.847)	Data  5.246 ( 5.246)	Loss 6.8667e+00 (6.8667e+00)	Clip_Loss 6.8667e+00 (6.8667e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 54.6714 (54.6714)	Acc@5 87.5000 (87.5000)	Acc@10 93.7500 (93.7500)
Epoch: [122][85/32]	Time  1.232 ( 1.098)	Data  0.628 ( 0.493)	Loss 6.6509e+00 (6.9374e+00)	Clip_Loss 6.6509e+00 (6.9374e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 53.4037 (55.8190)	Acc@5 78.1250 (80.5804)	Acc@10 92.1875 (92.9315)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 122 running time:  0:01:15.465945
===> Building meters
DataParallel
4
Epoch: [123][97/32]	Time  7.308 ( 7.308)	Data  6.684 ( 6.684)	Loss 7.6020e+00 (7.6020e+00)	Clip_Loss 7.6020e+00 (7.6020e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 51.5955 (51.5955)	Acc@5 71.8750 (71.8750)	Acc@10 90.6250 (90.6250)
Epoch: [123][117/32]	Time  0.650 ( 1.299)	Data  0.007 ( 0.690)	Loss 7.6232e+00 (6.9146e+00)	Clip_Loss 7.6232e+00 (6.9146e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 49.3558 (54.8390)	Acc@5 71.8750 (80.5804)	Acc@10 84.3750 (93.2292)
Epoch 123 running time:  0:00:39.011885
===> Building meters
DataParallel
4
Epoch: [124][129/32]	Time  5.639 ( 5.639)	Data  5.037 ( 5.037)	Loss 6.9811e+00 (6.9811e+00)	Clip_Loss 6.9811e+00 (6.9811e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 56.1031 (56.1031)	Acc@5 78.1250 (78.1250)	Acc@10 93.7500 (93.7500)
Epoch: [124][149/32]	Time  0.624 ( 1.037)	Data  0.007 ( 0.432)	Loss 7.7318e+00 (7.0540e+00)	Clip_Loss 7.7318e+00 (7.0540e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 52.8327 (55.3397)	Acc@5 71.8750 (78.1994)	Acc@10 92.1875 (92.4851)
Epoch 124 running time:  0:00:31.849184
===> Building meters
DataParallel
4
Epoch: [125][161/32]	Time  6.837 ( 6.837)	Data  6.197 ( 6.197)	Loss 6.9486e+00 (6.9486e+00)	Clip_Loss 6.9486e+00 (6.9486e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 55.8991 (55.8991)	Acc@5 76.5625 (76.5625)	Acc@10 98.4375 (98.4375)
Epoch: [125][181/32]	Time  0.742 ( 1.192)	Data  0.120 ( 0.577)	Loss 6.5409e+00 (6.8908e+00)	Clip_Loss 6.5409e+00 (6.8908e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 61.3869 (56.9000)	Acc@5 81.2500 (81.1012)	Acc@10 95.3125 (93.0060)
Epoch 125 running time:  0:00:37.450562
===> Building meters
DataParallel
4
Epoch: [126][193/32]	Time  6.328 ( 6.328)	Data  5.654 ( 5.654)	Loss 7.3847e+00 (7.3847e+00)	Clip_Loss 7.3847e+00 (7.3847e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 51.3350 (51.3350)	Acc@5 71.8750 (71.8750)	Acc@10 90.6250 (90.6250)
Epoch: [126][213/32]	Time  0.616 ( 1.085)	Data  0.008 ( 0.474)	Loss 6.1694e+00 (6.9558e+00)	Clip_Loss 6.1694e+00 (6.9558e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 58.4940 (55.0907)	Acc@5 87.5000 (79.6875)	Acc@10 98.4375 (92.5595)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 126 running time:  0:01:24.884648
===> Building meters
DataParallel
4
Epoch: [127][225/32]	Time  7.801 ( 7.801)	Data  7.124 ( 7.124)	Loss 7.0174e+00 (7.0174e+00)	Clip_Loss 7.0174e+00 (7.0174e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 57.1483 (57.1483)	Acc@5 78.1250 (78.1250)	Acc@10 92.1875 (92.1875)
Epoch: [127][245/32]	Time  0.617 ( 1.475)	Data  0.007 ( 0.864)	Loss 6.7983e+00 (6.9771e+00)	Clip_Loss 6.7983e+00 (6.9771e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 55.7145 (56.0482)	Acc@5 82.8125 (80.6548)	Acc@10 96.8750 (92.5595)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 127 running time:  0:01:16.697476
===> Building meters
DataParallel
4
Epoch: [128][257/32]	Time  6.874 ( 6.874)	Data  6.240 ( 6.240)	Loss 6.5417e+00 (6.5417e+00)	Clip_Loss 6.5417e+00 (6.5417e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 63.8977 (63.8977)	Acc@5 82.8125 (82.8125)	Acc@10 92.1875 (92.1875)
Epoch: [128][277/32]	Time  1.073 ( 1.236)	Data  0.487 ( 0.625)	Loss 6.4866e+00 (6.7812e+00)	Clip_Loss 6.4866e+00 (6.7812e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 61.3939 (57.4372)	Acc@5 78.1250 (81.3244)	Acc@10 92.1875 (93.3036)
Epoch 128 running time:  0:00:37.955839
===> Building meters
DataParallel
4
Epoch: [129][289/32]	Time  6.814 ( 6.814)	Data  6.174 ( 6.174)	Loss 6.9671e+00 (6.9671e+00)	Clip_Loss 6.9671e+00 (6.9671e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 58.1636 (58.1636)	Acc@5 84.3750 (84.3750)	Acc@10 96.8750 (96.8750)
Epoch: [129][309/32]	Time  0.600 ( 1.204)	Data  0.007 ( 0.597)	Loss 7.5595e+00 (7.0811e+00)	Clip_Loss 7.5595e+00 (7.0811e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 52.3153 (55.4176)	Acc@5 81.2500 (79.7619)	Acc@10 89.0625 (91.7411)
Epoch 129 running time:  0:00:37.034391
===> Building meters
DataParallel
4
Epoch: [130][321/32]	Time  6.351 ( 6.351)	Data  5.742 ( 5.742)	Loss 7.0407e+00 (7.0407e+00)	Clip_Loss 7.0407e+00 (7.0407e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 57.0933 (57.0933)	Acc@5 76.5625 (76.5625)	Acc@10 93.7500 (93.7500)
Epoch: [130][341/32]	Time  0.627 ( 1.251)	Data  0.007 ( 0.639)	Loss 7.2979e+00 (6.9087e+00)	Clip_Loss 7.2979e+00 (6.9087e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 50.0587 (56.2378)	Acc@5 76.5625 (79.4643)	Acc@10 95.3125 (92.7827)
Epoch 130 running time:  0:00:37.636077
===> Building meters
DataParallel
4
Epoch: [131][353/32]	Time  6.011 ( 6.011)	Data  5.333 ( 5.333)	Loss 6.8921e+00 (6.8921e+00)	Clip_Loss 6.8921e+00 (6.8921e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 56.8057 (56.8057)	Acc@5 85.9375 (85.9375)	Acc@10 93.7500 (93.7500)
Epoch: [131][373/32]	Time  0.621 ( 1.133)	Data  0.008 ( 0.517)	Loss 6.9222e+00 (6.9895e+00)	Clip_Loss 6.9222e+00 (6.9895e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 55.9658 (55.8162)	Acc@5 81.2500 (81.3244)	Acc@10 92.1875 (93.1548)
Epoch 131 running time:  0:00:34.099830
===> Building meters
DataParallel
4
Epoch: [132][385/32]	Time  6.615 ( 6.615)	Data  6.022 ( 6.022)	Loss 6.7887e+00 (6.7887e+00)	Clip_Loss 6.7887e+00 (6.7887e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 55.3070 (55.3070)	Acc@5 81.2500 (81.2500)	Acc@10 95.3125 (95.3125)
Epoch: [132][405/32]	Time  0.596 ( 1.197)	Data  0.007 ( 0.582)	Loss 6.4443e+00 (7.0149e+00)	Clip_Loss 6.4443e+00 (7.0149e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 61.2840 (55.7816)	Acc@5 76.5625 (79.9851)	Acc@10 95.3125 (92.8571)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 132 running time:  0:01:26.156578
===> Building meters
DataParallel
4
Epoch: [133][417/32]	Time  8.084 ( 8.084)	Data  7.464 ( 7.464)	Loss 6.9887e+00 (6.9887e+00)	Clip_Loss 6.9887e+00 (6.9887e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 51.7042 (51.7042)	Acc@5 75.0000 (75.0000)	Acc@10 95.3125 (95.3125)
Epoch: [133][437/32]	Time  0.591 ( 1.362)	Data  0.007 ( 0.753)	Loss 7.9645e+00 (7.1282e+00)	Clip_Loss 7.9645e+00 (7.1282e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 46.0342 (54.9551)	Acc@5 65.6250 (78.6458)	Acc@10 89.0625 (92.5595)
Epoch 133 running time:  0:00:40.598296
===> Building meters
DataParallel
4
Epoch: [134][449/32]	Time  6.412 ( 6.412)	Data  5.815 ( 5.815)	Loss 7.3101e+00 (7.3101e+00)	Clip_Loss 7.3101e+00 (7.3101e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 52.4366 (52.4366)	Acc@5 71.8750 (71.8750)	Acc@10 92.1875 (92.1875)
Epoch: [134][469/32]	Time  0.628 ( 1.072)	Data  0.007 ( 0.458)	Loss 6.5053e+00 (7.0519e+00)	Clip_Loss 6.5053e+00 (7.0519e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 61.1706 (55.1340)	Acc@5 81.2500 (80.3571)	Acc@10 95.3125 (92.6339)
Epoch 134 running time:  0:00:33.160063
===> Building meters
DataParallel
4
Epoch: [135][481/32]	Time  6.683 ( 6.683)	Data  6.036 ( 6.036)	Loss 6.5600e+00 (6.5600e+00)	Clip_Loss 6.5600e+00 (6.5600e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 61.8198 (61.8198)	Acc@5 81.2500 (81.2500)	Acc@10 93.7500 (93.7500)
Epoch: [135][501/32]	Time  0.648 ( 1.217)	Data  0.043 ( 0.602)	Loss 6.4779e+00 (6.7454e+00)	Clip_Loss 6.4779e+00 (6.7454e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 59.5393 (58.9535)	Acc@5 81.2500 (82.1429)	Acc@10 90.6250 (92.7827)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 135 running time:  0:01:14.190911
===> Building meters
DataParallel
4
Epoch: [136][513/32]	Time  6.932 ( 6.932)	Data  6.321 ( 6.321)	Loss 6.1386e+00 (6.1386e+00)	Clip_Loss 6.1386e+00 (6.1386e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 63.3600 (63.3600)	Acc@5 82.8125 (82.8125)	Acc@10 98.4375 (98.4375)
Epoch: [136][533/32]	Time  0.596 ( 1.265)	Data  0.007 ( 0.653)	Loss 7.1166e+00 (7.0477e+00)	Clip_Loss 7.1166e+00 (7.0477e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 52.4845 (55.8423)	Acc@5 76.5625 (80.2827)	Acc@10 93.7500 (92.4851)
Epoch 136 running time:  0:00:38.895333
===> Building meters
DataParallel
4
Epoch: [137][545/32]	Time  6.314 ( 6.314)	Data  5.679 ( 5.679)	Loss 6.3213e+00 (6.3213e+00)	Clip_Loss 6.3213e+00 (6.3213e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 62.1608 (62.1608)	Acc@5 87.5000 (87.5000)	Acc@10 96.8750 (96.8750)
Epoch: [137][565/32]	Time  0.631 ( 1.114)	Data  0.010 ( 0.503)	Loss 6.9380e+00 (6.8669e+00)	Clip_Loss 6.9380e+00 (6.8669e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 54.0345 (55.8265)	Acc@5 84.3750 (81.8452)	Acc@10 95.3125 (93.0804)
Epoch 137 running time:  0:00:34.981193
===> Building meters
DataParallel
4
Epoch: [138][577/32]	Time  6.771 ( 6.771)	Data  6.168 ( 6.168)	Loss 6.9412e+00 (6.9412e+00)	Clip_Loss 6.9412e+00 (6.9412e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 57.2379 (57.2379)	Acc@5 85.9375 (85.9375)	Acc@10 92.1875 (92.1875)
Epoch: [138][597/32]	Time  0.590 ( 1.185)	Data  0.007 ( 0.575)	Loss 6.7485e+00 (6.8417e+00)	Clip_Loss 6.7485e+00 (6.8417e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 62.2665 (57.6441)	Acc@5 85.9375 (80.5060)	Acc@10 89.0625 (92.2619)
Epoch 138 running time:  0:00:36.253846
====> Test::::/datasets/aicitychallenge2023/val.json
====> Query /datasets/aicitychallenge2023/val.json load
Test Epoch: [139][162/163]	Time 116.496 (116.496)	Data  0.000 ( 0.000)	Clip Loss 4.2577e+00 (4.2577e+00)	MRR 34.7359 (34.7359)	Acc@1 18.0000 (18.0000)	Acc@5 56.0000 (56.0000)
Epoch 139 running time:  0:01:56.503780
Logs dir: logs/dual_baseline_aug1 
====> results in csv format: 
| Method             | Dataset                                | Epoch   | Loss   | MRR    | Acc-5   | Acc-10   |
|:-------------------|:---------------------------------------|:--------|:-------|:-------|:--------|:---------|
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 19      | 4.418  | 18.029 | 6.000   | 29.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 39      | 4.318  | 25.640 | 12.000  | 39.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 59      | 4.308  | 26.601 | 10.000  | 45.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 79      | 4.256  | 32.901 | 16.000  | 53.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 99      | 4.248  | 35.485 | 19.000  | 54.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 119     | 4.278  | 36.260 | 19.000  | 60.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 139     | 4.258  | 34.736 | 18.000  | 56.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | Max_119 | 4.278  | 36.260 | 19.000  | 60.000   |
===> Building meters
DataParallel
4
Epoch: [139][609/32]	Time  7.245 ( 7.245)	Data  6.653 ( 6.653)	Loss 6.9687e+00 (6.9687e+00)	Clip_Loss 6.9687e+00 (6.9687e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 57.8289 (57.8289)	Acc@5 79.6875 (79.6875)	Acc@10 95.3125 (95.3125)
Epoch: [139][629/32]	Time  0.623 ( 1.311)	Data  0.007 ( 0.703)	Loss 6.0357e+00 (6.7667e+00)	Clip_Loss 6.0357e+00 (6.7667e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 62.9074 (58.4858)	Acc@5 87.5000 (82.9613)	Acc@10 96.8750 (93.3036)
Epoch 139 running time:  0:00:39.433313
===> Building meters
DataParallel
4
Epoch: [140][641/32]	Time  6.193 ( 6.193)	Data  5.569 ( 5.569)	Loss 6.5702e+00 (6.5702e+00)	Clip_Loss 6.5702e+00 (6.5702e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 56.0499 (56.0499)	Acc@5 85.9375 (85.9375)	Acc@10 95.3125 (95.3125)
Epoch: [140][661/32]	Time  0.592 ( 1.044)	Data  0.007 ( 0.431)	Loss 6.3692e+00 (6.9147e+00)	Clip_Loss 6.3692e+00 (6.9147e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 60.2085 (55.6105)	Acc@5 84.3750 (78.7202)	Acc@10 95.3125 (91.9643)
Epoch 140 running time:  0:00:32.111139
===> Building meters
DataParallel
4
Epoch: [141][673/32]	Time  6.303 ( 6.303)	Data  5.683 ( 5.683)	Loss 7.0758e+00 (7.0758e+00)	Clip_Loss 7.0758e+00 (7.0758e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 58.3283 (58.3283)	Acc@5 79.6875 (79.6875)	Acc@10 92.1875 (92.1875)
Epoch: [141][693/32]	Time  0.628 ( 1.168)	Data  0.007 ( 0.558)	Loss 6.7850e+00 (6.7393e+00)	Clip_Loss 6.7850e+00 (6.7393e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 58.9530 (57.9635)	Acc@5 81.2500 (81.1756)	Acc@10 93.7500 (92.9315)
Epoch 141 running time:  0:00:36.484351
===> Building meters
DataParallel
4
Epoch: [142][705/32]	Time  6.466 ( 6.466)	Data  5.835 ( 5.835)	Loss 7.0512e+00 (7.0512e+00)	Clip_Loss 7.0512e+00 (7.0512e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 55.3122 (55.3122)	Acc@5 82.8125 (82.8125)	Acc@10 90.6250 (90.6250)
Epoch: [142][725/32]	Time  0.613 ( 1.119)	Data  0.007 ( 0.510)	Loss 6.9949e+00 (6.8229e+00)	Clip_Loss 6.9949e+00 (6.8229e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 61.6130 (57.8171)	Acc@5 81.2500 (82.8869)	Acc@10 90.6250 (93.5268)
Epoch 142 running time:  0:00:34.084041
===> Building meters
DataParallel
4
Epoch: [143][737/32]	Time  6.464 ( 6.464)	Data  5.754 ( 5.754)	Loss 7.2209e+00 (7.2209e+00)	Clip_Loss 7.2209e+00 (7.2209e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 59.7351 (59.7351)	Acc@5 81.2500 (81.2500)	Acc@10 90.6250 (90.6250)
Epoch: [143][757/32]	Time  0.593 ( 1.153)	Data  0.007 ( 0.543)	Loss 7.0697e+00 (6.8999e+00)	Clip_Loss 7.0697e+00 (6.8999e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 51.8549 (56.3232)	Acc@5 71.8750 (80.3571)	Acc@10 92.1875 (93.5268)
Epoch 143 running time:  0:00:36.213896
===> Building meters
DataParallel
4
Epoch: [144][769/32]	Time  6.711 ( 6.711)	Data  6.088 ( 6.088)	Loss 7.1363e+00 (7.1363e+00)	Clip_Loss 7.1363e+00 (7.1363e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 53.1263 (53.1263)	Acc@5 76.5625 (76.5625)	Acc@10 95.3125 (95.3125)
Epoch: [144][789/32]	Time  0.614 ( 1.143)	Data  0.007 ( 0.540)	Loss 7.4380e+00 (7.0184e+00)	Clip_Loss 7.4380e+00 (7.0184e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 51.6827 (55.6297)	Acc@5 71.8750 (80.3571)	Acc@10 85.9375 (92.2619)
Epoch 144 running time:  0:00:35.044062
===> Building meters
DataParallel
4
Epoch: [145][801/32]	Time  6.394 ( 6.394)	Data  5.753 ( 5.753)	Loss 6.8804e+00 (6.8804e+00)	Clip_Loss 6.8804e+00 (6.8804e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 58.1990 (58.1990)	Acc@5 84.3750 (84.3750)	Acc@10 92.1875 (92.1875)
Epoch: [145][821/32]	Time  0.629 ( 1.112)	Data  0.007 ( 0.506)	Loss 6.6914e+00 (6.7227e+00)	Clip_Loss 6.6914e+00 (6.7227e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 60.1796 (58.8669)	Acc@5 84.3750 (83.0357)	Acc@10 90.6250 (92.8571)
Epoch 145 running time:  0:00:34.174618
===> Building meters
DataParallel
4
Epoch: [146][833/32]	Time  6.168 ( 6.168)	Data  5.539 ( 5.539)	Loss 7.0030e+00 (7.0030e+00)	Clip_Loss 7.0030e+00 (7.0030e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 59.3958 (59.3958)	Acc@5 78.1250 (78.1250)	Acc@10 90.6250 (90.6250)
Epoch: [146][853/32]	Time  0.657 ( 1.163)	Data  0.008 ( 0.547)	Loss 6.6434e+00 (6.7926e+00)	Clip_Loss 6.6434e+00 (6.7926e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 58.4031 (58.5316)	Acc@5 89.0625 (83.7054)	Acc@10 92.1875 (92.7827)
Epoch 146 running time:  0:00:35.089254
===> Building meters
DataParallel
4
Epoch: [147][865/32]	Time  5.956 ( 5.956)	Data  5.361 ( 5.361)	Loss 6.8812e+00 (6.8812e+00)	Clip_Loss 6.8812e+00 (6.8812e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 56.9906 (56.9906)	Acc@5 82.8125 (82.8125)	Acc@10 93.7500 (93.7500)
Epoch: [147][885/32]	Time  0.644 ( 1.110)	Data  0.008 ( 0.500)	Loss 7.0906e+00 (6.8658e+00)	Clip_Loss 7.0906e+00 (6.8658e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 52.2472 (56.6172)	Acc@5 76.5625 (80.2083)	Acc@10 90.6250 (92.1875)
Epoch 147 running time:  0:00:34.245556
===> Building meters
DataParallel
4
Epoch: [148][897/32]	Time  6.371 ( 6.371)	Data  5.717 ( 5.717)	Loss 6.5413e+00 (6.5413e+00)	Clip_Loss 6.5413e+00 (6.5413e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 57.6025 (57.6025)	Acc@5 84.3750 (84.3750)	Acc@10 95.3125 (95.3125)
Epoch: [148][917/32]	Time  0.624 ( 1.136)	Data  0.008 ( 0.530)	Loss 6.4330e+00 (6.8374e+00)	Clip_Loss 6.4330e+00 (6.8374e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 57.7734 (57.2947)	Acc@5 87.5000 (81.9940)	Acc@10 93.7500 (92.2619)
Epoch 148 running time:  0:00:34.836041
===> Building meters
DataParallel
4
Epoch: [149][929/32]	Time  6.427 ( 6.427)	Data  5.813 ( 5.813)	Loss 6.6853e+00 (6.6853e+00)	Clip_Loss 6.6853e+00 (6.6853e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 57.3481 (57.3481)	Acc@5 85.9375 (85.9375)	Acc@10 95.3125 (95.3125)
Epoch: [149][949/32]	Time  0.618 ( 1.127)	Data  0.007 ( 0.521)	Loss 6.9166e+00 (6.7416e+00)	Clip_Loss 6.9166e+00 (6.7416e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 57.3698 (58.2517)	Acc@5 76.5625 (82.5893)	Acc@10 93.7500 (94.4196)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 149 running time:  0:01:15.523764
===> Building meters
DataParallel
4
Epoch: [150][ 1/32]	Time  7.091 ( 7.091)	Data  6.471 ( 6.471)	Loss 6.4259e+00 (6.4259e+00)	Clip_Loss 6.4259e+00 (6.4259e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 63.3953 (63.3953)	Acc@5 84.3750 (84.3750)	Acc@10 98.4375 (98.4375)
Epoch: [150][21/32]	Time  0.629 ( 1.257)	Data  0.009 ( 0.638)	Loss 7.1207e+00 (6.6731e+00)	Clip_Loss 7.1207e+00 (6.6731e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 53.6068 (59.7073)	Acc@5 76.5625 (82.8869)	Acc@10 90.6250 (95.3125)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 150 running time:  0:01:23.902590
===> Building meters
DataParallel
4
Epoch: [151][33/32]	Time  7.577 ( 7.577)	Data  6.913 ( 6.913)	Loss 6.7406e+00 (6.7406e+00)	Clip_Loss 6.7406e+00 (6.7406e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 58.3544 (58.3544)	Acc@5 90.6250 (90.6250)	Acc@10 96.8750 (96.8750)
Epoch: [151][53/32]	Time  0.626 ( 1.295)	Data  0.007 ( 0.684)	Loss 6.6202e+00 (6.6120e+00)	Clip_Loss 6.6202e+00 (6.6120e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 64.0758 (59.3987)	Acc@5 89.0625 (83.3333)	Acc@10 96.8750 (94.2708)
Epoch 151 running time:  0:00:38.709589
===> Building meters
DataParallel
4
Epoch: [152][65/32]	Time  6.104 ( 6.104)	Data  5.481 ( 5.481)	Loss 6.5799e+00 (6.5799e+00)	Clip_Loss 6.5799e+00 (6.5799e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 60.1608 (60.1608)	Acc@5 82.8125 (82.8125)	Acc@10 92.1875 (92.1875)
Epoch: [152][85/32]	Time  0.620 ( 1.051)	Data  0.009 ( 0.442)	Loss 6.7578e+00 (6.7722e+00)	Clip_Loss 6.7578e+00 (6.7722e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 62.1779 (58.9083)	Acc@5 79.6875 (81.8452)	Acc@10 93.7500 (93.6756)
Epoch 152 running time:  0:00:32.182777
===> Building meters
DataParallel
4
Epoch: [153][97/32]	Time  6.116 ( 6.116)	Data  5.512 ( 5.512)	Loss 6.5494e+00 (6.5494e+00)	Clip_Loss 6.5494e+00 (6.5494e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 60.2900 (60.2900)	Acc@5 84.3750 (84.3750)	Acc@10 92.1875 (92.1875)
Epoch: [153][117/32]	Time  0.606 ( 1.136)	Data  0.007 ( 0.526)	Loss 6.6440e+00 (6.5177e+00)	Clip_Loss 6.6440e+00 (6.5177e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 58.6769 (59.8575)	Acc@5 84.3750 (84.8958)	Acc@10 92.1875 (94.9405)
Epoch 153 running time:  0:00:35.817279
===> Building meters
DataParallel
4
Epoch: [154][129/32]	Time  6.733 ( 6.733)	Data  6.140 ( 6.140)	Loss 6.0792e+00 (6.0792e+00)	Clip_Loss 6.0792e+00 (6.0792e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 61.3840 (61.3840)	Acc@5 81.2500 (81.2500)	Acc@10 95.3125 (95.3125)
Epoch: [154][149/32]	Time  0.593 ( 1.212)	Data  0.007 ( 0.599)	Loss 6.4626e+00 (6.8561e+00)	Clip_Loss 6.4626e+00 (6.8561e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 63.5464 (58.1524)	Acc@5 81.2500 (82.1429)	Acc@10 95.3125 (93.0804)
Epoch 154 running time:  0:00:35.525027
===> Building meters
DataParallel
4
Epoch: [155][161/32]	Time  6.419 ( 6.419)	Data  5.804 ( 5.804)	Loss 7.2536e+00 (7.2536e+00)	Clip_Loss 7.2536e+00 (7.2536e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 52.1466 (52.1466)	Acc@5 78.1250 (78.1250)	Acc@10 96.8750 (96.8750)
Epoch: [155][181/32]	Time  0.623 ( 1.126)	Data  0.007 ( 0.503)	Loss 7.3057e+00 (6.8605e+00)	Clip_Loss 7.3057e+00 (6.8605e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 57.4570 (59.0771)	Acc@5 81.2500 (81.3244)	Acc@10 90.6250 (94.1964)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 155 running time:  0:01:05.767117
===> Building meters
DataParallel
4
Epoch: [156][193/32]	Time  6.621 ( 6.621)	Data  5.999 ( 5.999)	Loss 6.2045e+00 (6.2045e+00)	Clip_Loss 6.2045e+00 (6.2045e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 63.7116 (63.7116)	Acc@5 92.1875 (92.1875)	Acc@10 95.3125 (95.3125)
Epoch: [156][213/32]	Time  0.596 ( 1.229)	Data  0.007 ( 0.616)	Loss 6.6715e+00 (6.6714e+00)	Clip_Loss 6.6715e+00 (6.6714e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 58.9359 (60.1454)	Acc@5 81.2500 (83.3333)	Acc@10 92.1875 (94.0476)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 156 running time:  0:01:25.401267
===> Building meters
DataParallel
4
Epoch: [157][225/32]	Time  7.414 ( 7.414)	Data  6.798 ( 6.798)	Loss 6.6401e+00 (6.6401e+00)	Clip_Loss 6.6401e+00 (6.6401e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 58.5020 (58.5020)	Acc@5 89.0625 (89.0625)	Acc@10 96.8750 (96.8750)
Epoch: [157][245/32]	Time  0.592 ( 1.287)	Data  0.007 ( 0.679)	Loss 5.9847e+00 (6.7350e+00)	Clip_Loss 5.9847e+00 (6.7350e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 62.8260 (59.1207)	Acc@5 89.0625 (82.5893)	Acc@10 96.8750 (93.2292)
Epoch 157 running time:  0:00:43.484598
===> Building meters
DataParallel
4
Epoch: [158][257/32]	Time  6.214 ( 6.214)	Data  5.606 ( 5.606)	Loss 5.3439e+00 (5.3439e+00)	Clip_Loss 5.3439e+00 (5.3439e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 70.8743 (70.8743)	Acc@5 92.1875 (92.1875)	Acc@10 100.0000 (100.0000)
Epoch: [158][277/32]	Time  0.595 ( 1.083)	Data  0.007 ( 0.472)	Loss 7.0048e+00 (6.5532e+00)	Clip_Loss 7.0048e+00 (6.5532e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 58.7524 (62.4981)	Acc@5 79.6875 (84.4494)	Acc@10 95.3125 (95.0149)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 158 running time:  0:01:01.395756
====> Test::::/datasets/aicitychallenge2023/val.json
====> Query /datasets/aicitychallenge2023/val.json load
Test Epoch: [159][162/163]	Time 115.917 (115.917)	Data  0.000 ( 0.000)	Clip Loss 4.2319e+00 (4.2319e+00)	MRR 35.2432 (35.2432)	Acc@1 21.0000 (21.0000)	Acc@5 51.0000 (51.0000)
Epoch 159 running time:  0:01:55.922903
Logs dir: logs/dual_baseline_aug1 
====> results in csv format: 
| Method             | Dataset                                | Epoch   | Loss   | MRR    | Acc-5   | Acc-10   |
|:-------------------|:---------------------------------------|:--------|:-------|:-------|:--------|:---------|
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 19      | 4.418  | 18.029 | 6.000   | 29.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 39      | 4.318  | 25.640 | 12.000  | 39.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 59      | 4.308  | 26.601 | 10.000  | 45.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 79      | 4.256  | 32.901 | 16.000  | 53.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 99      | 4.248  | 35.485 | 19.000  | 54.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 119     | 4.278  | 36.260 | 19.000  | 60.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 139     | 4.258  | 34.736 | 18.000  | 56.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 159     | 4.232  | 35.243 | 21.000  | 51.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | Max_119 | 4.278  | 36.260 | 19.000  | 60.000   |
===> Building meters
DataParallel
4
Epoch: [159][289/32]	Time  7.030 ( 7.030)	Data  6.385 ( 6.385)	Loss 6.8439e+00 (6.8439e+00)	Clip_Loss 6.8439e+00 (6.8439e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 56.8951 (56.8951)	Acc@5 82.8125 (82.8125)	Acc@10 87.5000 (87.5000)
Epoch: [159][309/32]	Time  0.614 ( 1.315)	Data  0.007 ( 0.708)	Loss 5.9973e+00 (6.6974e+00)	Clip_Loss 5.9973e+00 (6.6974e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 64.2778 (59.6349)	Acc@5 84.3750 (81.9940)	Acc@10 95.3125 (93.9732)
Epoch 159 running time:  0:00:39.162005
===> Building meters
DataParallel
4
Epoch: [160][321/32]	Time  5.927 ( 5.927)	Data  5.289 ( 5.289)	Loss 7.5464e+00 (7.5464e+00)	Clip_Loss 7.5464e+00 (7.5464e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 50.6272 (50.6272)	Acc@5 76.5625 (76.5625)	Acc@10 89.0625 (89.0625)
Epoch: [160][341/32]	Time  0.596 ( 1.045)	Data  0.007 ( 0.434)	Loss 6.0345e+00 (6.3420e+00)	Clip_Loss 6.0345e+00 (6.3420e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 63.0843 (62.3585)	Acc@5 87.5000 (86.0119)	Acc@10 95.3125 (95.1637)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 160 running time:  0:03:15.248432
===> Building meters
DataParallel
4
Epoch: [161][353/32]	Time  7.196 ( 7.196)	Data  6.560 ( 6.560)	Loss 6.2329e+00 (6.2329e+00)	Clip_Loss 6.2329e+00 (6.2329e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 63.3788 (63.3788)	Acc@5 84.3750 (84.3750)	Acc@10 95.3125 (95.3125)
Epoch: [161][373/32]	Time  0.616 ( 1.265)	Data  0.008 ( 0.656)	Loss 5.8336e+00 (6.0879e+00)	Clip_Loss 5.8336e+00 (6.0879e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 66.9996 (63.1229)	Acc@5 84.3750 (86.5327)	Acc@10 98.4375 (96.3542)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 161 running time:  0:01:05.188978
===> Building meters
DataParallel
4
Epoch: [162][385/32]	Time  6.350 ( 6.350)	Data  5.725 ( 5.725)	Loss 6.1650e+00 (6.1650e+00)	Clip_Loss 6.1650e+00 (6.1650e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 69.4216 (69.4216)	Acc@5 89.0625 (89.0625)	Acc@10 95.3125 (95.3125)
Epoch: [162][405/32]	Time  0.614 ( 1.158)	Data  0.007 ( 0.546)	Loss 6.6499e+00 (5.8802e+00)	Clip_Loss 6.6499e+00 (5.8802e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 63.4709 (65.6895)	Acc@5 82.8125 (89.2113)	Acc@10 95.3125 (96.8006)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 162 running time:  0:01:02.551250
===> Building meters
DataParallel
4
Epoch: [163][417/32]	Time  6.374 ( 6.374)	Data  5.756 ( 5.756)	Loss 5.6502e+00 (5.6502e+00)	Clip_Loss 5.6502e+00 (5.6502e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 67.9398 (67.9398)	Acc@5 85.9375 (85.9375)	Acc@10 95.3125 (95.3125)
Epoch: [163][437/32]	Time  0.612 ( 1.182)	Data  0.007 ( 0.566)	Loss 5.0388e+00 (5.8310e+00)	Clip_Loss 5.0388e+00 (5.8310e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 72.1435 (66.5170)	Acc@5 93.7500 (88.5417)	Acc@10 100.0000 (96.7262)
Epoch 163 running time:  0:00:36.413415
===> Building meters
DataParallel
4
Epoch: [164][449/32]	Time  6.446 ( 6.446)	Data  5.823 ( 5.823)	Loss 6.6998e+00 (6.6998e+00)	Clip_Loss 6.6998e+00 (6.6998e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 55.7918 (55.7918)	Acc@5 84.3750 (84.3750)	Acc@10 95.3125 (95.3125)
Epoch: [164][469/32]	Time  0.627 ( 1.077)	Data  0.007 ( 0.468)	Loss 5.2573e+00 (5.7945e+00)	Clip_Loss 5.2573e+00 (5.7945e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 69.2051 (66.8003)	Acc@5 87.5000 (88.6161)	Acc@10 100.0000 (97.0238)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 164 running time:  0:01:03.608196
===> Building meters
DataParallel
4
Epoch: [165][481/32]	Time  7.129 ( 7.129)	Data  6.502 ( 6.502)	Loss 5.6981e+00 (5.6981e+00)	Clip_Loss 5.6981e+00 (5.6981e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 66.0842 (66.0842)	Acc@5 87.5000 (87.5000)	Acc@10 95.3125 (95.3125)
Epoch: [165][501/32]	Time  0.592 ( 1.253)	Data  0.007 ( 0.638)	Loss 6.1338e+00 (5.9487e+00)	Clip_Loss 6.1338e+00 (5.9487e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 69.6984 (66.0414)	Acc@5 89.0625 (87.4256)	Acc@10 95.3125 (96.8006)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 165 running time:  0:01:02.854080
===> Building meters
DataParallel
4
Epoch: [166][513/32]	Time  6.223 ( 6.223)	Data  5.581 ( 5.581)	Loss 5.6596e+00 (5.6596e+00)	Clip_Loss 5.6596e+00 (5.6596e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 65.3237 (65.3237)	Acc@5 89.0625 (89.0625)	Acc@10 98.4375 (98.4375)
Epoch: [166][533/32]	Time  0.620 ( 1.331)	Data  0.007 ( 0.719)	Loss 5.7178e+00 (5.8073e+00)	Clip_Loss 5.7178e+00 (5.8073e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 71.3235 (66.7406)	Acc@5 92.1875 (89.5089)	Acc@10 96.8750 (96.2054)
Epoch 166 running time:  0:00:39.803766
===> Building meters
DataParallel
4
Epoch: [167][545/32]	Time  6.502 ( 6.502)	Data  5.855 ( 5.855)	Loss 4.9297e+00 (4.9297e+00)	Clip_Loss 4.9297e+00 (4.9297e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 70.4967 (70.4967)	Acc@5 93.7500 (93.7500)	Acc@10 100.0000 (100.0000)
Epoch: [167][565/32]	Time  0.615 ( 1.112)	Data  0.007 ( 0.504)	Loss 5.0107e+00 (5.4865e+00)	Clip_Loss 5.0107e+00 (5.4865e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 71.0807 (68.2055)	Acc@5 95.3125 (91.3690)	Acc@10 100.0000 (97.9911)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 167 running time:  0:01:06.721670
===> Building meters
DataParallel
4
Epoch: [168][577/32]	Time  7.459 ( 7.459)	Data  6.816 ( 6.816)	Loss 4.8459e+00 (4.8459e+00)	Clip_Loss 4.8459e+00 (4.8459e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 73.7649 (73.7649)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [168][597/32]	Time  0.628 ( 1.241)	Data  0.009 ( 0.630)	Loss 5.7801e+00 (5.4935e+00)	Clip_Loss 5.7801e+00 (5.4935e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 64.5957 (70.0857)	Acc@5 87.5000 (91.1458)	Acc@10 100.0000 (98.0655)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 168 running time:  0:01:09.611371
===> Building meters
DataParallel
4
Epoch: [169][609/32]	Time  6.863 ( 6.863)	Data  6.259 ( 6.259)	Loss 5.5608e+00 (5.5608e+00)	Clip_Loss 5.5608e+00 (5.5608e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 68.7503 (68.7503)	Acc@5 87.5000 (87.5000)	Acc@10 96.8750 (96.8750)
Epoch: [169][629/32]	Time  0.617 ( 1.151)	Data  0.007 ( 0.540)	Loss 5.3066e+00 (5.6704e+00)	Clip_Loss 5.3066e+00 (5.6704e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 71.9921 (68.7092)	Acc@5 87.5000 (90.0298)	Acc@10 98.4375 (97.3958)
Epoch 169 running time:  0:00:35.168721
===> Building meters
DataParallel
4
Epoch: [170][641/32]	Time  6.778 ( 6.778)	Data  6.185 ( 6.185)	Loss 5.3294e+00 (5.3294e+00)	Clip_Loss 5.3294e+00 (5.3294e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 71.0280 (71.0280)	Acc@5 90.6250 (90.6250)	Acc@10 100.0000 (100.0000)
Epoch: [170][661/32]	Time  0.649 ( 1.130)	Data  0.007 ( 0.516)	Loss 5.4907e+00 (5.5651e+00)	Clip_Loss 5.4907e+00 (5.5651e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 73.0780 (69.7950)	Acc@5 89.0625 (90.9226)	Acc@10 96.8750 (97.6935)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 170 running time:  0:01:07.568128
===> Building meters
DataParallel
4
Epoch: [171][673/32]	Time  6.951 ( 6.951)	Data  6.320 ( 6.320)	Loss 4.9501e+00 (4.9501e+00)	Clip_Loss 4.9501e+00 (4.9501e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.1519 (75.1519)	Acc@5 93.7500 (93.7500)	Acc@10 100.0000 (100.0000)
Epoch: [171][693/32]	Time  0.627 ( 1.245)	Data  0.008 ( 0.642)	Loss 5.3525e+00 (5.3563e+00)	Clip_Loss 5.3525e+00 (5.3563e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 65.9958 (69.5813)	Acc@5 90.6250 (92.3363)	Acc@10 98.4375 (97.7679)
Epoch 171 running time:  0:00:37.614836
===> Building meters
DataParallel
4
Epoch: [172][705/32]	Time  5.906 ( 5.906)	Data  5.257 ( 5.257)	Loss 6.2095e+00 (6.2095e+00)	Clip_Loss 6.2095e+00 (6.2095e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 64.9659 (64.9659)	Acc@5 85.9375 (85.9375)	Acc@10 100.0000 (100.0000)
Epoch: [172][725/32]	Time  0.620 ( 1.019)	Data  0.007 ( 0.411)	Loss 5.4303e+00 (5.4525e+00)	Clip_Loss 5.4303e+00 (5.4525e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 70.4117 (69.2603)	Acc@5 87.5000 (89.8065)	Acc@10 98.4375 (98.2143)
Epoch 172 running time:  0:00:30.606042
===> Building meters
DataParallel
4
Epoch: [173][737/32]	Time  6.711 ( 6.711)	Data  6.098 ( 6.098)	Loss 5.3778e+00 (5.3778e+00)	Clip_Loss 5.3778e+00 (5.3778e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 68.1740 (68.1740)	Acc@5 85.9375 (85.9375)	Acc@10 95.3125 (95.3125)
Epoch: [173][757/32]	Time  0.651 ( 1.181)	Data  0.008 ( 0.573)	Loss 5.7663e+00 (5.3856e+00)	Clip_Loss 5.7663e+00 (5.3856e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 65.3593 (69.6823)	Acc@5 89.0625 (90.7738)	Acc@10 98.4375 (97.0982)
Epoch 173 running time:  0:00:36.216425
===> Building meters
DataParallel
4
Epoch: [174][769/32]	Time  6.153 ( 6.153)	Data  5.503 ( 5.503)	Loss 5.6653e+00 (5.6653e+00)	Clip_Loss 5.6653e+00 (5.6653e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 67.4210 (67.4210)	Acc@5 89.0625 (89.0625)	Acc@10 98.4375 (98.4375)
Epoch: [174][789/32]	Time  0.590 ( 1.110)	Data  0.007 ( 0.502)	Loss 5.1728e+00 (5.4211e+00)	Clip_Loss 5.1728e+00 (5.4211e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 70.3232 (69.5201)	Acc@5 93.7500 (92.4107)	Acc@10 96.8750 (98.0655)
Epoch 174 running time:  0:00:33.077001
===> Building meters
DataParallel
4
Epoch: [175][801/32]	Time  6.237 ( 6.237)	Data  5.618 ( 5.618)	Loss 5.4515e+00 (5.4515e+00)	Clip_Loss 5.4515e+00 (5.4515e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 69.5387 (69.5387)	Acc@5 98.4375 (98.4375)	Acc@10 98.4375 (98.4375)
Epoch: [175][821/32]	Time  0.597 ( 1.076)	Data  0.007 ( 0.473)	Loss 5.2742e+00 (5.2163e+00)	Clip_Loss 5.2742e+00 (5.2163e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 70.0167 (71.0412)	Acc@5 89.0625 (92.7827)	Acc@10 100.0000 (98.7351)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 175 running time:  0:01:02.586221
===> Building meters
DataParallel
4
Epoch: [176][833/32]	Time  7.723 ( 7.723)	Data  7.128 ( 7.128)	Loss 5.3726e+00 (5.3726e+00)	Clip_Loss 5.3726e+00 (5.3726e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 69.6390 (69.6390)	Acc@5 92.1875 (92.1875)	Acc@10 96.8750 (96.8750)
Epoch: [176][853/32]	Time  0.615 ( 1.279)	Data  0.007 ( 0.669)	Loss 5.2726e+00 (5.4700e+00)	Clip_Loss 5.2726e+00 (5.4700e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 72.5983 (69.9085)	Acc@5 93.7500 (91.5923)	Acc@10 95.3125 (97.7679)
Epoch 176 running time:  0:00:38.133111
===> Building meters
DataParallel
4
Epoch: [177][865/32]	Time  6.708 ( 6.708)	Data  6.092 ( 6.092)	Loss 5.5817e+00 (5.5817e+00)	Clip_Loss 5.5817e+00 (5.5817e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 65.8712 (65.8712)	Acc@5 89.0625 (89.0625)	Acc@10 95.3125 (95.3125)
Epoch: [177][885/32]	Time  0.616 ( 1.086)	Data  0.007 ( 0.474)	Loss 5.3271e+00 (5.4027e+00)	Clip_Loss 5.3271e+00 (5.4027e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 64.4438 (69.1860)	Acc@5 93.7500 (92.1131)	Acc@10 96.8750 (98.0655)
Epoch 177 running time:  0:00:32.605100
===> Building meters
DataParallel
4
Epoch: [178][897/32]	Time  6.846 ( 6.846)	Data  6.236 ( 6.236)	Loss 4.7870e+00 (4.7870e+00)	Clip_Loss 4.7870e+00 (4.7870e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 74.9392 (74.9392)	Acc@5 92.1875 (92.1875)	Acc@10 100.0000 (100.0000)
Epoch: [178][917/32]	Time  0.616 ( 1.136)	Data  0.007 ( 0.526)	Loss 4.8532e+00 (5.2305e+00)	Clip_Loss 4.8532e+00 (5.2305e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 70.5884 (71.2117)	Acc@5 90.6250 (92.7827)	Acc@10 96.8750 (98.3631)
Epoch 178 running time:  0:00:33.749245
====> Test::::/datasets/aicitychallenge2023/val.json
====> Query /datasets/aicitychallenge2023/val.json load
Test Epoch: [179][162/163]	Time 112.828 (112.828)	Data  0.000 ( 0.000)	Clip Loss 4.1874e+00 (4.1874e+00)	MRR 43.8069 (43.8069)	Acc@1 26.0000 (26.0000)	Acc@5 69.0000 (69.0000)
Epoch 179 running time:  0:01:52.833221
Logs dir: logs/dual_baseline_aug1 
====> results in csv format: 
| Method             | Dataset                                | Epoch   | Loss   | MRR    | Acc-5   | Acc-10   |
|:-------------------|:---------------------------------------|:--------|:-------|:-------|:--------|:---------|
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 19      | 4.418  | 18.029 | 6.000   | 29.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 39      | 4.318  | 25.640 | 12.000  | 39.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 59      | 4.308  | 26.601 | 10.000  | 45.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 79      | 4.256  | 32.901 | 16.000  | 53.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 99      | 4.248  | 35.485 | 19.000  | 54.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 119     | 4.278  | 36.260 | 19.000  | 60.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 139     | 4.258  | 34.736 | 18.000  | 56.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 159     | 4.232  | 35.243 | 21.000  | 51.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 179     | 4.187  | 43.807 | 26.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | Max_179 | 4.187  | 43.807 | 26.000  | 69.000   |
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best_eval.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best_eval.pth
===> Building meters
DataParallel
4
Epoch: [179][929/32]	Time  7.160 ( 7.160)	Data  6.521 ( 6.521)	Loss 5.6297e+00 (5.6297e+00)	Clip_Loss 5.6297e+00 (5.6297e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 69.6959 (69.6959)	Acc@5 90.6250 (90.6250)	Acc@10 96.8750 (96.8750)
Epoch: [179][949/32]	Time  0.650 ( 1.297)	Data  0.007 ( 0.686)	Loss 6.2618e+00 (5.3536e+00)	Clip_Loss 6.2618e+00 (5.3536e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 61.7361 (70.6677)	Acc@5 85.9375 (91.5923)	Acc@10 95.3125 (97.6190)
Epoch 179 running time:  0:00:39.000064
===> Building meters
DataParallel
4
Epoch: [180][ 1/32]	Time  6.322 ( 6.322)	Data  5.682 ( 5.682)	Loss 5.6822e+00 (5.6822e+00)	Clip_Loss 5.6822e+00 (5.6822e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 68.5107 (68.5107)	Acc@5 92.1875 (92.1875)	Acc@10 95.3125 (95.3125)
Epoch: [180][21/32]	Time  0.622 ( 1.018)	Data  0.007 ( 0.411)	Loss 5.4898e+00 (5.4026e+00)	Clip_Loss 5.4898e+00 (5.4026e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 68.1982 (69.9452)	Acc@5 90.6250 (91.5179)	Acc@10 100.0000 (97.5446)
Epoch 180 running time:  0:00:30.827308
===> Building meters
DataParallel
4
Epoch: [181][33/32]	Time  6.155 ( 6.155)	Data  5.474 ( 5.474)	Loss 5.4406e+00 (5.4406e+00)	Clip_Loss 5.4406e+00 (5.4406e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 68.8605 (68.8605)	Acc@5 87.5000 (87.5000)	Acc@10 96.8750 (96.8750)
Epoch: [181][53/32]	Time  0.589 ( 1.184)	Data  0.007 ( 0.574)	Loss 4.7740e+00 (5.3424e+00)	Clip_Loss 4.7740e+00 (5.3424e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 74.9077 (71.7420)	Acc@5 93.7500 (90.9226)	Acc@10 98.4375 (97.6935)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 181 running time:  0:01:04.975747
===> Building meters
DataParallel
4
Epoch: [182][65/32]	Time  6.875 ( 6.875)	Data  6.249 ( 6.249)	Loss 5.5514e+00 (5.5514e+00)	Clip_Loss 5.5514e+00 (5.5514e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 68.8021 (68.8021)	Acc@5 90.6250 (90.6250)	Acc@10 95.3125 (95.3125)
Epoch: [182][85/32]	Time  0.589 ( 1.202)	Data  0.007 ( 0.594)	Loss 4.8278e+00 (5.2285e+00)	Clip_Loss 4.8278e+00 (5.2285e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 70.9394 (71.4937)	Acc@5 96.8750 (94.1220)	Acc@10 100.0000 (97.9167)
Epoch 182 running time:  0:00:36.956750
===> Building meters
DataParallel
4
Epoch: [183][97/32]	Time  5.995 ( 5.995)	Data  5.374 ( 5.374)	Loss 4.6521e+00 (4.6521e+00)	Clip_Loss 4.6521e+00 (4.6521e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 76.5396 (76.5396)	Acc@5 95.3125 (95.3125)	Acc@10 98.4375 (98.4375)
Epoch: [183][117/32]	Time  0.625 ( 1.062)	Data  0.007 ( 0.454)	Loss 5.3343e+00 (5.0359e+00)	Clip_Loss 5.3343e+00 (5.0359e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 65.8873 (72.8011)	Acc@5 93.7500 (94.1220)	Acc@10 100.0000 (98.5119)
Epoch 183 running time:  0:00:32.936865
===> Building meters
DataParallel
4
Epoch: [184][129/32]	Time  6.157 ( 6.157)	Data  5.530 ( 5.530)	Loss 4.9731e+00 (4.9731e+00)	Clip_Loss 4.9731e+00 (4.9731e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 79.7768 (79.7768)	Acc@5 90.6250 (90.6250)	Acc@10 98.4375 (98.4375)
Epoch: [184][149/32]	Time  0.626 ( 1.140)	Data  0.007 ( 0.535)	Loss 4.6047e+00 (5.1772e+00)	Clip_Loss 4.6047e+00 (5.1772e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.8612 (71.9122)	Acc@5 96.8750 (92.4107)	Acc@10 100.0000 (98.1399)
Epoch 184 running time:  0:00:34.797194
===> Building meters
DataParallel
4
Epoch: [185][161/32]	Time  6.429 ( 6.429)	Data  5.801 ( 5.801)	Loss 5.4223e+00 (5.4223e+00)	Clip_Loss 5.4223e+00 (5.4223e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 69.2426 (69.2426)	Acc@5 92.1875 (92.1875)	Acc@10 96.8750 (96.8750)
Epoch: [185][181/32]	Time  0.647 ( 1.124)	Data  0.007 ( 0.511)	Loss 5.3632e+00 (5.1688e+00)	Clip_Loss 5.3632e+00 (5.1688e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.3537 (72.3492)	Acc@5 89.0625 (91.7411)	Acc@10 96.8750 (98.1399)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 185 running time:  0:01:09.055187
===> Building meters
DataParallel
4
Epoch: [186][193/32]	Time  6.682 ( 6.682)	Data  6.092 ( 6.092)	Loss 5.1018e+00 (5.1018e+00)	Clip_Loss 5.1018e+00 (5.1018e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 68.2608 (68.2608)	Acc@5 87.5000 (87.5000)	Acc@10 100.0000 (100.0000)
Epoch: [186][213/32]	Time  0.596 ( 1.238)	Data  0.008 ( 0.630)	Loss 5.5113e+00 (5.2948e+00)	Clip_Loss 5.5113e+00 (5.2948e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 74.7245 (70.7585)	Acc@5 90.6250 (92.2619)	Acc@10 93.7500 (98.5863)
Epoch 186 running time:  0:00:38.069347
===> Building meters
DataParallel
4
Epoch: [187][225/32]	Time  5.741 ( 5.741)	Data  5.094 ( 5.094)	Loss 4.9083e+00 (4.9083e+00)	Clip_Loss 4.9083e+00 (4.9083e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 76.5195 (76.5195)	Acc@5 93.7500 (93.7500)	Acc@10 96.8750 (96.8750)
Epoch: [187][245/32]	Time  0.590 ( 1.032)	Data  0.007 ( 0.430)	Loss 5.4038e+00 (5.1609e+00)	Clip_Loss 5.4038e+00 (5.1609e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 67.1372 (72.1276)	Acc@5 93.7500 (92.7083)	Acc@10 96.8750 (98.5119)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 187 running time:  0:01:01.708368
===> Building meters
DataParallel
4
Epoch: [188][257/32]	Time  7.373 ( 7.373)	Data  6.756 ( 6.756)	Loss 5.5766e+00 (5.5766e+00)	Clip_Loss 5.5766e+00 (5.5766e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 70.4427 (70.4427)	Acc@5 93.7500 (93.7500)	Acc@10 100.0000 (100.0000)
Epoch: [188][277/32]	Time  0.588 ( 1.434)	Data  0.007 ( 0.829)	Loss 5.8908e+00 (5.1974e+00)	Clip_Loss 5.8908e+00 (5.1974e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 68.9690 (71.8231)	Acc@5 90.6250 (92.3363)	Acc@10 95.3125 (97.5446)
Epoch 188 running time:  0:00:40.898859
===> Building meters
DataParallel
4
Epoch: [189][289/32]	Time  6.168 ( 6.168)	Data  5.518 ( 5.518)	Loss 5.5234e+00 (5.5234e+00)	Clip_Loss 5.5234e+00 (5.5234e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 71.1025 (71.1025)	Acc@5 89.0625 (89.0625)	Acc@10 98.4375 (98.4375)
Epoch: [189][309/32]	Time  0.618 ( 1.041)	Data  0.007 ( 0.425)	Loss 5.3303e+00 (5.1678e+00)	Clip_Loss 5.3303e+00 (5.1678e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 70.8114 (71.6986)	Acc@5 98.4375 (93.2292)	Acc@10 98.4375 (98.7351)
Epoch 189 running time:  0:00:31.251999
===> Building meters
DataParallel
4
Epoch: [190][321/32]	Time  6.259 ( 6.259)	Data  5.634 ( 5.634)	Loss 4.9816e+00 (4.9816e+00)	Clip_Loss 4.9816e+00 (4.9816e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 73.9844 (73.9844)	Acc@5 95.3125 (95.3125)	Acc@10 98.4375 (98.4375)
Epoch: [190][341/32]	Time  0.659 ( 1.268)	Data  0.011 ( 0.648)	Loss 5.3232e+00 (5.1954e+00)	Clip_Loss 5.3232e+00 (5.1954e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 66.3300 (72.3290)	Acc@5 92.1875 (92.2619)	Acc@10 100.0000 (98.5119)
Epoch 190 running time:  0:00:38.136746
===> Building meters
DataParallel
4
Epoch: [191][353/32]	Time  6.370 ( 6.370)	Data  5.779 ( 5.779)	Loss 5.3331e+00 (5.3331e+00)	Clip_Loss 5.3331e+00 (5.3331e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 71.0827 (71.0827)	Acc@5 89.0625 (89.0625)	Acc@10 98.4375 (98.4375)
Epoch: [191][373/32]	Time  0.600 ( 1.134)	Data  0.007 ( 0.529)	Loss 4.6103e+00 (5.2665e+00)	Clip_Loss 4.6103e+00 (5.2665e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 73.6849 (71.4132)	Acc@5 96.8750 (93.6012)	Acc@10 100.0000 (98.1399)
Epoch 191 running time:  0:00:34.028170
===> Building meters
DataParallel
4
Epoch: [192][385/32]	Time  5.989 ( 5.989)	Data  5.365 ( 5.365)	Loss 4.7366e+00 (4.7366e+00)	Clip_Loss 4.7366e+00 (4.7366e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 77.4740 (77.4740)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [192][405/32]	Time  0.616 ( 1.134)	Data  0.008 ( 0.525)	Loss 4.6545e+00 (5.1155e+00)	Clip_Loss 4.6545e+00 (5.1155e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.8715 (72.9307)	Acc@5 98.4375 (94.3452)	Acc@10 100.0000 (98.5863)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 192 running time:  0:01:03.123507
===> Building meters
DataParallel
4
Epoch: [193][417/32]	Time  7.123 ( 7.123)	Data  6.500 ( 6.500)	Loss 5.3319e+00 (5.3319e+00)	Clip_Loss 5.3319e+00 (5.3319e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 70.3553 (70.3553)	Acc@5 95.3125 (95.3125)	Acc@10 100.0000 (100.0000)
Epoch: [193][437/32]	Time  0.629 ( 1.226)	Data  0.008 ( 0.623)	Loss 4.7258e+00 (5.0765e+00)	Clip_Loss 4.7258e+00 (5.0765e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 76.3542 (73.2505)	Acc@5 98.4375 (93.2292)	Acc@10 100.0000 (98.4375)
Epoch 193 running time:  0:00:37.645519
===> Building meters
DataParallel
4
Epoch: [194][449/32]	Time  6.540 ( 6.540)	Data  5.922 ( 5.922)	Loss 5.3251e+00 (5.3251e+00)	Clip_Loss 5.3251e+00 (5.3251e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 72.7164 (72.7164)	Acc@5 87.5000 (87.5000)	Acc@10 95.3125 (95.3125)
Epoch: [194][469/32]	Time  0.620 ( 1.065)	Data  0.007 ( 0.455)	Loss 4.8013e+00 (5.1735e+00)	Clip_Loss 4.8013e+00 (5.1735e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.6814 (72.3484)	Acc@5 95.3125 (93.4524)	Acc@10 100.0000 (98.6607)
Epoch 194 running time:  0:00:32.216590
===> Building meters
DataParallel
4
Epoch: [195][481/32]	Time  6.226 ( 6.226)	Data  5.552 ( 5.552)	Loss 5.6447e+00 (5.6447e+00)	Clip_Loss 5.6447e+00 (5.6447e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 67.5279 (67.5279)	Acc@5 84.3750 (84.3750)	Acc@10 100.0000 (100.0000)
Epoch: [195][501/32]	Time  0.591 ( 1.121)	Data  0.007 ( 0.513)	Loss 5.4039e+00 (5.1735e+00)	Clip_Loss 5.4039e+00 (5.1735e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 68.6781 (72.0321)	Acc@5 92.1875 (92.8571)	Acc@10 98.4375 (98.2143)
Epoch 195 running time:  0:00:34.317569
===> Building meters
DataParallel
4
Epoch: [196][513/32]	Time  6.334 ( 6.334)	Data  5.690 ( 5.690)	Loss 4.8407e+00 (4.8407e+00)	Clip_Loss 4.8407e+00 (4.8407e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 71.5365 (71.5365)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [196][533/32]	Time  0.622 ( 1.135)	Data  0.007 ( 0.524)	Loss 4.4078e+00 (5.0019e+00)	Clip_Loss 4.4078e+00 (5.0019e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 76.3492 (72.7001)	Acc@5 95.3125 (94.4196)	Acc@10 100.0000 (99.0327)
Epoch 196 running time:  0:00:34.450813
===> Building meters
DataParallel
4
Epoch: [197][545/32]	Time  6.093 ( 6.093)	Data  5.476 ( 5.476)	Loss 4.7364e+00 (4.7364e+00)	Clip_Loss 4.7364e+00 (4.7364e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.5208 (75.5208)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [197][565/32]	Time  0.615 ( 1.108)	Data  0.007 ( 0.502)	Loss 4.8259e+00 (5.0350e+00)	Clip_Loss 4.8259e+00 (5.0350e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 76.4655 (72.5129)	Acc@5 95.3125 (93.8244)	Acc@10 98.4375 (98.5119)
Epoch 197 running time:  0:00:33.576711
===> Building meters
DataParallel
4
Epoch: [198][577/32]	Time  5.912 ( 5.912)	Data  5.272 ( 5.272)	Loss 4.6713e+00 (4.6713e+00)	Clip_Loss 4.6713e+00 (4.6713e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 77.4665 (77.4665)	Acc@5 95.3125 (95.3125)	Acc@10 100.0000 (100.0000)
Epoch: [198][597/32]	Time  0.625 ( 1.110)	Data  0.008 ( 0.496)	Loss 5.4509e+00 (5.1384e+00)	Clip_Loss 5.4509e+00 (5.1384e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 72.2725 (73.1512)	Acc@5 85.9375 (92.7827)	Acc@10 95.3125 (98.3631)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 198 running time:  0:01:02.354106
====> Test::::/datasets/aicitychallenge2023/val.json
====> Query /datasets/aicitychallenge2023/val.json load
Test Epoch: [199][162/163]	Time 110.757 (110.757)	Data  0.000 ( 0.000)	Clip Loss 4.1837e+00 (4.1837e+00)	MRR 45.5845 (45.5845)	Acc@1 27.0000 (27.0000)	Acc@5 71.0000 (71.0000)
Epoch 199 running time:  0:01:50.762473
Logs dir: logs/dual_baseline_aug1 
====> results in csv format: 
| Method             | Dataset                                | Epoch   | Loss   | MRR    | Acc-5   | Acc-10   |
|:-------------------|:---------------------------------------|:--------|:-------|:-------|:--------|:---------|
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 19      | 4.418  | 18.029 | 6.000   | 29.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 39      | 4.318  | 25.640 | 12.000  | 39.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 59      | 4.308  | 26.601 | 10.000  | 45.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 79      | 4.256  | 32.901 | 16.000  | 53.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 99      | 4.248  | 35.485 | 19.000  | 54.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 119     | 4.278  | 36.260 | 19.000  | 60.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 139     | 4.258  | 34.736 | 18.000  | 56.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 159     | 4.232  | 35.243 | 21.000  | 51.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 179     | 4.187  | 43.807 | 26.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 199     | 4.184  | 45.585 | 27.000  | 71.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | Max_199 | 4.184  | 45.585 | 27.000  | 71.000   |
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best_eval.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best_eval.pth
===> Building meters
DataParallel
4
Epoch: [199][609/32]	Time  7.078 ( 7.078)	Data  6.440 ( 6.440)	Loss 4.6256e+00 (4.6256e+00)	Clip_Loss 4.6256e+00 (4.6256e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.5859 (75.5859)	Acc@5 95.3125 (95.3125)	Acc@10 100.0000 (100.0000)
Epoch: [199][629/32]	Time  0.612 ( 1.224)	Data  0.008 ( 0.622)	Loss 5.6393e+00 (4.9946e+00)	Clip_Loss 5.6393e+00 (4.9946e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 66.0391 (73.1248)	Acc@5 93.7500 (94.3452)	Acc@10 96.8750 (98.5863)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 199 running time:  0:01:01.142573
===> Building meters
DataParallel
4
Epoch: [200][641/32]	Time  6.147 ( 6.147)	Data  5.527 ( 5.527)	Loss 5.9479e+00 (5.9479e+00)	Clip_Loss 5.9479e+00 (5.9479e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 63.9847 (63.9847)	Acc@5 84.3750 (84.3750)	Acc@10 95.3125 (95.3125)
Epoch: [200][661/32]	Time  0.613 ( 1.092)	Data  0.007 ( 0.492)	Loss 4.8906e+00 (5.1198e+00)	Clip_Loss 4.8906e+00 (5.1198e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 77.8516 (72.8750)	Acc@5 92.1875 (92.7827)	Acc@10 100.0000 (98.1399)
Epoch 200 running time:  0:00:33.590370
===> Building meters
DataParallel
4
Epoch: [201][673/32]	Time  6.398 ( 6.398)	Data  5.783 ( 5.783)	Loss 4.9854e+00 (4.9854e+00)	Clip_Loss 4.9854e+00 (4.9854e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 71.9940 (71.9940)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [201][693/32]	Time  0.612 ( 1.129)	Data  0.007 ( 0.519)	Loss 4.7021e+00 (5.0732e+00)	Clip_Loss 4.7021e+00 (5.0732e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.9722 (72.6011)	Acc@5 95.3125 (92.8571)	Acc@10 98.4375 (97.8423)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_201.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_201.pth
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 201 running time:  0:01:39.763924
===> Building meters
DataParallel
4
Epoch: [202][705/32]	Time  6.901 ( 6.901)	Data  6.254 ( 6.254)	Loss 4.5967e+00 (4.5967e+00)	Clip_Loss 4.5967e+00 (4.5967e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 74.3888 (74.3888)	Acc@5 92.1875 (92.1875)	Acc@10 98.4375 (98.4375)
Epoch: [202][725/32]	Time  0.649 ( 1.268)	Data  0.007 ( 0.658)	Loss 4.7946e+00 (4.9027e+00)	Clip_Loss 4.7946e+00 (4.9027e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 74.3508 (74.6594)	Acc@5 92.1875 (94.1220)	Acc@10 100.0000 (98.4375)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 202 running time:  0:01:09.614832
===> Building meters
DataParallel
4
Epoch: [203][737/32]	Time  7.083 ( 7.083)	Data  6.440 ( 6.440)	Loss 4.3682e+00 (4.3682e+00)	Clip_Loss 4.3682e+00 (4.3682e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.5197 (78.5197)	Acc@5 96.8750 (96.8750)	Acc@10 98.4375 (98.4375)
Epoch: [203][757/32]	Time  0.618 ( 1.235)	Data  0.007 ( 0.626)	Loss 5.0246e+00 (5.1103e+00)	Clip_Loss 5.0246e+00 (5.1103e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 74.0365 (73.1349)	Acc@5 100.0000 (93.6012)	Acc@10 100.0000 (98.7351)
Epoch 203 running time:  0:00:37.109663
===> Building meters
DataParallel
4
Epoch: [204][769/32]	Time  6.030 ( 6.030)	Data  5.413 ( 5.413)	Loss 4.0664e+00 (4.0664e+00)	Clip_Loss 4.0664e+00 (4.0664e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 77.5409 (77.5409)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [204][789/32]	Time  0.610 ( 1.048)	Data  0.007 ( 0.437)	Loss 5.0885e+00 (5.0638e+00)	Clip_Loss 5.0885e+00 (5.0638e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 71.5525 (74.0610)	Acc@5 93.7500 (94.2708)	Acc@10 96.8750 (98.6607)
Epoch 204 running time:  0:00:31.130555
===> Building meters
DataParallel
4
Epoch: [205][801/32]	Time  5.632 ( 5.632)	Data  4.985 ( 4.985)	Loss 4.6894e+00 (4.6894e+00)	Clip_Loss 4.6894e+00 (4.6894e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 73.4270 (73.4270)	Acc@5 90.6250 (90.6250)	Acc@10 98.4375 (98.4375)
Epoch: [205][821/32]	Time  0.676 ( 1.073)	Data  0.007 ( 0.461)	Loss 5.2993e+00 (5.0346e+00)	Clip_Loss 5.2993e+00 (5.0346e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 68.7596 (73.5098)	Acc@5 95.3125 (93.6756)	Acc@10 95.3125 (98.8839)
Epoch 205 running time:  0:00:33.600872
===> Building meters
DataParallel
4
Epoch: [206][833/32]	Time  6.391 ( 6.391)	Data  5.763 ( 5.763)	Loss 5.2497e+00 (5.2497e+00)	Clip_Loss 5.2497e+00 (5.2497e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 68.6930 (68.6930)	Acc@5 90.6250 (90.6250)	Acc@10 95.3125 (95.3125)
Epoch: [206][853/32]	Time  0.612 ( 1.141)	Data  0.007 ( 0.533)	Loss 4.2713e+00 (4.8354e+00)	Clip_Loss 4.2713e+00 (4.8354e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.0200 (74.1022)	Acc@5 95.3125 (94.4196)	Acc@10 98.4375 (98.5863)
Epoch 206 running time:  0:00:34.383829
===> Building meters
DataParallel
4
Epoch: [207][865/32]	Time  6.170 ( 6.170)	Data  5.547 ( 5.547)	Loss 4.8827e+00 (4.8827e+00)	Clip_Loss 4.8827e+00 (4.8827e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 70.5531 (70.5531)	Acc@5 93.7500 (93.7500)	Acc@10 96.8750 (96.8750)
Epoch: [207][885/32]	Time  0.651 ( 1.064)	Data  0.008 ( 0.450)	Loss 4.7090e+00 (4.8491e+00)	Clip_Loss 4.7090e+00 (4.8491e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 74.1183 (74.0629)	Acc@5 96.8750 (95.3125)	Acc@10 100.0000 (98.9583)
Epoch 207 running time:  0:00:32.373865
===> Building meters
DataParallel
4
Epoch: [208][897/32]	Time  6.093 ( 6.093)	Data  5.480 ( 5.480)	Loss 4.2082e+00 (4.2082e+00)	Clip_Loss 4.2082e+00 (4.2082e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 79.0111 (79.0111)	Acc@5 96.8750 (96.8750)	Acc@10 98.4375 (98.4375)
Epoch: [208][917/32]	Time  0.631 ( 1.272)	Data  0.008 ( 0.661)	Loss 5.0746e+00 (4.9900e+00)	Clip_Loss 5.0746e+00 (4.9900e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 71.0001 (73.6089)	Acc@5 93.7500 (93.6012)	Acc@10 100.0000 (98.7351)
Epoch 208 running time:  0:00:37.155777
===> Building meters
DataParallel
4
Epoch: [209][929/32]	Time  5.822 ( 5.822)	Data  5.206 ( 5.206)	Loss 4.7613e+00 (4.7613e+00)	Clip_Loss 4.7613e+00 (4.7613e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.6319 (81.6319)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [209][949/32]	Time  0.592 ( 1.086)	Data  0.007 ( 0.471)	Loss 5.6423e+00 (5.1196e+00)	Clip_Loss 5.6423e+00 (5.1196e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 73.2267 (73.6236)	Acc@5 90.6250 (93.6012)	Acc@10 95.3125 (98.4375)
Epoch 209 running time:  0:00:33.643210
===> Building meters
DataParallel
4
Epoch: [210][ 1/32]	Time  6.331 ( 6.331)	Data  5.679 ( 5.679)	Loss 5.1703e+00 (5.1703e+00)	Clip_Loss 5.1703e+00 (5.1703e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 77.1094 (77.1094)	Acc@5 95.3125 (95.3125)	Acc@10 98.4375 (98.4375)
Epoch: [210][21/32]	Time  0.613 ( 1.122)	Data  0.007 ( 0.513)	Loss 4.6003e+00 (4.9237e+00)	Clip_Loss 4.6003e+00 (4.9237e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 76.5159 (74.8942)	Acc@5 90.6250 (94.3452)	Acc@10 98.4375 (99.2560)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 210 running time:  0:01:00.301422
===> Building meters
DataParallel
4
Epoch: [211][33/32]	Time  6.887 ( 6.887)	Data  6.273 ( 6.273)	Loss 4.8661e+00 (4.8661e+00)	Clip_Loss 4.8661e+00 (4.8661e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 71.9271 (71.9271)	Acc@5 95.3125 (95.3125)	Acc@10 100.0000 (100.0000)
Epoch: [211][53/32]	Time  0.614 ( 1.208)	Data  0.007 ( 0.608)	Loss 5.6407e+00 (4.9514e+00)	Clip_Loss 5.6407e+00 (4.9514e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 67.6155 (73.8587)	Acc@5 89.0625 (93.8244)	Acc@10 93.7500 (98.9583)
Epoch 211 running time:  0:00:36.456605
===> Building meters
DataParallel
4
Epoch: [212][65/32]	Time  6.230 ( 6.230)	Data  5.607 ( 5.607)	Loss 4.9743e+00 (4.9743e+00)	Clip_Loss 4.9743e+00 (4.9743e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 69.3620 (69.3620)	Acc@5 93.7500 (93.7500)	Acc@10 100.0000 (100.0000)
Epoch: [212][85/32]	Time  0.628 ( 1.054)	Data  0.008 ( 0.441)	Loss 4.9958e+00 (4.9180e+00)	Clip_Loss 4.9958e+00 (4.9180e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 73.1629 (73.6069)	Acc@5 95.3125 (94.0476)	Acc@10 98.4375 (98.8839)
Epoch 212 running time:  0:00:32.286919
===> Building meters
DataParallel
4
Epoch: [213][97/32]	Time  6.191 ( 6.191)	Data  5.562 ( 5.562)	Loss 5.4264e+00 (5.4264e+00)	Clip_Loss 5.4264e+00 (5.4264e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 68.2999 (68.2999)	Acc@5 95.3125 (95.3125)	Acc@10 100.0000 (100.0000)
Epoch: [213][117/32]	Time  0.589 ( 1.130)	Data  0.007 ( 0.524)	Loss 4.7288e+00 (4.9304e+00)	Clip_Loss 4.7288e+00 (4.9304e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 79.3359 (73.5709)	Acc@5 98.4375 (95.3869)	Acc@10 100.0000 (99.0327)
Epoch 213 running time:  0:00:34.143062
===> Building meters
DataParallel
4
Epoch: [214][129/32]	Time  6.339 ( 6.339)	Data  5.684 ( 5.684)	Loss 5.5490e+00 (5.5490e+00)	Clip_Loss 5.5490e+00 (5.5490e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 72.9098 (72.9098)	Acc@5 92.1875 (92.1875)	Acc@10 100.0000 (100.0000)
Epoch: [214][149/32]	Time  0.616 ( 1.067)	Data  0.007 ( 0.462)	Loss 4.6148e+00 (4.7303e+00)	Clip_Loss 4.6148e+00 (4.7303e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.3578 (74.9026)	Acc@5 92.1875 (95.1637)	Acc@10 98.4375 (99.4048)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 214 running time:  0:00:58.416754
===> Building meters
DataParallel
4
Epoch: [215][161/32]	Time  6.376 ( 6.376)	Data  5.736 ( 5.736)	Loss 5.1314e+00 (5.1314e+00)	Clip_Loss 5.1314e+00 (5.1314e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 74.0179 (74.0179)	Acc@5 92.1875 (92.1875)	Acc@10 98.4375 (98.4375)
Epoch: [215][181/32]	Time  0.611 ( 1.150)	Data  0.008 ( 0.541)	Loss 5.1491e+00 (4.8949e+00)	Clip_Loss 5.1491e+00 (4.8949e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 76.6164 (75.0115)	Acc@5 95.3125 (94.9405)	Acc@10 100.0000 (98.8095)
Epoch 215 running time:  0:00:35.764123
===> Building meters
DataParallel
4
Epoch: [216][193/32]	Time  6.260 ( 6.260)	Data  5.620 ( 5.620)	Loss 5.2717e+00 (5.2717e+00)	Clip_Loss 5.2717e+00 (5.2717e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 66.4013 (66.4013)	Acc@5 93.7500 (93.7500)	Acc@10 100.0000 (100.0000)
Epoch: [216][213/32]	Time  0.594 ( 1.064)	Data  0.007 ( 0.458)	Loss 5.7161e+00 (4.9036e+00)	Clip_Loss 5.7161e+00 (4.9036e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 66.9884 (74.7532)	Acc@5 90.6250 (95.0893)	Acc@10 93.7500 (98.8839)
Epoch 216 running time:  0:00:31.595738
===> Building meters
DataParallel
4
Epoch: [217][225/32]	Time  5.901 ( 5.901)	Data  5.279 ( 5.279)	Loss 4.3086e+00 (4.3086e+00)	Clip_Loss 4.3086e+00 (4.3086e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 79.7266 (79.7266)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [217][245/32]	Time  0.617 ( 1.099)	Data  0.007 ( 0.494)	Loss 4.1001e+00 (4.8706e+00)	Clip_Loss 4.1001e+00 (4.8706e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.6276 (74.1734)	Acc@5 98.4375 (95.2381)	Acc@10 100.0000 (98.9583)
Epoch 217 running time:  0:00:33.662713
===> Building meters
DataParallel
4
Epoch: [218][257/32]	Time  6.087 ( 6.087)	Data  5.441 ( 5.441)	Loss 4.5114e+00 (4.5114e+00)	Clip_Loss 4.5114e+00 (4.5114e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.0260 (75.0260)	Acc@5 95.3125 (95.3125)	Acc@10 98.4375 (98.4375)
Epoch: [218][277/32]	Time  0.592 ( 1.113)	Data  0.007 ( 0.508)	Loss 4.7017e+00 (4.8657e+00)	Clip_Loss 4.7017e+00 (4.8657e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 72.2792 (73.8488)	Acc@5 89.0625 (95.7589)	Acc@10 98.4375 (99.5536)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 218 running time:  0:01:06.024035
====> Test::::/datasets/aicitychallenge2023/val.json
====> Query /datasets/aicitychallenge2023/val.json load
Test Epoch: [219][162/163]	Time 112.410 (112.410)	Data  0.000 ( 0.000)	Clip Loss 4.1826e+00 (4.1826e+00)	MRR 41.7799 (41.7799)	Acc@1 22.0000 (22.0000)	Acc@5 67.0000 (67.0000)
Epoch 219 running time:  0:01:52.415881
Logs dir: logs/dual_baseline_aug1 
====> results in csv format: 
| Method             | Dataset                                | Epoch   | Loss   | MRR    | Acc-5   | Acc-10   |
|:-------------------|:---------------------------------------|:--------|:-------|:-------|:--------|:---------|
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 19      | 4.418  | 18.029 | 6.000   | 29.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 39      | 4.318  | 25.640 | 12.000  | 39.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 59      | 4.308  | 26.601 | 10.000  | 45.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 79      | 4.256  | 32.901 | 16.000  | 53.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 99      | 4.248  | 35.485 | 19.000  | 54.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 119     | 4.278  | 36.260 | 19.000  | 60.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 139     | 4.258  | 34.736 | 18.000  | 56.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 159     | 4.232  | 35.243 | 21.000  | 51.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 179     | 4.187  | 43.807 | 26.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 199     | 4.184  | 45.585 | 27.000  | 71.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 219     | 4.183  | 41.780 | 22.000  | 67.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | Max_199 | 4.184  | 45.585 | 27.000  | 71.000   |
===> Building meters
DataParallel
4
Epoch: [219][289/32]	Time  7.011 ( 7.011)	Data  6.404 ( 6.404)	Loss 4.6685e+00 (4.6685e+00)	Clip_Loss 4.6685e+00 (4.6685e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 79.2132 (79.2132)	Acc@5 96.8750 (96.8750)	Acc@10 98.4375 (98.4375)
Epoch: [219][309/32]	Time  0.594 ( 1.215)	Data  0.007 ( 0.613)	Loss 4.2980e+00 (4.7880e+00)	Clip_Loss 4.2980e+00 (4.7880e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.1008 (75.3688)	Acc@5 95.3125 (95.2381)	Acc@10 100.0000 (99.1815)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 219 running time:  0:01:05.077849
===> Building meters
DataParallel
4
Epoch: [220][321/32]	Time  6.304 ( 6.304)	Data  5.667 ( 5.667)	Loss 4.1801e+00 (4.1801e+00)	Clip_Loss 4.1801e+00 (4.1801e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.8411 (78.8411)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [220][341/32]	Time  0.598 ( 1.169)	Data  0.007 ( 0.562)	Loss 5.1222e+00 (4.7687e+00)	Clip_Loss 5.1222e+00 (4.7687e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 76.5923 (75.0162)	Acc@5 92.1875 (93.7500)	Acc@10 100.0000 (98.8839)
Epoch 220 running time:  0:00:35.640117
===> Building meters
DataParallel
4
Epoch: [221][353/32]	Time  6.132 ( 6.132)	Data  5.509 ( 5.509)	Loss 4.3796e+00 (4.3796e+00)	Clip_Loss 4.3796e+00 (4.3796e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.2552 (78.2552)	Acc@5 98.4375 (98.4375)	Acc@10 98.4375 (98.4375)
Epoch: [221][373/32]	Time  0.589 ( 1.077)	Data  0.007 ( 0.468)	Loss 6.1717e+00 (4.8825e+00)	Clip_Loss 6.1717e+00 (4.8825e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 66.1705 (74.1404)	Acc@5 87.5000 (94.1964)	Acc@10 95.3125 (98.7351)
Epoch 221 running time:  0:00:32.385335
===> Building meters
DataParallel
4
Epoch: [222][385/32]	Time  5.861 ( 5.861)	Data  5.221 ( 5.221)	Loss 5.0380e+00 (5.0380e+00)	Clip_Loss 5.0380e+00 (5.0380e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 72.8460 (72.8460)	Acc@5 95.3125 (95.3125)	Acc@10 96.8750 (96.8750)
Epoch: [222][405/32]	Time  0.613 ( 1.043)	Data  0.007 ( 0.437)	Loss 5.2595e+00 (4.8167e+00)	Clip_Loss 5.2595e+00 (4.8167e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 71.1694 (75.1995)	Acc@5 95.3125 (95.6845)	Acc@10 100.0000 (99.1071)
Epoch 222 running time:  0:00:32.639561
===> Building meters
DataParallel
4
Epoch: [223][417/32]	Time  6.672 ( 6.672)	Data  6.021 ( 6.021)	Loss 4.8326e+00 (4.8326e+00)	Clip_Loss 4.8326e+00 (4.8326e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 79.2586 (79.2586)	Acc@5 96.8750 (96.8750)	Acc@10 98.4375 (98.4375)
Epoch: [223][437/32]	Time  0.613 ( 1.102)	Data  0.007 ( 0.492)	Loss 5.0917e+00 (4.9457e+00)	Clip_Loss 5.0917e+00 (4.9457e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 71.8465 (75.7523)	Acc@5 92.1875 (94.9405)	Acc@10 98.4375 (98.8839)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 223 running time:  0:01:08.524154
===> Building meters
DataParallel
4
Epoch: [224][449/32]	Time  6.349 ( 6.349)	Data  5.742 ( 5.742)	Loss 5.1178e+00 (5.1178e+00)	Clip_Loss 5.1178e+00 (5.1178e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 74.5740 (74.5740)	Acc@5 92.1875 (92.1875)	Acc@10 100.0000 (100.0000)
Epoch: [224][469/32]	Time  0.593 ( 1.187)	Data  0.007 ( 0.582)	Loss 4.7089e+00 (4.8102e+00)	Clip_Loss 4.7089e+00 (4.8102e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 77.5434 (75.4998)	Acc@5 93.7500 (95.1637)	Acc@10 98.4375 (98.8839)
Epoch 224 running time:  0:00:36.626035
===> Building meters
DataParallel
4
Epoch: [225][481/32]	Time  5.974 ( 5.974)	Data  5.351 ( 5.351)	Loss 4.8633e+00 (4.8633e+00)	Clip_Loss 4.8633e+00 (4.8633e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.3996 (78.3996)	Acc@5 90.6250 (90.6250)	Acc@10 96.8750 (96.8750)
Epoch: [225][501/32]	Time  0.614 ( 1.061)	Data  0.007 ( 0.454)	Loss 4.1575e+00 (4.7603e+00)	Clip_Loss 4.1575e+00 (4.7603e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.0097 (76.8093)	Acc@5 98.4375 (95.1637)	Acc@10 100.0000 (99.1071)
Epoch 225 running time:  0:00:32.096829
===> Building meters
DataParallel
4
Epoch: [226][513/32]	Time  5.972 ( 5.972)	Data  5.344 ( 5.344)	Loss 4.4240e+00 (4.4240e+00)	Clip_Loss 4.4240e+00 (4.4240e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 76.8378 (76.8378)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [226][533/32]	Time  0.612 ( 1.110)	Data  0.007 ( 0.504)	Loss 4.3601e+00 (4.8233e+00)	Clip_Loss 4.3601e+00 (4.8233e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.5286 (75.3590)	Acc@5 96.8750 (95.5357)	Acc@10 98.4375 (98.8839)
Epoch 226 running time:  0:00:33.694017
===> Building meters
DataParallel
4
Epoch: [227][545/32]	Time  6.387 ( 6.387)	Data  5.764 ( 5.764)	Loss 5.3237e+00 (5.3237e+00)	Clip_Loss 5.3237e+00 (5.3237e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 73.7941 (73.7941)	Acc@5 93.7500 (93.7500)	Acc@10 98.4375 (98.4375)
Epoch: [227][565/32]	Time  0.626 ( 1.089)	Data  0.007 ( 0.479)	Loss 4.7942e+00 (4.7339e+00)	Clip_Loss 4.7942e+00 (4.7339e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 77.9446 (75.8145)	Acc@5 95.3125 (95.3125)	Acc@10 100.0000 (99.2560)
Epoch 227 running time:  0:00:32.796824
===> Building meters
DataParallel
4
Epoch: [228][577/32]	Time  5.830 ( 5.830)	Data  5.190 ( 5.190)	Loss 5.3385e+00 (5.3385e+00)	Clip_Loss 5.3385e+00 (5.3385e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 70.2499 (70.2499)	Acc@5 93.7500 (93.7500)	Acc@10 98.4375 (98.4375)
Epoch: [228][597/32]	Time  0.613 ( 1.071)	Data  0.007 ( 0.470)	Loss 4.4790e+00 (4.7300e+00)	Clip_Loss 4.4790e+00 (4.7300e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.7571 (76.2155)	Acc@5 93.7500 (95.5357)	Acc@10 100.0000 (99.1815)
Epoch 228 running time:  0:00:33.010942
===> Building meters
DataParallel
4
Epoch: [229][609/32]	Time  6.458 ( 6.458)	Data  5.805 ( 5.805)	Loss 4.2379e+00 (4.2379e+00)	Clip_Loss 4.2379e+00 (4.2379e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.8581 (80.8581)	Acc@5 96.8750 (96.8750)	Acc@10 98.4375 (98.4375)
Epoch: [229][629/32]	Time  0.590 ( 1.075)	Data  0.007 ( 0.471)	Loss 5.0480e+00 (4.8169e+00)	Clip_Loss 5.0480e+00 (4.8169e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 72.9241 (74.8165)	Acc@5 98.4375 (95.0149)	Acc@10 98.4375 (98.5863)
Epoch 229 running time:  0:00:33.488233
===> Building meters
DataParallel
4
Epoch: [230][641/32]	Time  6.280 ( 6.280)	Data  5.631 ( 5.631)	Loss 4.7955e+00 (4.7955e+00)	Clip_Loss 4.7955e+00 (4.7955e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 76.7857 (76.7857)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [230][661/32]	Time  0.619 ( 1.053)	Data  0.008 ( 0.446)	Loss 4.6947e+00 (4.6887e+00)	Clip_Loss 4.6947e+00 (4.6887e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 76.6741 (76.5008)	Acc@5 95.3125 (95.9821)	Acc@10 98.4375 (99.1815)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 230 running time:  0:01:13.000826
===> Building meters
DataParallel
4
Epoch: [231][673/32]	Time  7.647 ( 7.647)	Data  7.024 ( 7.024)	Loss 4.7693e+00 (4.7693e+00)	Clip_Loss 4.7693e+00 (4.7693e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 73.9844 (73.9844)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [231][693/32]	Time  0.617 ( 1.242)	Data  0.007 ( 0.635)	Loss 4.8932e+00 (4.7641e+00)	Clip_Loss 4.8932e+00 (4.7641e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 71.1347 (76.2729)	Acc@5 93.7500 (95.2381)	Acc@10 100.0000 (99.1071)
Epoch 231 running time:  0:00:38.105260
===> Building meters
DataParallel
4
Epoch: [232][705/32]	Time  5.918 ( 5.918)	Data  5.300 ( 5.300)	Loss 4.4976e+00 (4.4976e+00)	Clip_Loss 4.4976e+00 (4.4976e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.4549 (78.4549)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [232][725/32]	Time  0.616 ( 1.008)	Data  0.007 ( 0.407)	Loss 4.1685e+00 (4.7830e+00)	Clip_Loss 4.1685e+00 (4.7830e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.4245 (75.6022)	Acc@5 98.4375 (95.8333)	Acc@10 100.0000 (99.4792)
Epoch 232 running time:  0:00:30.799318
===> Building meters
DataParallel
4
Epoch: [233][737/32]	Time  5.664 ( 5.664)	Data  5.057 ( 5.057)	Loss 4.9911e+00 (4.9911e+00)	Clip_Loss 4.9911e+00 (4.9911e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 73.9609 (73.9609)	Acc@5 87.5000 (87.5000)	Acc@10 98.4375 (98.4375)
Epoch: [233][757/32]	Time  0.593 ( 1.112)	Data  0.007 ( 0.504)	Loss 5.4840e+00 (4.8282e+00)	Clip_Loss 5.4840e+00 (4.8282e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 68.4065 (75.6833)	Acc@5 95.3125 (94.1964)	Acc@10 100.0000 (98.8095)
Epoch 233 running time:  0:00:34.490739
===> Building meters
DataParallel
4
Epoch: [234][769/32]	Time  6.103 ( 6.103)	Data  5.464 ( 5.464)	Loss 4.8973e+00 (4.8973e+00)	Clip_Loss 4.8973e+00 (4.8973e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 72.7760 (72.7760)	Acc@5 93.7500 (93.7500)	Acc@10 96.8750 (96.8750)
Epoch: [234][789/32]	Time  0.652 ( 1.087)	Data  0.008 ( 0.476)	Loss 4.8221e+00 (4.7543e+00)	Clip_Loss 4.8221e+00 (4.7543e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 74.3936 (76.3041)	Acc@5 96.8750 (95.2381)	Acc@10 98.4375 (98.5863)
Epoch 234 running time:  0:00:33.590996
===> Building meters
DataParallel
4
Epoch: [235][801/32]	Time  6.484 ( 6.484)	Data  5.863 ( 5.863)	Loss 4.7622e+00 (4.7622e+00)	Clip_Loss 4.7622e+00 (4.7622e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 73.4570 (73.4570)	Acc@5 93.7500 (93.7500)	Acc@10 98.4375 (98.4375)
Epoch: [235][821/32]	Time  0.624 ( 1.104)	Data  0.007 ( 0.496)	Loss 4.5827e+00 (4.6383e+00)	Clip_Loss 4.5827e+00 (4.6383e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.1606 (77.4330)	Acc@5 96.8750 (96.1310)	Acc@10 100.0000 (99.3304)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 235 running time:  0:01:19.061516
===> Building meters
DataParallel
4
Epoch: [236][833/32]	Time  7.088 ( 7.088)	Data  6.471 ( 6.471)	Loss 4.9347e+00 (4.9347e+00)	Clip_Loss 4.9347e+00 (4.9347e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 72.7776 (72.7776)	Acc@5 96.8750 (96.8750)	Acc@10 98.4375 (98.4375)
Epoch: [236][853/32]	Time  0.629 ( 1.253)	Data  0.007 ( 0.645)	Loss 5.6969e+00 (4.7606e+00)	Clip_Loss 5.6969e+00 (4.7606e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 70.3955 (75.6808)	Acc@5 87.5000 (95.5357)	Acc@10 95.3125 (98.9583)
Epoch 236 running time:  0:00:37.654052
===> Building meters
DataParallel
4
Epoch: [237][865/32]	Time  6.070 ( 6.070)	Data  5.473 ( 5.473)	Loss 4.0256e+00 (4.0256e+00)	Clip_Loss 4.0256e+00 (4.0256e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.5253 (81.5253)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [237][885/32]	Time  0.589 ( 1.032)	Data  0.007 ( 0.427)	Loss 4.2239e+00 (4.6983e+00)	Clip_Loss 4.2239e+00 (4.6983e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.4836 (76.8998)	Acc@5 98.4375 (95.2381)	Acc@10 100.0000 (98.8095)
Epoch 237 running time:  0:00:31.250061
===> Building meters
DataParallel
4
Epoch: [238][897/32]	Time  6.267 ( 6.267)	Data  5.617 ( 5.617)	Loss 4.4875e+00 (4.4875e+00)	Clip_Loss 4.4875e+00 (4.4875e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.1808 (78.1808)	Acc@5 95.3125 (95.3125)	Acc@10 100.0000 (100.0000)
Epoch: [238][917/32]	Time  0.617 ( 1.124)	Data  0.008 ( 0.511)	Loss 4.4683e+00 (4.5793e+00)	Clip_Loss 4.4683e+00 (4.5793e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.4055 (77.1813)	Acc@5 95.3125 (96.0565)	Acc@10 100.0000 (99.1815)
Epoch 238 running time:  0:00:34.640907
====> Test::::/datasets/aicitychallenge2023/val.json
====> Query /datasets/aicitychallenge2023/val.json load
Test Epoch: [239][162/163]	Time 111.511 (111.511)	Data  0.000 ( 0.000)	Clip Loss 4.1899e+00 (4.1899e+00)	MRR 44.4236 (44.4236)	Acc@1 26.0000 (26.0000)	Acc@5 68.0000 (68.0000)
Epoch 239 running time:  0:01:51.517097
Logs dir: logs/dual_baseline_aug1 
====> results in csv format: 
| Method             | Dataset                                | Epoch   | Loss   | MRR    | Acc-5   | Acc-10   |
|:-------------------|:---------------------------------------|:--------|:-------|:-------|:--------|:---------|
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 19      | 4.418  | 18.029 | 6.000   | 29.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 39      | 4.318  | 25.640 | 12.000  | 39.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 59      | 4.308  | 26.601 | 10.000  | 45.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 79      | 4.256  | 32.901 | 16.000  | 53.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 99      | 4.248  | 35.485 | 19.000  | 54.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 119     | 4.278  | 36.260 | 19.000  | 60.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 139     | 4.258  | 34.736 | 18.000  | 56.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 159     | 4.232  | 35.243 | 21.000  | 51.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 179     | 4.187  | 43.807 | 26.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 199     | 4.184  | 45.585 | 27.000  | 71.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 219     | 4.183  | 41.780 | 22.000  | 67.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 239     | 4.190  | 44.424 | 26.000  | 68.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | Max_199 | 4.184  | 45.585 | 27.000  | 71.000   |
===> Building meters
DataParallel
4
Epoch: [239][929/32]	Time  6.761 ( 6.761)	Data  6.145 ( 6.145)	Loss 4.4940e+00 (4.4940e+00)	Clip_Loss 4.4940e+00 (4.4940e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.4297 (75.4297)	Acc@5 95.3125 (95.3125)	Acc@10 100.0000 (100.0000)
Epoch: [239][949/32]	Time  0.683 ( 1.249)	Data  0.008 ( 0.639)	Loss 4.1661e+00 (4.8398e+00)	Clip_Loss 4.1661e+00 (4.8398e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.8767 (76.0200)	Acc@5 96.8750 (95.1637)	Acc@10 100.0000 (98.9583)
Epoch 239 running time:  0:00:38.310970
===> Building meters
DataParallel
4
Epoch: [240][ 1/32]	Time  5.817 ( 5.817)	Data  5.145 ( 5.145)	Loss 5.0315e+00 (5.0315e+00)	Clip_Loss 5.0315e+00 (5.0315e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 72.8591 (72.8591)	Acc@5 95.3125 (95.3125)	Acc@10 98.4375 (98.4375)
Epoch: [240][21/32]	Time  0.617 ( 0.993)	Data  0.007 ( 0.386)	Loss 4.5216e+00 (4.5783e+00)	Clip_Loss 4.5216e+00 (4.5783e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 76.8490 (77.6255)	Acc@5 100.0000 (95.5357)	Acc@10 100.0000 (99.1071)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 240 running time:  0:00:56.884718
===> Building meters
DataParallel
4
Epoch: [241][33/32]	Time  7.198 ( 7.198)	Data  6.596 ( 6.596)	Loss 4.4228e+00 (4.4228e+00)	Clip_Loss 4.4228e+00 (4.4228e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.0286 (81.0286)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [241][53/32]	Time  0.625 ( 1.263)	Data  0.009 ( 0.655)	Loss 4.6563e+00 (4.7268e+00)	Clip_Loss 4.6563e+00 (4.7268e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 72.4479 (76.3323)	Acc@5 96.8750 (95.9077)	Acc@10 100.0000 (99.2560)
Epoch 241 running time:  0:00:37.785622
===> Building meters
DataParallel
4
Epoch: [242][65/32]	Time  5.749 ( 5.749)	Data  5.095 ( 5.095)	Loss 4.9771e+00 (4.9771e+00)	Clip_Loss 4.9771e+00 (4.9771e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 76.4187 (76.4187)	Acc@5 92.1875 (92.1875)	Acc@10 96.8750 (96.8750)
Epoch: [242][85/32]	Time  0.679 ( 0.997)	Data  0.007 ( 0.387)	Loss 4.8296e+00 (4.6547e+00)	Clip_Loss 4.8296e+00 (4.6547e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.5253 (77.7073)	Acc@5 96.8750 (95.6101)	Acc@10 100.0000 (99.2560)
Epoch 242 running time:  0:00:29.487141
===> Building meters
DataParallel
4
Epoch: [243][97/32]	Time  6.199 ( 6.199)	Data  5.580 ( 5.580)	Loss 4.5345e+00 (4.5345e+00)	Clip_Loss 4.5345e+00 (4.5345e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 72.8516 (72.8516)	Acc@5 92.1875 (92.1875)	Acc@10 100.0000 (100.0000)
Epoch: [243][117/32]	Time  0.677 ( 1.127)	Data  0.007 ( 0.519)	Loss 4.7762e+00 (4.6413e+00)	Clip_Loss 4.7762e+00 (4.6413e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 73.6719 (76.0217)	Acc@5 98.4375 (94.9405)	Acc@10 100.0000 (98.8095)
Epoch 243 running time:  0:00:35.059273
===> Building meters
DataParallel
4
Epoch: [244][129/32]	Time  6.279 ( 6.279)	Data  5.666 ( 5.666)	Loss 4.2384e+00 (4.2384e+00)	Clip_Loss 4.2384e+00 (4.2384e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 76.1589 (76.1589)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [244][149/32]	Time  0.781 ( 1.046)	Data  0.007 ( 0.435)	Loss 5.3972e+00 (4.6636e+00)	Clip_Loss 5.3972e+00 (4.6636e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 72.8878 (76.7122)	Acc@5 92.1875 (95.9077)	Acc@10 98.4375 (99.1071)
Epoch 244 running time:  0:00:32.401985
===> Building meters
DataParallel
4
Epoch: [245][161/32]	Time  6.327 ( 6.327)	Data  5.669 ( 5.669)	Loss 4.9812e+00 (4.9812e+00)	Clip_Loss 4.9812e+00 (4.9812e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 73.8281 (73.8281)	Acc@5 95.3125 (95.3125)	Acc@10 100.0000 (100.0000)
Epoch: [245][181/32]	Time  0.593 ( 1.086)	Data  0.007 ( 0.474)	Loss 4.8706e+00 (4.5782e+00)	Clip_Loss 4.8706e+00 (4.5782e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.4001 (78.4099)	Acc@5 93.7500 (96.5030)	Acc@10 96.8750 (99.4792)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 245 running time:  0:01:00.281725
===> Building meters
DataParallel
4
Epoch: [246][193/32]	Time  6.621 ( 6.621)	Data  6.005 ( 6.005)	Loss 3.8969e+00 (3.8969e+00)	Clip_Loss 3.8969e+00 (3.8969e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.6458 (78.6458)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [246][213/32]	Time  0.615 ( 1.213)	Data  0.007 ( 0.605)	Loss 4.6486e+00 (4.5943e+00)	Clip_Loss 4.6486e+00 (4.5943e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 74.6484 (76.5374)	Acc@5 96.8750 (95.6101)	Acc@10 100.0000 (99.0327)
Epoch 246 running time:  0:00:36.961783
===> Building meters
DataParallel
4
Epoch: [247][225/32]	Time  6.139 ( 6.139)	Data  5.505 ( 5.505)	Loss 4.0992e+00 (4.0992e+00)	Clip_Loss 4.0992e+00 (4.0992e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.2778 (80.2778)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [247][245/32]	Time  0.591 ( 1.063)	Data  0.007 ( 0.458)	Loss 4.8098e+00 (4.5121e+00)	Clip_Loss 4.8098e+00 (4.5121e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 72.4609 (78.5087)	Acc@5 92.1875 (97.3214)	Acc@10 100.0000 (99.6280)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 247 running time:  0:00:59.792381
===> Building meters
DataParallel
4
Epoch: [248][257/32]	Time  6.554 ( 6.554)	Data  5.893 ( 5.893)	Loss 5.4045e+00 (5.4045e+00)	Clip_Loss 5.4045e+00 (5.4045e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 72.6762 (72.6762)	Acc@5 92.1875 (92.1875)	Acc@10 95.3125 (95.3125)
Epoch: [248][277/32]	Time  0.618 ( 1.189)	Data  0.008 ( 0.580)	Loss 3.8354e+00 (4.6802e+00)	Clip_Loss 3.8354e+00 (4.6802e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 87.7604 (77.0193)	Acc@5 98.4375 (95.7589)	Acc@10 100.0000 (99.2560)
Epoch 248 running time:  0:00:36.975345
===> Building meters
DataParallel
4
Epoch: [249][289/32]	Time  5.699 ( 5.699)	Data  5.049 ( 5.049)	Loss 4.0332e+00 (4.0332e+00)	Clip_Loss 4.0332e+00 (4.0332e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.4133 (83.4133)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [249][309/32]	Time  0.595 ( 0.994)	Data  0.007 ( 0.387)	Loss 4.6263e+00 (4.5714e+00)	Clip_Loss 4.6263e+00 (4.5714e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.6111 (78.1303)	Acc@5 96.8750 (96.2054)	Acc@10 98.4375 (98.9583)
Epoch 249 running time:  0:00:30.003569
===> Building meters
DataParallel
4
Epoch: [250][321/32]	Time  5.799 ( 5.799)	Data  5.173 ( 5.173)	Loss 3.7816e+00 (3.7816e+00)	Clip_Loss 3.7816e+00 (3.7816e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.8958 (84.8958)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [250][341/32]	Time  0.589 ( 1.071)	Data  0.007 ( 0.465)	Loss 4.1418e+00 (4.4176e+00)	Clip_Loss 4.1418e+00 (4.4176e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.0990 (77.7255)	Acc@5 98.4375 (96.9494)	Acc@10 100.0000 (99.5536)
Epoch 250 running time:  0:00:32.909128
===> Building meters
DataParallel
4
Epoch: [251][353/32]	Time  6.154 ( 6.154)	Data  5.519 ( 5.519)	Loss 5.2531e+00 (5.2531e+00)	Clip_Loss 5.2531e+00 (5.2531e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 72.8060 (72.8060)	Acc@5 96.8750 (96.8750)	Acc@10 96.8750 (96.8750)
Epoch: [251][373/32]	Time  0.620 ( 1.094)	Data  0.007 ( 0.480)	Loss 4.4889e+00 (4.4789e+00)	Clip_Loss 4.4889e+00 (4.4789e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 72.3698 (77.8758)	Acc@5 96.8750 (96.4286)	Acc@10 100.0000 (99.4792)
Epoch 251 running time:  0:00:32.648373
===> Building meters
DataParallel
4
Epoch: [252][385/32]	Time  5.827 ( 5.827)	Data  5.207 ( 5.207)	Loss 4.6066e+00 (4.6066e+00)	Clip_Loss 4.6066e+00 (4.6066e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.4434 (75.4434)	Acc@5 93.7500 (93.7500)	Acc@10 98.4375 (98.4375)
Epoch: [252][405/32]	Time  0.592 ( 1.048)	Data  0.007 ( 0.442)	Loss 4.0953e+00 (4.4702e+00)	Clip_Loss 4.0953e+00 (4.4702e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.5677 (78.5276)	Acc@5 100.0000 (95.7589)	Acc@10 100.0000 (99.4048)
Epoch 252 running time:  0:00:32.363715
===> Building meters
DataParallel
4
Epoch: [253][417/32]	Time  6.355 ( 6.355)	Data  5.761 ( 5.761)	Loss 4.4372e+00 (4.4372e+00)	Clip_Loss 4.4372e+00 (4.4372e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.1042 (75.1042)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [253][437/32]	Time  0.637 ( 1.110)	Data  0.007 ( 0.507)	Loss 4.9009e+00 (4.6653e+00)	Clip_Loss 4.9009e+00 (4.6653e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 73.8281 (77.0001)	Acc@5 96.8750 (95.0893)	Acc@10 100.0000 (98.6607)
Epoch 253 running time:  0:00:34.187051
===> Building meters
DataParallel
4
Epoch: [254][449/32]	Time  5.909 ( 5.909)	Data  5.287 ( 5.287)	Loss 5.0333e+00 (5.0333e+00)	Clip_Loss 5.0333e+00 (5.0333e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 73.9453 (73.9453)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [254][469/32]	Time  0.624 ( 1.062)	Data  0.007 ( 0.455)	Loss 4.1728e+00 (4.6097e+00)	Clip_Loss 4.1728e+00 (4.6097e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.6458 (76.1081)	Acc@5 95.3125 (95.6101)	Acc@10 100.0000 (99.0327)
Epoch 254 running time:  0:00:32.491783
===> Building meters
DataParallel
4
Epoch: [255][481/32]	Time  5.932 ( 5.932)	Data  5.318 ( 5.318)	Loss 3.9202e+00 (3.9202e+00)	Clip_Loss 3.9202e+00 (3.9202e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.7656 (84.7656)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [255][501/32]	Time  0.615 ( 1.111)	Data  0.007 ( 0.508)	Loss 4.5039e+00 (4.6334e+00)	Clip_Loss 4.5039e+00 (4.6334e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.8750 (76.9692)	Acc@5 100.0000 (96.9494)	Acc@10 100.0000 (99.4792)
Epoch 255 running time:  0:00:34.352982
===> Building meters
DataParallel
4
Epoch: [256][513/32]	Time  6.491 ( 6.491)	Data  5.871 ( 5.871)	Loss 5.1960e+00 (5.1960e+00)	Clip_Loss 5.1960e+00 (5.1960e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 71.7746 (71.7746)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [256][533/32]	Time  0.639 ( 1.095)	Data  0.008 ( 0.493)	Loss 4.3751e+00 (4.5245e+00)	Clip_Loss 4.3751e+00 (4.5245e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.0000 (77.8769)	Acc@5 100.0000 (95.9821)	Acc@10 100.0000 (99.4048)
Epoch 256 running time:  0:00:33.154157
===> Building meters
DataParallel
4
Epoch: [257][545/32]	Time  5.941 ( 5.941)	Data  5.315 ( 5.315)	Loss 4.8097e+00 (4.8097e+00)	Clip_Loss 4.8097e+00 (4.8097e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.8309 (75.8309)	Acc@5 90.6250 (90.6250)	Acc@10 100.0000 (100.0000)
Epoch: [257][565/32]	Time  0.648 ( 1.099)	Data  0.007 ( 0.497)	Loss 5.2726e+00 (4.5656e+00)	Clip_Loss 5.2726e+00 (4.5656e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 72.2793 (76.5897)	Acc@5 89.0625 (95.8333)	Acc@10 96.8750 (99.3304)
Epoch 257 running time:  0:00:33.210917
===> Building meters
DataParallel
4
Epoch: [258][577/32]	Time  6.041 ( 6.041)	Data  5.395 ( 5.395)	Loss 4.5812e+00 (4.5812e+00)	Clip_Loss 4.5812e+00 (4.5812e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 76.1682 (76.1682)	Acc@5 93.7500 (93.7500)	Acc@10 98.4375 (98.4375)
Epoch: [258][597/32]	Time  0.615 ( 1.086)	Data  0.007 ( 0.475)	Loss 4.5468e+00 (4.5415e+00)	Clip_Loss 4.5468e+00 (4.5415e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.3951 (78.0241)	Acc@5 98.4375 (96.7262)	Acc@10 100.0000 (99.5536)
Epoch 258 running time:  0:00:33.331506
====> Test::::/datasets/aicitychallenge2023/val.json
====> Query /datasets/aicitychallenge2023/val.json load
Test Epoch: [259][162/163]	Time 116.195 (116.195)	Data  0.000 ( 0.000)	Clip Loss 4.2001e+00 (4.2001e+00)	MRR 44.4915 (44.4915)	Acc@1 27.0000 (27.0000)	Acc@5 69.0000 (69.0000)
Epoch 259 running time:  0:01:56.202593
Logs dir: logs/dual_baseline_aug1 
====> results in csv format: 
| Method             | Dataset                                | Epoch   | Loss   | MRR    | Acc-5   | Acc-10   |
|:-------------------|:---------------------------------------|:--------|:-------|:-------|:--------|:---------|
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 19      | 4.418  | 18.029 | 6.000   | 29.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 39      | 4.318  | 25.640 | 12.000  | 39.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 59      | 4.308  | 26.601 | 10.000  | 45.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 79      | 4.256  | 32.901 | 16.000  | 53.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 99      | 4.248  | 35.485 | 19.000  | 54.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 119     | 4.278  | 36.260 | 19.000  | 60.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 139     | 4.258  | 34.736 | 18.000  | 56.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 159     | 4.232  | 35.243 | 21.000  | 51.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 179     | 4.187  | 43.807 | 26.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 199     | 4.184  | 45.585 | 27.000  | 71.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 219     | 4.183  | 41.780 | 22.000  | 67.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 239     | 4.190  | 44.424 | 26.000  | 68.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 259     | 4.200  | 44.491 | 27.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | Max_199 | 4.184  | 45.585 | 27.000  | 71.000   |
===> Building meters
DataParallel
4
Epoch: [259][609/32]	Time  7.212 ( 7.212)	Data  6.574 ( 6.574)	Loss 4.5679e+00 (4.5679e+00)	Clip_Loss 4.5679e+00 (4.5679e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.9914 (80.9914)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [259][629/32]	Time  0.646 ( 1.326)	Data  0.007 ( 0.722)	Loss 4.6986e+00 (4.4245e+00)	Clip_Loss 4.6986e+00 (4.4245e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 74.6733 (78.0868)	Acc@5 96.8750 (96.4286)	Acc@10 98.4375 (99.4048)
Epoch 259 running time:  0:00:39.946748
===> Building meters
DataParallel
4
Epoch: [260][641/32]	Time  5.811 ( 5.811)	Data  5.191 ( 5.191)	Loss 5.1849e+00 (5.1849e+00)	Clip_Loss 5.1849e+00 (5.1849e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 73.1849 (73.1849)	Acc@5 95.3125 (95.3125)	Acc@10 98.4375 (98.4375)
Epoch: [260][661/32]	Time  0.612 ( 1.008)	Data  0.007 ( 0.394)	Loss 3.8040e+00 (4.5717e+00)	Clip_Loss 3.8040e+00 (4.5717e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.9844 (78.7647)	Acc@5 100.0000 (96.0565)	Acc@10 100.0000 (99.4048)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 260 running time:  0:01:09.034382
===> Building meters
DataParallel
4
Epoch: [261][673/32]	Time  7.220 ( 7.220)	Data  6.605 ( 6.605)	Loss 4.2876e+00 (4.2876e+00)	Clip_Loss 4.2876e+00 (4.2876e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.7206 (81.7206)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [261][693/32]	Time  0.621 ( 1.263)	Data  0.007 ( 0.651)	Loss 4.8356e+00 (4.4825e+00)	Clip_Loss 4.8356e+00 (4.4825e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.8247 (78.8692)	Acc@5 98.4375 (96.3542)	Acc@10 100.0000 (99.5536)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 261 running time:  0:01:09.062422
===> Building meters
DataParallel
4
Epoch: [262][705/32]	Time  6.729 ( 6.729)	Data  6.081 ( 6.081)	Loss 4.8310e+00 (4.8310e+00)	Clip_Loss 4.8310e+00 (4.8310e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.4846 (75.4846)	Acc@5 98.4375 (98.4375)	Acc@10 98.4375 (98.4375)
Epoch: [262][725/32]	Time  0.593 ( 1.159)	Data  0.007 ( 0.556)	Loss 4.6179e+00 (4.5749e+00)	Clip_Loss 4.6179e+00 (4.5749e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.2812 (78.0148)	Acc@5 95.3125 (95.5357)	Acc@10 100.0000 (99.0327)
Epoch 262 running time:  0:00:35.651055
===> Building meters
DataParallel
4
Epoch: [263][737/32]	Time  5.755 ( 5.755)	Data  5.114 ( 5.114)	Loss 3.9857e+00 (3.9857e+00)	Clip_Loss 3.9857e+00 (3.9857e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.4970 (83.4970)	Acc@5 98.4375 (98.4375)	Acc@10 98.4375 (98.4375)
Epoch: [263][757/32]	Time  0.629 ( 1.205)	Data  0.007 ( 0.595)	Loss 4.5750e+00 (4.4756e+00)	Clip_Loss 4.5750e+00 (4.4756e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.5556 (78.1536)	Acc@5 96.8750 (96.7262)	Acc@10 100.0000 (99.4792)
Epoch 263 running time:  0:00:35.536743
===> Building meters
DataParallel
4
Epoch: [264][769/32]	Time  6.137 ( 6.137)	Data  5.520 ( 5.520)	Loss 4.3339e+00 (4.3339e+00)	Clip_Loss 4.3339e+00 (4.3339e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 76.1868 (76.1868)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [264][789/32]	Time  0.621 ( 1.154)	Data  0.010 ( 0.545)	Loss 4.8591e+00 (4.4636e+00)	Clip_Loss 4.8591e+00 (4.4636e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.4055 (78.4720)	Acc@5 96.8750 (96.5774)	Acc@10 98.4375 (99.3304)
Epoch 264 running time:  0:00:34.957467
===> Building meters
DataParallel
4
Epoch: [265][801/32]	Time  6.502 ( 6.502)	Data  5.878 ( 5.878)	Loss 4.0149e+00 (4.0149e+00)	Clip_Loss 4.0149e+00 (4.0149e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 86.0888 (86.0888)	Acc@5 95.3125 (95.3125)	Acc@10 100.0000 (100.0000)
Epoch: [265][821/32]	Time  0.613 ( 1.048)	Data  0.007 ( 0.440)	Loss 4.5658e+00 (4.5130e+00)	Clip_Loss 4.5658e+00 (4.5130e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 79.9728 (78.5425)	Acc@5 96.8750 (96.2054)	Acc@10 98.4375 (99.4048)
Epoch 265 running time:  0:00:32.704187
===> Building meters
DataParallel
4
Epoch: [266][833/32]	Time  5.896 ( 5.896)	Data  5.249 ( 5.249)	Loss 5.4405e+00 (5.4405e+00)	Clip_Loss 5.4405e+00 (5.4405e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 70.3116 (70.3116)	Acc@5 87.5000 (87.5000)	Acc@10 98.4375 (98.4375)
Epoch: [266][853/32]	Time  0.590 ( 1.088)	Data  0.007 ( 0.479)	Loss 4.1123e+00 (4.5908e+00)	Clip_Loss 4.1123e+00 (4.5908e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.5573 (78.5887)	Acc@5 98.4375 (96.4286)	Acc@10 100.0000 (99.1815)
Epoch 266 running time:  0:00:33.385905
===> Building meters
DataParallel
4
Epoch: [267][865/32]	Time  6.406 ( 6.406)	Data  5.781 ( 5.781)	Loss 4.6177e+00 (4.6177e+00)	Clip_Loss 4.6177e+00 (4.6177e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.1529 (78.1529)	Acc@5 95.3125 (95.3125)	Acc@10 98.4375 (98.4375)
Epoch: [267][885/32]	Time  0.615 ( 1.151)	Data  0.007 ( 0.535)	Loss 5.3214e+00 (4.4847e+00)	Clip_Loss 5.3214e+00 (4.4847e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 68.9851 (78.5312)	Acc@5 93.7500 (96.7262)	Acc@10 98.4375 (99.1815)
Epoch 267 running time:  0:00:34.653718
===> Building meters
DataParallel
4
Epoch: [268][897/32]	Time  6.189 ( 6.189)	Data  5.574 ( 5.574)	Loss 4.5193e+00 (4.5193e+00)	Clip_Loss 4.5193e+00 (4.5193e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.6068 (78.6068)	Acc@5 95.3125 (95.3125)	Acc@10 100.0000 (100.0000)
Epoch: [268][917/32]	Time  0.612 ( 1.069)	Data  0.007 ( 0.466)	Loss 4.4807e+00 (4.4748e+00)	Clip_Loss 4.4807e+00 (4.4748e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.2666 (79.1991)	Acc@5 96.8750 (96.5030)	Acc@10 100.0000 (99.3304)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 268 running time:  0:01:15.502309
===> Building meters
DataParallel
4
Epoch: [269][929/32]	Time  6.738 ( 6.738)	Data  6.116 ( 6.116)	Loss 3.8029e+00 (3.8029e+00)	Clip_Loss 3.8029e+00 (3.8029e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.1146 (84.1146)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [269][949/32]	Time  0.590 ( 1.244)	Data  0.007 ( 0.638)	Loss 3.7354e+00 (4.3059e+00)	Clip_Loss 3.7354e+00 (4.3059e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 77.5781 (79.7125)	Acc@5 98.4375 (97.6935)	Acc@10 100.0000 (99.9256)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 269 running time:  0:01:16.862202
===> Building meters
DataParallel
4
Epoch: [270][ 1/32]	Time  9.105 ( 9.105)	Data  8.494 ( 8.494)	Loss 4.9154e+00 (4.9154e+00)	Clip_Loss 4.9154e+00 (4.9154e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.7689 (75.7689)	Acc@5 93.7500 (93.7500)	Acc@10 98.4375 (98.4375)
Epoch: [270][21/32]	Time  0.590 ( 1.502)	Data  0.007 ( 0.900)	Loss 4.7067e+00 (4.4717e+00)	Clip_Loss 4.7067e+00 (4.4717e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 77.0833 (79.0528)	Acc@5 98.4375 (96.5030)	Acc@10 100.0000 (99.7024)
Epoch 270 running time:  0:00:43.187193
===> Building meters
DataParallel
4
Epoch: [271][33/32]	Time  6.041 ( 6.041)	Data  5.425 ( 5.425)	Loss 4.0320e+00 (4.0320e+00)	Clip_Loss 4.0320e+00 (4.0320e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 82.0833 (82.0833)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [271][53/32]	Time  0.613 ( 1.016)	Data  0.007 ( 0.412)	Loss 4.6236e+00 (4.3102e+00)	Clip_Loss 4.6236e+00 (4.3102e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 79.0260 (79.3704)	Acc@5 95.3125 (96.9494)	Acc@10 98.4375 (99.7024)
Epoch 271 running time:  0:00:30.593688
===> Building meters
DataParallel
4
Epoch: [272][65/32]	Time  6.079 ( 6.079)	Data  5.486 ( 5.486)	Loss 4.4912e+00 (4.4912e+00)	Clip_Loss 4.4912e+00 (4.4912e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.4784 (78.4784)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [272][85/32]	Time  0.617 ( 1.085)	Data  0.007 ( 0.479)	Loss 3.8738e+00 (4.3486e+00)	Clip_Loss 3.8738e+00 (4.3486e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.8809 (79.7990)	Acc@5 95.3125 (96.5774)	Acc@10 98.4375 (99.3304)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 272 running time:  0:01:19.977742
===> Building meters
DataParallel
4
Epoch: [273][97/32]	Time  7.146 ( 7.146)	Data  6.552 ( 6.552)	Loss 4.4380e+00 (4.4380e+00)	Clip_Loss 4.4380e+00 (4.4380e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.2571 (78.2571)	Acc@5 95.3125 (95.3125)	Acc@10 100.0000 (100.0000)
Epoch: [273][117/32]	Time  0.611 ( 1.254)	Data  0.007 ( 0.647)	Loss 3.8945e+00 (4.3999e+00)	Clip_Loss 3.8945e+00 (4.3999e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 92.1875 (79.5325)	Acc@5 100.0000 (96.9494)	Acc@10 100.0000 (99.9256)
Epoch 273 running time:  0:00:37.716662
===> Building meters
DataParallel
4
Epoch: [274][129/32]	Time  6.081 ( 6.081)	Data  5.465 ( 5.465)	Loss 4.4421e+00 (4.4421e+00)	Clip_Loss 4.4421e+00 (4.4421e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.7441 (80.7441)	Acc@5 92.1875 (92.1875)	Acc@10 100.0000 (100.0000)
Epoch: [274][149/32]	Time  0.625 ( 1.020)	Data  0.007 ( 0.406)	Loss 4.2076e+00 (4.3452e+00)	Clip_Loss 4.2076e+00 (4.3452e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.2145 (79.4974)	Acc@5 96.8750 (97.0982)	Acc@10 100.0000 (99.7024)
Epoch 274 running time:  0:00:30.708047
===> Building meters
DataParallel
4
Epoch: [275][161/32]	Time  6.142 ( 6.142)	Data  5.519 ( 5.519)	Loss 4.4907e+00 (4.4907e+00)	Clip_Loss 4.4907e+00 (4.4907e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.9896 (80.9896)	Acc@5 96.8750 (96.8750)	Acc@10 98.4375 (98.4375)
Epoch: [275][181/32]	Time  0.646 ( 1.266)	Data  0.007 ( 0.650)	Loss 4.4989e+00 (4.3242e+00)	Clip_Loss 4.4989e+00 (4.3242e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 77.6562 (79.6114)	Acc@5 96.8750 (96.6518)	Acc@10 100.0000 (99.4792)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 275 running time:  0:01:02.648128
===> Building meters
DataParallel
4
Epoch: [276][193/32]	Time  6.765 ( 6.765)	Data  6.116 ( 6.116)	Loss 4.0017e+00 (4.0017e+00)	Clip_Loss 4.0017e+00 (4.0017e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.3854 (78.3854)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [276][213/32]	Time  0.590 ( 1.117)	Data  0.007 ( 0.508)	Loss 4.3964e+00 (4.3368e+00)	Clip_Loss 4.3964e+00 (4.3368e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.3819 (80.0575)	Acc@5 96.8750 (96.8006)	Acc@10 100.0000 (99.7768)
Epoch 276 running time:  0:00:34.580818
===> Building meters
DataParallel
4
Epoch: [277][225/32]	Time  6.178 ( 6.178)	Data  5.525 ( 5.525)	Loss 4.1197e+00 (4.1197e+00)	Clip_Loss 4.1197e+00 (4.1197e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.7682 (80.7682)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [277][245/32]	Time  0.611 ( 1.074)	Data  0.007 ( 0.466)	Loss 4.6489e+00 (4.2694e+00)	Clip_Loss 4.6489e+00 (4.2694e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.0320 (80.0240)	Acc@5 92.1875 (97.1726)	Acc@10 98.4375 (99.6280)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 277 running time:  0:00:55.732648
===> Building meters
DataParallel
4
Epoch: [278][257/32]	Time  6.903 ( 6.903)	Data  6.276 ( 6.276)	Loss 3.8705e+00 (3.8705e+00)	Clip_Loss 3.8705e+00 (3.8705e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 79.0104 (79.0104)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [278][277/32]	Time  0.617 ( 1.198)	Data  0.007 ( 0.588)	Loss 4.3999e+00 (4.3888e+00)	Clip_Loss 4.3999e+00 (4.3888e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 77.7121 (80.1651)	Acc@5 95.3125 (96.8006)	Acc@10 100.0000 (99.4048)
Epoch 278 running time:  0:00:36.553426
====> Test::::/datasets/aicitychallenge2023/val.json
====> Query /datasets/aicitychallenge2023/val.json load
Test Epoch: [279][162/163]	Time 111.404 (111.404)	Data  0.000 ( 0.000)	Clip Loss 4.1977e+00 (4.1977e+00)	MRR 44.8257 (44.8257)	Acc@1 30.0000 (30.0000)	Acc@5 61.0000 (61.0000)
Epoch 279 running time:  0:01:51.409419
Logs dir: logs/dual_baseline_aug1 
====> results in csv format: 
| Method             | Dataset                                | Epoch   | Loss   | MRR    | Acc-5   | Acc-10   |
|:-------------------|:---------------------------------------|:--------|:-------|:-------|:--------|:---------|
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 19      | 4.418  | 18.029 | 6.000   | 29.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 39      | 4.318  | 25.640 | 12.000  | 39.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 59      | 4.308  | 26.601 | 10.000  | 45.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 79      | 4.256  | 32.901 | 16.000  | 53.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 99      | 4.248  | 35.485 | 19.000  | 54.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 119     | 4.278  | 36.260 | 19.000  | 60.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 139     | 4.258  | 34.736 | 18.000  | 56.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 159     | 4.232  | 35.243 | 21.000  | 51.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 179     | 4.187  | 43.807 | 26.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 199     | 4.184  | 45.585 | 27.000  | 71.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 219     | 4.183  | 41.780 | 22.000  | 67.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 239     | 4.190  | 44.424 | 26.000  | 68.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 259     | 4.200  | 44.491 | 27.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 279     | 4.198  | 44.826 | 30.000  | 61.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | Max_199 | 4.184  | 45.585 | 27.000  | 71.000   |
===> Building meters
DataParallel
4
Epoch: [279][289/32]	Time  7.186 ( 7.186)	Data  6.570 ( 6.570)	Loss 4.6518e+00 (4.6518e+00)	Clip_Loss 4.6518e+00 (4.6518e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.9166 (78.9166)	Acc@5 93.7500 (93.7500)	Acc@10 98.4375 (98.4375)
Epoch: [279][309/32]	Time  0.590 ( 1.267)	Data  0.007 ( 0.659)	Loss 3.8542e+00 (4.2378e+00)	Clip_Loss 3.8542e+00 (4.2378e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.2448 (80.4873)	Acc@5 98.4375 (97.1726)	Acc@10 100.0000 (99.7024)
Epoch 279 running time:  0:00:37.782944
===> Building meters
DataParallel
4
Epoch: [280][321/32]	Time  5.828 ( 5.828)	Data  5.191 ( 5.191)	Loss 5.4283e+00 (5.4283e+00)	Clip_Loss 5.4283e+00 (5.4283e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 74.9520 (74.9520)	Acc@5 95.3125 (95.3125)	Acc@10 98.4375 (98.4375)
Epoch: [280][341/32]	Time  0.589 ( 0.962)	Data  0.007 ( 0.358)	Loss 4.5504e+00 (4.2747e+00)	Clip_Loss 4.5504e+00 (4.2747e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 76.9531 (80.9755)	Acc@5 96.8750 (97.0238)	Acc@10 100.0000 (99.7024)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 280 running time:  0:01:16.842300
===> Building meters
DataParallel
4
Epoch: [281][353/32]	Time  7.616 ( 7.616)	Data  7.002 ( 7.002)	Loss 4.6345e+00 (4.6345e+00)	Clip_Loss 4.6345e+00 (4.6345e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 77.1267 (77.1267)	Acc@5 95.3125 (95.3125)	Acc@10 100.0000 (100.0000)
Epoch: [281][373/32]	Time  0.623 ( 1.257)	Data  0.007 ( 0.652)	Loss 4.1538e+00 (4.0955e+00)	Clip_Loss 4.1538e+00 (4.0955e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 79.5871 (81.3897)	Acc@5 95.3125 (97.2470)	Acc@10 100.0000 (99.7768)
Epoch 281 running time:  0:00:42.476899
===> Building meters
DataParallel
4
Epoch: [282][385/32]	Time  5.902 ( 5.902)	Data  5.288 ( 5.288)	Loss 3.7911e+00 (3.7911e+00)	Clip_Loss 3.7911e+00 (3.7911e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 87.4870 (87.4870)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [282][405/32]	Time  0.596 ( 1.032)	Data  0.007 ( 0.428)	Loss 4.7553e+00 (4.1683e+00)	Clip_Loss 4.7553e+00 (4.1683e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 73.4152 (81.3152)	Acc@5 96.8750 (96.7262)	Acc@10 100.0000 (99.7024)
Epoch 282 running time:  0:00:31.235036
===> Building meters
DataParallel
4
Epoch: [283][417/32]	Time  6.928 ( 6.928)	Data  6.333 ( 6.333)	Loss 3.6913e+00 (3.6913e+00)	Clip_Loss 3.6913e+00 (3.6913e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 82.3568 (82.3568)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [283][437/32]	Time  0.628 ( 1.165)	Data  0.008 ( 0.555)	Loss 4.1699e+00 (4.2322e+00)	Clip_Loss 4.1699e+00 (4.2322e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.5729 (80.3798)	Acc@5 100.0000 (97.2470)	Acc@10 100.0000 (99.7768)
Epoch 283 running time:  0:00:35.740519
===> Building meters
DataParallel
4
Epoch: [284][449/32]	Time  5.615 ( 5.615)	Data  4.990 ( 4.990)	Loss 4.2217e+00 (4.2217e+00)	Clip_Loss 4.2217e+00 (4.2217e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 79.6224 (79.6224)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [284][469/32]	Time  0.591 ( 1.030)	Data  0.007 ( 0.425)	Loss 4.0139e+00 (4.2370e+00)	Clip_Loss 4.0139e+00 (4.2370e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.1215 (80.1743)	Acc@5 98.4375 (97.3958)	Acc@10 100.0000 (99.6280)
Epoch 284 running time:  0:00:34.908059
===> Building meters
DataParallel
4
Epoch: [285][481/32]	Time  6.262 ( 6.262)	Data  5.669 ( 5.669)	Loss 4.3833e+00 (4.3833e+00)	Clip_Loss 4.3833e+00 (4.3833e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.7984 (83.7984)	Acc@5 96.8750 (96.8750)	Acc@10 98.4375 (98.4375)
Epoch: [285][501/32]	Time  0.628 ( 1.084)	Data  0.007 ( 0.478)	Loss 4.9211e+00 (4.2801e+00)	Clip_Loss 4.9211e+00 (4.2801e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.2666 (80.6655)	Acc@5 95.3125 (97.3214)	Acc@10 100.0000 (99.5536)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 285 running time:  0:01:06.994276
===> Building meters
DataParallel
4
Epoch: [286][513/32]	Time  6.892 ( 6.892)	Data  6.270 ( 6.270)	Loss 4.0587e+00 (4.0587e+00)	Clip_Loss 4.0587e+00 (4.0587e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 82.2917 (82.2917)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [286][533/32]	Time  0.616 ( 1.219)	Data  0.007 ( 0.608)	Loss 5.0080e+00 (4.1686e+00)	Clip_Loss 5.0080e+00 (4.1686e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 74.8177 (80.6657)	Acc@5 98.4375 (97.4702)	Acc@10 100.0000 (99.6280)
Epoch 286 running time:  0:00:37.130395
===> Building meters
DataParallel
4
Epoch: [287][545/32]	Time  5.950 ( 5.950)	Data  5.296 ( 5.296)	Loss 4.4136e+00 (4.4136e+00)	Clip_Loss 4.4136e+00 (4.4136e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 79.1667 (79.1667)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [287][565/32]	Time  0.588 ( 1.036)	Data  0.007 ( 0.433)	Loss 4.1182e+00 (4.2628e+00)	Clip_Loss 4.1182e+00 (4.2628e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.3750 (79.7678)	Acc@5 100.0000 (96.8750)	Acc@10 100.0000 (99.7768)
Epoch 287 running time:  0:00:31.382523
===> Building meters
DataParallel
4
Epoch: [288][577/32]	Time  5.985 ( 5.985)	Data  5.344 ( 5.344)	Loss 3.7949e+00 (3.7949e+00)	Clip_Loss 3.7949e+00 (3.7949e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.6016 (81.6016)	Acc@5 96.8750 (96.8750)	Acc@10 98.4375 (98.4375)
Epoch: [288][597/32]	Time  0.612 ( 1.076)	Data  0.007 ( 0.467)	Loss 3.7895e+00 (4.1360e+00)	Clip_Loss 3.7895e+00 (4.1360e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 82.9622 (81.0396)	Acc@5 98.4375 (97.4702)	Acc@10 98.4375 (99.6280)
Epoch 288 running time:  0:00:33.452798
===> Building meters
DataParallel
4
Epoch: [289][609/32]	Time  6.436 ( 6.436)	Data  5.799 ( 5.799)	Loss 3.8581e+00 (3.8581e+00)	Clip_Loss 3.8581e+00 (3.8581e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 82.3438 (82.3438)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [289][629/32]	Time  0.604 ( 1.062)	Data  0.007 ( 0.452)	Loss 3.8073e+00 (4.1297e+00)	Clip_Loss 3.8073e+00 (4.1297e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 77.3611 (80.5296)	Acc@5 96.8750 (97.9911)	Acc@10 100.0000 (99.7768)
Epoch 289 running time:  0:00:32.842282
===> Building meters
DataParallel
4
Epoch: [290][641/32]	Time  5.875 ( 5.875)	Data  5.259 ( 5.259)	Loss 4.1271e+00 (4.1271e+00)	Clip_Loss 4.1271e+00 (4.1271e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.6927 (81.6927)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [290][661/32]	Time  0.624 ( 1.101)	Data  0.007 ( 0.495)	Loss 3.9818e+00 (4.1841e+00)	Clip_Loss 3.9818e+00 (4.1841e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 79.6224 (80.2696)	Acc@5 96.8750 (97.1726)	Acc@10 100.0000 (99.5536)
Epoch 290 running time:  0:00:33.546920
===> Building meters
DataParallel
4
Epoch: [291][673/32]	Time  6.102 ( 6.102)	Data  5.484 ( 5.484)	Loss 3.7216e+00 (3.7216e+00)	Clip_Loss 3.7216e+00 (3.7216e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.9531 (81.9531)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [291][693/32]	Time  0.633 ( 1.132)	Data  0.008 ( 0.526)	Loss 3.9277e+00 (4.1326e+00)	Clip_Loss 3.9277e+00 (4.1326e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.5625 (81.5748)	Acc@5 95.3125 (97.6190)	Acc@10 100.0000 (99.7024)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 291 running time:  0:01:18.107176
===> Building meters
DataParallel
4
Epoch: [292][705/32]	Time  7.033 ( 7.033)	Data  6.377 ( 6.377)	Loss 4.4020e+00 (4.4020e+00)	Clip_Loss 4.4020e+00 (4.4020e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.4297 (75.4297)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [292][725/32]	Time  0.614 ( 1.218)	Data  0.007 ( 0.608)	Loss 4.3976e+00 (4.1723e+00)	Clip_Loss 4.3976e+00 (4.1723e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.1086 (80.9009)	Acc@5 95.3125 (97.1726)	Acc@10 100.0000 (99.6280)
Epoch 292 running time:  0:00:36.941246
===> Building meters
DataParallel
4
Epoch: [293][737/32]	Time  6.087 ( 6.087)	Data  5.475 ( 5.475)	Loss 3.8514e+00 (3.8514e+00)	Clip_Loss 3.8514e+00 (3.8514e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.0365 (84.0365)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [293][757/32]	Time  0.615 ( 1.022)	Data  0.007 ( 0.413)	Loss 4.2897e+00 (4.1997e+00)	Clip_Loss 4.2897e+00 (4.1997e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.7760 (80.7351)	Acc@5 96.8750 (97.9911)	Acc@10 100.0000 (99.7768)
Epoch 293 running time:  0:00:30.540563
===> Building meters
DataParallel
4
Epoch: [294][769/32]	Time  5.918 ( 5.918)	Data  5.276 ( 5.276)	Loss 4.2046e+00 (4.2046e+00)	Clip_Loss 4.2046e+00 (4.2046e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.0535 (81.0535)	Acc@5 96.8750 (96.8750)	Acc@10 98.4375 (98.4375)
Epoch: [294][789/32]	Time  0.617 ( 1.084)	Data  0.007 ( 0.478)	Loss 3.6363e+00 (4.0764e+00)	Clip_Loss 3.6363e+00 (4.0764e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 86.7188 (81.8408)	Acc@5 98.4375 (97.0238)	Acc@10 100.0000 (99.2560)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 294 running time:  0:01:04.742376
===> Building meters
DataParallel
4
Epoch: [295][801/32]	Time  6.907 ( 6.907)	Data  6.261 ( 6.261)	Loss 4.1783e+00 (4.1783e+00)	Clip_Loss 4.1783e+00 (4.1783e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.6287 (80.6287)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [295][821/32]	Time  0.617 ( 1.168)	Data  0.007 ( 0.563)	Loss 4.7149e+00 (4.2267e+00)	Clip_Loss 4.7149e+00 (4.2267e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.4967 (80.9726)	Acc@5 96.8750 (97.3214)	Acc@10 100.0000 (99.7024)
Epoch 295 running time:  0:00:35.508350
===> Building meters
DataParallel
4
Epoch: [296][833/32]	Time  6.282 ( 6.282)	Data  5.654 ( 5.654)	Loss 3.6891e+00 (3.6891e+00)	Clip_Loss 3.6891e+00 (3.6891e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 87.3196 (87.3196)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [296][853/32]	Time  0.611 ( 1.018)	Data  0.007 ( 0.414)	Loss 3.9307e+00 (4.0470e+00)	Clip_Loss 3.9307e+00 (4.0470e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.9583 (82.4150)	Acc@5 100.0000 (97.7679)	Acc@10 100.0000 (99.4792)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 296 running time:  0:01:14.852576
===> Building meters
DataParallel
4
Epoch: [297][865/32]	Time  6.742 ( 6.742)	Data  6.125 ( 6.125)	Loss 4.7975e+00 (4.7975e+00)	Clip_Loss 4.7975e+00 (4.7975e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.2753 (75.2753)	Acc@5 95.3125 (95.3125)	Acc@10 100.0000 (100.0000)
Epoch: [297][885/32]	Time  0.611 ( 1.204)	Data  0.007 ( 0.591)	Loss 3.6239e+00 (4.0491e+00)	Clip_Loss 3.6239e+00 (4.0491e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 86.1607 (81.9640)	Acc@5 95.3125 (97.9167)	Acc@10 100.0000 (99.4048)
Epoch 297 running time:  0:00:36.706400
===> Building meters
DataParallel
4
Epoch: [298][897/32]	Time  5.537 ( 5.537)	Data  4.896 ( 4.896)	Loss 3.7198e+00 (3.7198e+00)	Clip_Loss 3.7198e+00 (3.7198e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.6589 (83.6589)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [298][917/32]	Time  0.590 ( 0.952)	Data  0.007 ( 0.344)	Loss 4.0543e+00 (4.1338e+00)	Clip_Loss 4.0543e+00 (4.1338e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 77.9167 (81.5859)	Acc@5 95.3125 (96.9494)	Acc@10 100.0000 (99.7768)
Epoch 298 running time:  0:00:28.782524
====> Test::::/datasets/aicitychallenge2023/val.json
====> Query /datasets/aicitychallenge2023/val.json load
Test Epoch: [299][162/163]	Time 110.671 (110.671)	Data  0.000 ( 0.000)	Clip Loss 4.1918e+00 (4.1918e+00)	MRR 46.9210 (46.9210)	Acc@1 32.0000 (32.0000)	Acc@5 69.0000 (69.0000)
Epoch 299 running time:  0:01:50.677036
Logs dir: logs/dual_baseline_aug1 
====> results in csv format: 
| Method             | Dataset                                | Epoch   | Loss   | MRR    | Acc-5   | Acc-10   |
|:-------------------|:---------------------------------------|:--------|:-------|:-------|:--------|:---------|
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 19      | 4.418  | 18.029 | 6.000   | 29.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 39      | 4.318  | 25.640 | 12.000  | 39.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 59      | 4.308  | 26.601 | 10.000  | 45.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 79      | 4.256  | 32.901 | 16.000  | 53.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 99      | 4.248  | 35.485 | 19.000  | 54.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 119     | 4.278  | 36.260 | 19.000  | 60.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 139     | 4.258  | 34.736 | 18.000  | 56.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 159     | 4.232  | 35.243 | 21.000  | 51.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 179     | 4.187  | 43.807 | 26.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 199     | 4.184  | 45.585 | 27.000  | 71.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 219     | 4.183  | 41.780 | 22.000  | 67.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 239     | 4.190  | 44.424 | 26.000  | 68.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 259     | 4.200  | 44.491 | 27.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 279     | 4.198  | 44.826 | 30.000  | 61.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 299     | 4.192  | 46.921 | 32.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | Max_299 | 4.192  | 46.921 | 32.000  | 69.000   |
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best_eval.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best_eval.pth
===> Building meters
DataParallel
4
Epoch: [299][929/32]	Time  7.347 ( 7.347)	Data  6.752 ( 6.752)	Loss 4.4024e+00 (4.4024e+00)	Clip_Loss 4.4024e+00 (4.4024e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 77.5558 (77.5558)	Acc@5 89.0625 (89.0625)	Acc@10 100.0000 (100.0000)
Epoch: [299][949/32]	Time  0.610 ( 1.226)	Data  0.007 ( 0.618)	Loss 3.8657e+00 (4.0429e+00)	Clip_Loss 3.8657e+00 (4.0429e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.7396 (82.0647)	Acc@5 100.0000 (97.5446)	Acc@10 100.0000 (99.8512)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 299 running time:  0:01:38.789769
===> Building meters
DataParallel
4
Epoch: [300][ 1/32]	Time  7.216 ( 7.216)	Data  6.566 ( 6.566)	Loss 4.2792e+00 (4.2792e+00)	Clip_Loss 4.2792e+00 (4.2792e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.1104 (80.1104)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [300][21/32]	Time  0.613 ( 1.222)	Data  0.007 ( 0.619)	Loss 4.0841e+00 (4.1184e+00)	Clip_Loss 4.0841e+00 (4.1184e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 79.1406 (81.4489)	Acc@5 100.0000 (97.7679)	Acc@10 100.0000 (99.5536)
Epoch 300 running time:  0:00:36.907793
===> Building meters
DataParallel
4
Epoch: [301][33/32]	Time  5.596 ( 5.596)	Data  4.960 ( 4.960)	Loss 4.3348e+00 (4.3348e+00)	Clip_Loss 4.3348e+00 (4.3348e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 77.9688 (77.9688)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [301][53/32]	Time  0.616 ( 0.970)	Data  0.007 ( 0.362)	Loss 4.2584e+00 (4.0374e+00)	Clip_Loss 4.2584e+00 (4.0374e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.6399 (82.0680)	Acc@5 96.8750 (97.8423)	Acc@10 100.0000 (99.7768)
Epoch 301 running time:  0:00:29.884529
===> Building meters
DataParallel
4
Epoch: [302][65/32]	Time  5.819 ( 5.819)	Data  5.179 ( 5.179)	Loss 3.7496e+00 (3.7496e+00)	Clip_Loss 3.7496e+00 (3.7496e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.0227 (83.0227)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [302][85/32]	Time  0.594 ( 1.064)	Data  0.007 ( 0.461)	Loss 4.1607e+00 (4.1256e+00)	Clip_Loss 4.1607e+00 (4.1256e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.7875 (81.3764)	Acc@5 96.8750 (97.3214)	Acc@10 100.0000 (99.8512)
Epoch 302 running time:  0:00:33.812533
===> Building meters
DataParallel
4
Epoch: [303][97/32]	Time  6.428 ( 6.428)	Data  5.789 ( 5.789)	Loss 4.7056e+00 (4.7056e+00)	Clip_Loss 4.7056e+00 (4.7056e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 76.3765 (76.3765)	Acc@5 95.3125 (95.3125)	Acc@10 96.8750 (96.8750)
Epoch: [303][117/32]	Time  0.613 ( 1.071)	Data  0.007 ( 0.468)	Loss 4.1100e+00 (4.0955e+00)	Clip_Loss 4.1100e+00 (4.0955e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 77.8385 (81.6276)	Acc@5 100.0000 (98.2143)	Acc@10 100.0000 (99.3304)
Epoch 303 running time:  0:00:32.593776
===> Building meters
DataParallel
4
Epoch: [304][129/32]	Time  5.561 ( 5.561)	Data  4.932 ( 4.932)	Loss 4.6797e+00 (4.6797e+00)	Clip_Loss 4.6797e+00 (4.6797e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.9635 (75.9635)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [304][149/32]	Time  0.648 ( 1.068)	Data  0.007 ( 0.456)	Loss 4.0466e+00 (4.2381e+00)	Clip_Loss 4.0466e+00 (4.2381e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 85.6641 (81.1040)	Acc@5 96.8750 (97.9167)	Acc@10 100.0000 (99.9256)
Epoch 304 running time:  0:00:32.762615
===> Building meters
DataParallel
4
Epoch: [305][161/32]	Time  5.895 ( 5.895)	Data  5.240 ( 5.240)	Loss 3.8969e+00 (3.8969e+00)	Clip_Loss 3.8969e+00 (3.8969e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.6849 (78.6849)	Acc@5 95.3125 (95.3125)	Acc@10 100.0000 (100.0000)
Epoch: [305][181/32]	Time  0.667 ( 1.040)	Data  0.062 ( 0.428)	Loss 3.9463e+00 (4.1002e+00)	Clip_Loss 3.9463e+00 (4.1002e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 85.4427 (81.9096)	Acc@5 100.0000 (97.7679)	Acc@10 100.0000 (99.7024)
Epoch 305 running time:  0:00:32.372135
===> Building meters
DataParallel
4
Epoch: [306][193/32]	Time  6.021 ( 6.021)	Data  5.370 ( 5.370)	Loss 4.5525e+00 (4.5525e+00)	Clip_Loss 4.5525e+00 (4.5525e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 82.1354 (82.1354)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [306][213/32]	Time  0.623 ( 1.047)	Data  0.007 ( 0.432)	Loss 4.5118e+00 (4.1146e+00)	Clip_Loss 4.5118e+00 (4.1146e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 77.5694 (82.1153)	Acc@5 95.3125 (97.9911)	Acc@10 100.0000 (99.7768)
Epoch 306 running time:  0:00:31.705609
===> Building meters
DataParallel
4
Epoch: [307][225/32]	Time  6.178 ( 6.178)	Data  5.535 ( 5.535)	Loss 4.0118e+00 (4.0118e+00)	Clip_Loss 4.0118e+00 (4.0118e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.2083 (80.2083)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [307][245/32]	Time  0.624 ( 1.080)	Data  0.008 ( 0.464)	Loss 3.8305e+00 (4.0880e+00)	Clip_Loss 3.8305e+00 (4.0880e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.1146 (81.3567)	Acc@5 98.4375 (97.2470)	Acc@10 100.0000 (99.4792)
Epoch 307 running time:  0:00:33.714441
===> Building meters
DataParallel
4
Epoch: [308][257/32]	Time  5.948 ( 5.948)	Data  5.334 ( 5.334)	Loss 3.6266e+00 (3.6266e+00)	Clip_Loss 3.6266e+00 (3.6266e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 88.8542 (88.8542)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [308][277/32]	Time  0.593 ( 1.086)	Data  0.007 ( 0.480)	Loss 4.1702e+00 (4.0429e+00)	Clip_Loss 4.1702e+00 (4.0429e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.4288 (81.8557)	Acc@5 96.8750 (97.9911)	Acc@10 100.0000 (99.7768)
Epoch 308 running time:  0:00:32.883706
===> Building meters
DataParallel
4
Epoch: [309][289/32]	Time  5.744 ( 5.744)	Data  5.122 ( 5.122)	Loss 3.9211e+00 (3.9211e+00)	Clip_Loss 3.9211e+00 (3.9211e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.2500 (81.2500)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [309][309/32]	Time  0.588 ( 1.074)	Data  0.007 ( 0.469)	Loss 4.7877e+00 (4.1612e+00)	Clip_Loss 4.7877e+00 (4.1612e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.7500 (80.6429)	Acc@5 93.7500 (97.7679)	Acc@10 100.0000 (99.7024)
Epoch 309 running time:  0:00:32.332629
===> Building meters
DataParallel
4
Epoch: [310][321/32]	Time  6.044 ( 6.044)	Data  5.421 ( 5.421)	Loss 3.9175e+00 (3.9175e+00)	Clip_Loss 3.9175e+00 (3.9175e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.9107 (84.9107)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [310][341/32]	Time  0.616 ( 1.071)	Data  0.007 ( 0.463)	Loss 4.9254e+00 (4.1560e+00)	Clip_Loss 4.9254e+00 (4.1560e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 72.0740 (81.4471)	Acc@5 93.7500 (97.3958)	Acc@10 100.0000 (99.8512)
Epoch 310 running time:  0:00:32.381743
===> Building meters
DataParallel
4
Epoch: [311][353/32]	Time  6.355 ( 6.355)	Data  5.701 ( 5.701)	Loss 3.8180e+00 (3.8180e+00)	Clip_Loss 3.8180e+00 (3.8180e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.1719 (81.1719)	Acc@5 95.3125 (95.3125)	Acc@10 100.0000 (100.0000)
Epoch: [311][373/32]	Time  0.616 ( 1.084)	Data  0.009 ( 0.474)	Loss 4.3439e+00 (4.1005e+00)	Clip_Loss 4.3439e+00 (4.1005e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 77.5911 (81.8063)	Acc@5 96.8750 (97.6190)	Acc@10 100.0000 (99.4048)
Epoch 311 running time:  0:00:32.803360
===> Building meters
DataParallel
4
Epoch: [312][385/32]	Time  5.899 ( 5.899)	Data  5.254 ( 5.254)	Loss 4.1862e+00 (4.1862e+00)	Clip_Loss 4.1862e+00 (4.1862e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.1250 (78.1250)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [312][405/32]	Time  0.591 ( 1.062)	Data  0.007 ( 0.457)	Loss 4.6577e+00 (4.2865e+00)	Clip_Loss 4.6577e+00 (4.2865e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 79.6212 (81.3668)	Acc@5 98.4375 (97.9911)	Acc@10 98.4375 (99.7768)
Epoch 312 running time:  0:00:32.647269
===> Building meters
DataParallel
4
Epoch: [313][417/32]	Time  6.103 ( 6.103)	Data  5.459 ( 5.459)	Loss 4.5870e+00 (4.5870e+00)	Clip_Loss 4.5870e+00 (4.5870e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.9714 (78.9714)	Acc@5 95.3125 (95.3125)	Acc@10 100.0000 (100.0000)
Epoch: [313][437/32]	Time  0.612 ( 1.072)	Data  0.007 ( 0.469)	Loss 4.9199e+00 (4.1075e+00)	Clip_Loss 4.9199e+00 (4.1075e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.1562 (81.2205)	Acc@5 100.0000 (97.8423)	Acc@10 100.0000 (99.6280)
Epoch 313 running time:  0:00:32.871490
===> Building meters
DataParallel
4
Epoch: [314][449/32]	Time  6.077 ( 6.077)	Data  5.435 ( 5.435)	Loss 3.7386e+00 (3.7386e+00)	Clip_Loss 3.7386e+00 (3.7386e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 86.6406 (86.6406)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [314][469/32]	Time  0.624 ( 1.063)	Data  0.007 ( 0.462)	Loss 3.8587e+00 (4.1269e+00)	Clip_Loss 3.8587e+00 (4.1269e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 85.4688 (81.2352)	Acc@5 100.0000 (97.2470)	Acc@10 100.0000 (99.4048)
Epoch 314 running time:  0:00:33.607206
===> Building meters
DataParallel
4
Epoch: [315][481/32]	Time  6.080 ( 6.080)	Data  5.465 ( 5.465)	Loss 3.2631e+00 (3.2631e+00)	Clip_Loss 3.2631e+00 (3.2631e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 87.9427 (87.9427)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [315][501/32]	Time  0.587 ( 1.077)	Data  0.007 ( 0.470)	Loss 3.7551e+00 (3.9963e+00)	Clip_Loss 3.7551e+00 (3.9963e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 82.1689 (82.6733)	Acc@5 95.3125 (97.3958)	Acc@10 98.4375 (99.4792)
Epoch 315 running time:  0:00:33.288870
===> Building meters
DataParallel
4
Epoch: [316][513/32]	Time  6.262 ( 6.262)	Data  5.625 ( 5.625)	Loss 4.6205e+00 (4.6205e+00)	Clip_Loss 4.6205e+00 (4.6205e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.9844 (78.9844)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [316][533/32]	Time  0.592 ( 1.085)	Data  0.007 ( 0.476)	Loss 4.4458e+00 (4.1443e+00)	Clip_Loss 4.4458e+00 (4.1443e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 76.8663 (81.5751)	Acc@5 98.4375 (97.6190)	Acc@10 100.0000 (99.7768)
Epoch 316 running time:  0:00:32.893207
===> Building meters
DataParallel
4
Epoch: [317][545/32]	Time  5.913 ( 5.913)	Data  5.268 ( 5.268)	Loss 5.1253e+00 (5.1253e+00)	Clip_Loss 5.1253e+00 (5.1253e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 76.1892 (76.1892)	Acc@5 90.6250 (90.6250)	Acc@10 100.0000 (100.0000)
Epoch: [317][565/32]	Time  0.650 ( 1.258)	Data  0.008 ( 0.646)	Loss 4.0361e+00 (4.1783e+00)	Clip_Loss 4.0361e+00 (4.1783e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.7656 (81.0180)	Acc@5 100.0000 (97.9167)	Acc@10 100.0000 (99.8512)
Epoch 317 running time:  0:00:37.669509
===> Building meters
DataParallel
4
Epoch: [318][577/32]	Time  6.239 ( 6.239)	Data  5.604 ( 5.604)	Loss 4.3453e+00 (4.3453e+00)	Clip_Loss 4.3453e+00 (4.3453e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.8377 (75.8377)	Acc@5 95.3125 (95.3125)	Acc@10 100.0000 (100.0000)
Epoch: [318][597/32]	Time  0.608 ( 1.069)	Data  0.007 ( 0.465)	Loss 3.6814e+00 (3.9861e+00)	Clip_Loss 3.6814e+00 (3.9861e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.6328 (82.5769)	Acc@5 98.4375 (97.7679)	Acc@10 100.0000 (99.7768)
Epoch 318 running time:  0:00:32.385758
====> Test::::/datasets/aicitychallenge2023/val.json
====> Query /datasets/aicitychallenge2023/val.json load
Test Epoch: [319][162/163]	Time 109.039 (109.039)	Data  0.000 ( 0.000)	Clip Loss 4.1920e+00 (4.1920e+00)	MRR 45.9666 (45.9666)	Acc@1 29.0000 (29.0000)	Acc@5 70.0000 (70.0000)
Epoch 319 running time:  0:01:49.045772
Logs dir: logs/dual_baseline_aug1 
====> results in csv format: 
| Method             | Dataset                                | Epoch   | Loss   | MRR    | Acc-5   | Acc-10   |
|:-------------------|:---------------------------------------|:--------|:-------|:-------|:--------|:---------|
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 19      | 4.418  | 18.029 | 6.000   | 29.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 39      | 4.318  | 25.640 | 12.000  | 39.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 59      | 4.308  | 26.601 | 10.000  | 45.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 79      | 4.256  | 32.901 | 16.000  | 53.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 99      | 4.248  | 35.485 | 19.000  | 54.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 119     | 4.278  | 36.260 | 19.000  | 60.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 139     | 4.258  | 34.736 | 18.000  | 56.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 159     | 4.232  | 35.243 | 21.000  | 51.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 179     | 4.187  | 43.807 | 26.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 199     | 4.184  | 45.585 | 27.000  | 71.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 219     | 4.183  | 41.780 | 22.000  | 67.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 239     | 4.190  | 44.424 | 26.000  | 68.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 259     | 4.200  | 44.491 | 27.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 279     | 4.198  | 44.826 | 30.000  | 61.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 299     | 4.192  | 46.921 | 32.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 319     | 4.192  | 45.967 | 29.000  | 70.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | Max_299 | 4.192  | 46.921 | 32.000  | 69.000   |
===> Building meters
DataParallel
4
Epoch: [319][609/32]	Time  7.175 ( 7.175)	Data  6.557 ( 6.557)	Loss 3.9006e+00 (3.9006e+00)	Clip_Loss 3.9006e+00 (3.9006e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 85.3385 (85.3385)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [319][629/32]	Time  0.591 ( 1.213)	Data  0.007 ( 0.608)	Loss 3.8287e+00 (3.9950e+00)	Clip_Loss 3.8287e+00 (3.9950e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 86.0937 (82.3638)	Acc@5 96.8750 (97.3958)	Acc@10 100.0000 (99.4792)
Epoch 319 running time:  0:00:37.143621
===> Building meters
DataParallel
4
Epoch: [320][641/32]	Time  5.764 ( 5.764)	Data  5.171 ( 5.171)	Loss 4.2924e+00 (4.2924e+00)	Clip_Loss 4.2924e+00 (4.2924e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 82.9055 (82.9055)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [320][661/32]	Time  0.592 ( 0.987)	Data  0.007 ( 0.375)	Loss 3.8710e+00 (4.1003e+00)	Clip_Loss 3.8710e+00 (4.1003e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 82.0833 (81.2667)	Acc@5 98.4375 (97.5446)	Acc@10 98.4375 (99.4048)
Epoch 320 running time:  0:00:29.850266
===> Building meters
DataParallel
4
Epoch: [321][673/32]	Time  6.312 ( 6.312)	Data  5.697 ( 5.697)	Loss 4.7724e+00 (4.7724e+00)	Clip_Loss 4.7724e+00 (4.7724e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 72.5192 (72.5192)	Acc@5 93.7500 (93.7500)	Acc@10 100.0000 (100.0000)
Epoch: [321][693/32]	Time  0.678 ( 1.109)	Data  0.007 ( 0.498)	Loss 5.0403e+00 (4.2834e+00)	Clip_Loss 5.0403e+00 (4.2834e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 70.6312 (79.2470)	Acc@5 95.3125 (97.0982)	Acc@10 100.0000 (99.6280)
Epoch 321 running time:  0:00:34.306152
===> Building meters
DataParallel
4
Epoch: [322][705/32]	Time  6.418 ( 6.418)	Data  5.772 ( 5.772)	Loss 4.3459e+00 (4.3459e+00)	Clip_Loss 4.3459e+00 (4.3459e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 82.8559 (82.8559)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [322][725/32]	Time  0.611 ( 1.057)	Data  0.007 ( 0.452)	Loss 4.0000e+00 (4.1928e+00)	Clip_Loss 4.0000e+00 (4.1928e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.7336 (81.4784)	Acc@5 95.3125 (97.6190)	Acc@10 100.0000 (99.7768)
Epoch 322 running time:  0:00:31.891746
===> Building meters
DataParallel
4
Epoch: [323][737/32]	Time  5.814 ( 5.814)	Data  5.146 ( 5.146)	Loss 4.3000e+00 (4.3000e+00)	Clip_Loss 4.3000e+00 (4.3000e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.9844 (83.9844)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [323][757/32]	Time  0.615 ( 1.018)	Data  0.007 ( 0.413)	Loss 4.0240e+00 (3.9814e+00)	Clip_Loss 4.0240e+00 (3.9814e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 79.1816 (82.3419)	Acc@5 98.4375 (97.7679)	Acc@10 100.0000 (99.6280)
Epoch 323 running time:  0:00:32.111647
===> Building meters
DataParallel
4
Epoch: [324][769/32]	Time  5.970 ( 5.970)	Data  5.377 ( 5.377)	Loss 4.9638e+00 (4.9638e+00)	Clip_Loss 4.9638e+00 (4.9638e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.7082 (80.7082)	Acc@5 95.3125 (95.3125)	Acc@10 98.4375 (98.4375)
Epoch: [324][789/32]	Time  0.618 ( 1.075)	Data  0.007 ( 0.465)	Loss 4.0120e+00 (4.0485e+00)	Clip_Loss 4.0120e+00 (4.0485e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.6667 (81.8789)	Acc@5 98.4375 (97.4702)	Acc@10 100.0000 (99.5536)
Epoch 324 running time:  0:00:32.788258
===> Building meters
DataParallel
4
Epoch: [325][801/32]	Time  6.113 ( 6.113)	Data  5.469 ( 5.469)	Loss 4.1411e+00 (4.1411e+00)	Clip_Loss 4.1411e+00 (4.1411e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.4141 (84.4141)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [325][821/32]	Time  0.627 ( 1.097)	Data  0.007 ( 0.487)	Loss 4.7364e+00 (4.1263e+00)	Clip_Loss 4.7364e+00 (4.1263e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.2856 (81.1354)	Acc@5 93.7500 (97.4702)	Acc@10 100.0000 (99.6280)
Epoch 325 running time:  0:00:33.409012
===> Building meters
DataParallel
4
Epoch: [326][833/32]	Time  6.908 ( 6.908)	Data  6.284 ( 6.284)	Loss 4.0872e+00 (4.0872e+00)	Clip_Loss 4.0872e+00 (4.0872e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.8408 (80.8408)	Acc@5 98.4375 (98.4375)	Acc@10 98.4375 (98.4375)
Epoch: [326][853/32]	Time  0.626 ( 1.213)	Data  0.007 ( 0.607)	Loss 5.0014e+00 (4.1477e+00)	Clip_Loss 5.0014e+00 (4.1477e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 71.9922 (80.8519)	Acc@5 96.8750 (97.3958)	Acc@10 100.0000 (99.6280)
Epoch 326 running time:  0:00:35.209947
===> Building meters
DataParallel
4
Epoch: [327][865/32]	Time  5.777 ( 5.777)	Data  5.155 ( 5.155)	Loss 3.9549e+00 (3.9549e+00)	Clip_Loss 3.9549e+00 (3.9549e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.2031 (83.2031)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [327][885/32]	Time  0.626 ( 1.025)	Data  0.007 ( 0.422)	Loss 3.9171e+00 (4.2149e+00)	Clip_Loss 3.9171e+00 (4.2149e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 86.0677 (80.3889)	Acc@5 100.0000 (97.3958)	Acc@10 100.0000 (99.8512)
Epoch 327 running time:  0:00:32.201056
===> Building meters
DataParallel
4
Epoch: [328][897/32]	Time  6.206 ( 6.206)	Data  5.588 ( 5.588)	Loss 3.6032e+00 (3.6032e+00)	Clip_Loss 3.6032e+00 (3.6032e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.3403 (84.3403)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [328][917/32]	Time  0.589 ( 1.124)	Data  0.007 ( 0.523)	Loss 3.5854e+00 (3.9468e+00)	Clip_Loss 3.5854e+00 (3.9468e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 85.5729 (82.9753)	Acc@5 100.0000 (97.8423)	Acc@10 100.0000 (99.7768)
Epoch 328 running time:  0:00:33.943415
===> Building meters
DataParallel
4
Epoch: [329][929/32]	Time  6.388 ( 6.388)	Data  5.775 ( 5.775)	Loss 4.4931e+00 (4.4931e+00)	Clip_Loss 4.4931e+00 (4.4931e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 74.8958 (74.8958)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [329][949/32]	Time  0.611 ( 1.116)	Data  0.007 ( 0.512)	Loss 3.7357e+00 (3.9639e+00)	Clip_Loss 3.7357e+00 (3.9639e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 87.2917 (82.9089)	Acc@5 98.4375 (97.9911)	Acc@10 100.0000 (99.7768)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 329 running time:  0:01:11.007592
===> Building meters
DataParallel
4
Epoch: [330][ 1/32]	Time  7.082 ( 7.082)	Data  6.485 ( 6.485)	Loss 3.5136e+00 (3.5136e+00)	Clip_Loss 3.5136e+00 (3.5136e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 85.1562 (85.1562)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [330][21/32]	Time  0.590 ( 1.243)	Data  0.007 ( 0.643)	Loss 3.9756e+00 (4.0612e+00)	Clip_Loss 3.9756e+00 (4.0612e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.4757 (82.5822)	Acc@5 96.8750 (97.3958)	Acc@10 100.0000 (99.7024)
Epoch 330 running time:  0:00:37.327322
===> Building meters
DataParallel
4
Epoch: [331][33/32]	Time  6.011 ( 6.011)	Data  5.356 ( 5.356)	Loss 4.2541e+00 (4.2541e+00)	Clip_Loss 4.2541e+00 (4.2541e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.9714 (78.9714)	Acc@5 95.3125 (95.3125)	Acc@10 100.0000 (100.0000)
Epoch: [331][53/32]	Time  0.624 ( 1.014)	Data  0.007 ( 0.410)	Loss 3.8358e+00 (3.9489e+00)	Clip_Loss 3.8358e+00 (3.9489e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.1198 (83.5421)	Acc@5 100.0000 (97.7679)	Acc@10 100.0000 (99.7768)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 331 running time:  0:00:54.126834
===> Building meters
DataParallel
4
Epoch: [332][65/32]	Time  6.990 ( 6.990)	Data  6.400 ( 6.400)	Loss 4.6452e+00 (4.6452e+00)	Clip_Loss 4.6452e+00 (4.6452e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.4607 (75.4607)	Acc@5 93.7500 (93.7500)	Acc@10 98.4375 (98.4375)
Epoch: [332][85/32]	Time  0.595 ( 1.216)	Data  0.009 ( 0.613)	Loss 3.8634e+00 (4.1119e+00)	Clip_Loss 3.8634e+00 (4.1119e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.9628 (82.0821)	Acc@5 98.4375 (97.5446)	Acc@10 100.0000 (99.6280)
Epoch 332 running time:  0:00:37.455209
===> Building meters
DataParallel
4
Epoch: [333][97/32]	Time  5.810 ( 5.810)	Data  5.137 ( 5.137)	Loss 3.8584e+00 (3.8584e+00)	Clip_Loss 3.8584e+00 (3.8584e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.2597 (84.2597)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [333][117/32]	Time  0.593 ( 0.978)	Data  0.007 ( 0.373)	Loss 4.1912e+00 (3.9581e+00)	Clip_Loss 4.1912e+00 (3.9581e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.3507 (82.2621)	Acc@5 98.4375 (98.0655)	Acc@10 100.0000 (99.8512)
Epoch 333 running time:  0:00:29.381448
===> Building meters
DataParallel
4
Epoch: [334][129/32]	Time  5.890 ( 5.890)	Data  5.274 ( 5.274)	Loss 3.5970e+00 (3.5970e+00)	Clip_Loss 3.5970e+00 (3.5970e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 85.4096 (85.4096)	Acc@5 98.4375 (98.4375)	Acc@10 98.4375 (98.4375)
Epoch: [334][149/32]	Time  0.611 ( 1.039)	Data  0.007 ( 0.433)	Loss 4.4635e+00 (4.0053e+00)	Clip_Loss 4.4635e+00 (4.0053e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 79.3576 (82.6727)	Acc@5 96.8750 (98.0655)	Acc@10 98.4375 (99.6280)
Epoch 334 running time:  0:00:32.683192
===> Building meters
DataParallel
4
Epoch: [335][161/32]	Time  5.674 ( 5.674)	Data  5.012 ( 5.012)	Loss 4.7794e+00 (4.7794e+00)	Clip_Loss 4.7794e+00 (4.7794e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 76.6567 (76.6567)	Acc@5 96.8750 (96.8750)	Acc@10 98.4375 (98.4375)
Epoch: [335][181/32]	Time  0.592 ( 1.034)	Data  0.007 ( 0.428)	Loss 3.7595e+00 (4.0177e+00)	Clip_Loss 3.7595e+00 (4.0177e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.2969 (82.0945)	Acc@5 98.4375 (97.9167)	Acc@10 100.0000 (99.5536)
Epoch 335 running time:  0:00:31.785521
===> Building meters
DataParallel
4
Epoch: [336][193/32]	Time  5.728 ( 5.728)	Data  5.094 ( 5.094)	Loss 4.0467e+00 (4.0467e+00)	Clip_Loss 4.0467e+00 (4.0467e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 77.2396 (77.2396)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [336][213/32]	Time  0.620 ( 1.026)	Data  0.007 ( 0.426)	Loss 3.5981e+00 (4.0122e+00)	Clip_Loss 3.5981e+00 (4.0122e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.4688 (82.2437)	Acc@5 100.0000 (98.3631)	Acc@10 100.0000 (99.4792)
Epoch 336 running time:  0:00:31.440828
===> Building meters
DataParallel
4
Epoch: [337][225/32]	Time  6.122 ( 6.122)	Data  5.506 ( 5.506)	Loss 3.5145e+00 (3.5145e+00)	Clip_Loss 3.5145e+00 (3.5145e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 87.5000 (87.5000)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [337][245/32]	Time  0.624 ( 1.057)	Data  0.007 ( 0.445)	Loss 3.5121e+00 (3.9767e+00)	Clip_Loss 3.5121e+00 (3.9767e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.7292 (81.9617)	Acc@5 98.4375 (97.9167)	Acc@10 100.0000 (99.7768)
Epoch 337 running time:  0:00:32.768764
===> Building meters
DataParallel
4
Epoch: [338][257/32]	Time  5.743 ( 5.743)	Data  5.105 ( 5.105)	Loss 3.5119e+00 (3.5119e+00)	Clip_Loss 3.5119e+00 (3.5119e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 82.5521 (82.5521)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [338][277/32]	Time  0.628 ( 1.028)	Data  0.007 ( 0.420)	Loss 4.0464e+00 (4.0466e+00)	Clip_Loss 4.0464e+00 (4.0466e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.5990 (81.4478)	Acc@5 96.8750 (97.6935)	Acc@10 100.0000 (99.6280)
Epoch 338 running time:  0:00:31.931590
====> Test::::/datasets/aicitychallenge2023/val.json
====> Query /datasets/aicitychallenge2023/val.json load
Test Epoch: [339][162/163]	Time 110.519 (110.519)	Data  0.000 ( 0.000)	Clip Loss 4.1918e+00 (4.1918e+00)	MRR 45.7167 (45.7167)	Acc@1 29.0000 (29.0000)	Acc@5 66.0000 (66.0000)
Epoch 339 running time:  0:01:50.524033
Logs dir: logs/dual_baseline_aug1 
====> results in csv format: 
| Method             | Dataset                                | Epoch   | Loss   | MRR    | Acc-5   | Acc-10   |
|:-------------------|:---------------------------------------|:--------|:-------|:-------|:--------|:---------|
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 19      | 4.418  | 18.029 | 6.000   | 29.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 39      | 4.318  | 25.640 | 12.000  | 39.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 59      | 4.308  | 26.601 | 10.000  | 45.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 79      | 4.256  | 32.901 | 16.000  | 53.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 99      | 4.248  | 35.485 | 19.000  | 54.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 119     | 4.278  | 36.260 | 19.000  | 60.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 139     | 4.258  | 34.736 | 18.000  | 56.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 159     | 4.232  | 35.243 | 21.000  | 51.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 179     | 4.187  | 43.807 | 26.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 199     | 4.184  | 45.585 | 27.000  | 71.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 219     | 4.183  | 41.780 | 22.000  | 67.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 239     | 4.190  | 44.424 | 26.000  | 68.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 259     | 4.200  | 44.491 | 27.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 279     | 4.198  | 44.826 | 30.000  | 61.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 299     | 4.192  | 46.921 | 32.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 319     | 4.192  | 45.967 | 29.000  | 70.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 339     | 4.192  | 45.717 | 29.000  | 66.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | Max_299 | 4.192  | 46.921 | 32.000  | 69.000   |
===> Building meters
DataParallel
4
Epoch: [339][289/32]	Time  7.175 ( 7.175)	Data  6.509 ( 6.509)	Loss 3.9234e+00 (3.9234e+00)	Clip_Loss 3.9234e+00 (3.9234e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.2604 (80.2604)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [339][309/32]	Time  0.610 ( 1.213)	Data  0.006 ( 0.600)	Loss 3.4388e+00 (4.0026e+00)	Clip_Loss 3.4388e+00 (4.0026e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 85.9896 (82.3280)	Acc@5 100.0000 (98.0655)	Acc@10 100.0000 (99.6280)
Epoch 339 running time:  0:00:37.060571
===> Building meters
DataParallel
4
Epoch: [340][321/32]	Time  5.869 ( 5.869)	Data  5.253 ( 5.253)	Loss 3.8268e+00 (3.8268e+00)	Clip_Loss 3.8268e+00 (3.8268e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 82.9427 (82.9427)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [340][341/32]	Time  0.591 ( 0.969)	Data  0.007 ( 0.368)	Loss 3.8842e+00 (4.1125e+00)	Clip_Loss 3.8842e+00 (4.1125e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 86.0677 (81.4625)	Acc@5 100.0000 (97.6935)	Acc@10 100.0000 (99.7024)
Epoch 340 running time:  0:00:29.148378
===> Building meters
DataParallel
4
Epoch: [341][353/32]	Time  6.269 ( 6.269)	Data  5.678 ( 5.678)	Loss 3.5786e+00 (3.5786e+00)	Clip_Loss 3.5786e+00 (3.5786e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 87.2917 (87.2917)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [341][373/32]	Time  0.611 ( 1.117)	Data  0.007 ( 0.512)	Loss 4.0517e+00 (3.9424e+00)	Clip_Loss 4.0517e+00 (3.9424e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.8216 (83.4279)	Acc@5 96.8750 (97.5446)	Acc@10 98.4375 (99.7024)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 341 running time:  0:01:03.141186
===> Building meters
DataParallel
4
Epoch: [342][385/32]	Time  6.771 ( 6.771)	Data  6.172 ( 6.172)	Loss 3.8106e+00 (3.8106e+00)	Clip_Loss 3.8106e+00 (3.8106e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 86.0677 (86.0677)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [342][405/32]	Time  0.625 ( 1.119)	Data  0.007 ( 0.513)	Loss 3.7645e+00 (4.1056e+00)	Clip_Loss 3.7645e+00 (4.1056e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 79.7154 (81.6237)	Acc@5 95.3125 (97.7679)	Acc@10 100.0000 (99.7024)
Epoch 342 running time:  0:00:34.780928
===> Building meters
DataParallel
4
Epoch: [343][417/32]	Time  5.858 ( 5.858)	Data  5.230 ( 5.230)	Loss 4.1992e+00 (4.1992e+00)	Clip_Loss 4.1992e+00 (4.1992e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 79.0885 (79.0885)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [343][437/32]	Time  0.591 ( 1.043)	Data  0.007 ( 0.435)	Loss 4.5467e+00 (4.1874e+00)	Clip_Loss 4.5467e+00 (4.1874e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 79.4191 (81.7897)	Acc@5 95.3125 (97.8423)	Acc@10 98.4375 (99.6280)
Epoch 343 running time:  0:00:32.019955
===> Building meters
DataParallel
4
Epoch: [344][449/32]	Time  5.943 ( 5.943)	Data  5.319 ( 5.319)	Loss 4.4645e+00 (4.4645e+00)	Clip_Loss 4.4645e+00 (4.4645e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.9239 (75.9239)	Acc@5 92.1875 (92.1875)	Acc@10 100.0000 (100.0000)
Epoch: [344][469/32]	Time  0.620 ( 1.027)	Data  0.008 ( 0.416)	Loss 4.2768e+00 (4.0855e+00)	Clip_Loss 4.2768e+00 (4.0855e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.1347 (82.0447)	Acc@5 96.8750 (98.0655)	Acc@10 100.0000 (100.0000)
Epoch 344 running time:  0:00:31.903162
===> Building meters
DataParallel
4
Epoch: [345][481/32]	Time  6.236 ( 6.236)	Data  5.611 ( 5.611)	Loss 3.7431e+00 (3.7431e+00)	Clip_Loss 3.7431e+00 (3.7431e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 82.8125 (82.8125)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [345][501/32]	Time  0.636 ( 1.073)	Data  0.007 ( 0.467)	Loss 4.0633e+00 (4.0522e+00)	Clip_Loss 4.0633e+00 (4.0522e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 77.5911 (81.5638)	Acc@5 95.3125 (98.1399)	Acc@10 98.4375 (99.7768)
Epoch 345 running time:  0:00:32.738593
===> Building meters
DataParallel
4
Epoch: [346][513/32]	Time  6.010 ( 6.010)	Data  5.372 ( 5.372)	Loss 3.8508e+00 (3.8508e+00)	Clip_Loss 3.8508e+00 (3.8508e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 85.9245 (85.9245)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [346][533/32]	Time  0.620 ( 1.027)	Data  0.007 ( 0.426)	Loss 3.7400e+00 (4.0258e+00)	Clip_Loss 3.7400e+00 (4.0258e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 82.2135 (81.0275)	Acc@5 100.0000 (98.5863)	Acc@10 100.0000 (99.7768)
Epoch 346 running time:  0:00:31.401082
===> Building meters
DataParallel
4
Epoch: [347][545/32]	Time  6.077 ( 6.077)	Data  5.419 ( 5.419)	Loss 3.5763e+00 (3.5763e+00)	Clip_Loss 3.5763e+00 (3.5763e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 90.2344 (90.2344)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [347][565/32]	Time  0.613 ( 1.068)	Data  0.007 ( 0.461)	Loss 3.5471e+00 (4.1342e+00)	Clip_Loss 3.5471e+00 (4.1342e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 85.8594 (81.3021)	Acc@5 100.0000 (97.6935)	Acc@10 100.0000 (99.4792)
Epoch 347 running time:  0:00:32.988900
===> Building meters
DataParallel
4
Epoch: [348][577/32]	Time  5.625 ( 5.625)	Data  4.998 ( 4.998)	Loss 4.5921e+00 (4.5921e+00)	Clip_Loss 4.5921e+00 (4.5921e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 77.8318 (77.8318)	Acc@5 96.8750 (96.8750)	Acc@10 96.8750 (96.8750)
Epoch: [348][597/32]	Time  0.610 ( 1.034)	Data  0.007 ( 0.427)	Loss 3.5750e+00 (4.0627e+00)	Clip_Loss 3.5750e+00 (4.0627e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.5331 (82.3029)	Acc@5 96.8750 (97.3214)	Acc@10 100.0000 (99.4048)
Epoch 348 running time:  0:00:31.668375
===> Building meters
DataParallel
4
Epoch: [349][609/32]	Time  5.794 ( 5.794)	Data  5.146 ( 5.146)	Loss 3.6134e+00 (3.6134e+00)	Clip_Loss 3.6134e+00 (3.6134e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.9392 (84.9392)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [349][629/32]	Time  0.590 ( 1.052)	Data  0.007 ( 0.448)	Loss 3.7913e+00 (4.0524e+00)	Clip_Loss 3.7913e+00 (4.0524e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.6458 (82.5684)	Acc@5 98.4375 (97.7679)	Acc@10 98.4375 (99.4792)
Epoch 349 running time:  0:00:31.583574
===> Building meters
DataParallel
4
Epoch: [350][641/32]	Time  6.263 ( 6.263)	Data  5.625 ( 5.625)	Loss 3.9159e+00 (3.9159e+00)	Clip_Loss 3.9159e+00 (3.9159e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.3672 (81.3672)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [350][661/32]	Time  0.620 ( 1.102)	Data  0.007 ( 0.497)	Loss 3.6871e+00 (4.0285e+00)	Clip_Loss 3.6871e+00 (4.0285e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 85.2865 (83.1371)	Acc@5 100.0000 (98.2887)	Acc@10 100.0000 (99.7024)
Epoch 350 running time:  0:00:32.761961
===> Building meters
DataParallel
4
Epoch: [351][673/32]	Time  5.923 ( 5.923)	Data  5.306 ( 5.306)	Loss 3.8006e+00 (3.8006e+00)	Clip_Loss 3.8006e+00 (3.8006e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.2604 (80.2604)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [351][693/32]	Time  0.649 ( 1.061)	Data  0.007 ( 0.456)	Loss 4.3848e+00 (3.9950e+00)	Clip_Loss 4.3848e+00 (3.9950e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 76.6580 (82.9026)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (99.9256)
Epoch 351 running time:  0:00:32.413266
===> Building meters
DataParallel
4
Epoch: [352][705/32]	Time  5.669 ( 5.669)	Data  5.049 ( 5.049)	Loss 4.1719e+00 (4.1719e+00)	Clip_Loss 4.1719e+00 (4.1719e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.9063 (83.9063)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [352][725/32]	Time  0.623 ( 1.029)	Data  0.007 ( 0.418)	Loss 3.1220e+00 (4.0448e+00)	Clip_Loss 3.1220e+00 (4.0448e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 93.0990 (82.1241)	Acc@5 100.0000 (97.9911)	Acc@10 100.0000 (99.7768)
Epoch 352 running time:  0:00:31.854546
===> Building meters
DataParallel
4
Epoch: [353][737/32]	Time  5.923 ( 5.923)	Data  5.314 ( 5.314)	Loss 3.3819e+00 (3.3819e+00)	Clip_Loss 3.3819e+00 (3.3819e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 86.8490 (86.8490)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [353][757/32]	Time  0.609 ( 1.040)	Data  0.007 ( 0.434)	Loss 4.1470e+00 (3.9299e+00)	Clip_Loss 4.1470e+00 (3.9299e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 76.0975 (82.4785)	Acc@5 95.3125 (98.2143)	Acc@10 100.0000 (99.7768)
Epoch 353 running time:  0:00:31.790877
===> Building meters
DataParallel
4
Epoch: [354][769/32]	Time  6.223 ( 6.223)	Data  5.587 ( 5.587)	Loss 4.4590e+00 (4.4590e+00)	Clip_Loss 4.4590e+00 (4.4590e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.0924 (78.0924)	Acc@5 98.4375 (98.4375)	Acc@10 98.4375 (98.4375)
Epoch: [354][789/32]	Time  0.645 ( 1.062)	Data  0.007 ( 0.453)	Loss 3.8359e+00 (4.1131e+00)	Clip_Loss 3.8359e+00 (4.1131e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.2500 (83.0390)	Acc@5 100.0000 (97.6935)	Acc@10 100.0000 (99.5536)
Epoch 354 running time:  0:00:31.956563
===> Building meters
DataParallel
4
Epoch: [355][801/32]	Time  6.124 ( 6.124)	Data  5.475 ( 5.475)	Loss 4.2751e+00 (4.2751e+00)	Clip_Loss 4.2751e+00 (4.2751e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.9714 (83.9714)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [355][821/32]	Time  0.614 ( 1.066)	Data  0.007 ( 0.464)	Loss 3.6576e+00 (4.0060e+00)	Clip_Loss 3.6576e+00 (4.0060e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 86.7857 (82.2411)	Acc@5 98.4375 (97.9167)	Acc@10 100.0000 (99.7024)
Epoch 355 running time:  0:00:32.179537
===> Building meters
DataParallel
4
Epoch: [356][833/32]	Time  6.177 ( 6.177)	Data  5.566 ( 5.566)	Loss 4.4253e+00 (4.4253e+00)	Clip_Loss 4.4253e+00 (4.4253e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 76.2760 (76.2760)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [356][853/32]	Time  0.616 ( 1.063)	Data  0.008 ( 0.454)	Loss 4.3890e+00 (4.1040e+00)	Clip_Loss 4.3890e+00 (4.1040e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.5859 (81.3247)	Acc@5 96.8750 (97.7679)	Acc@10 98.4375 (99.7768)
Epoch 356 running time:  0:00:32.063207
===> Building meters
DataParallel
4
Epoch: [357][865/32]	Time  6.289 ( 6.289)	Data  5.645 ( 5.645)	Loss 3.4936e+00 (3.4936e+00)	Clip_Loss 3.4936e+00 (3.4936e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.3899 (84.3899)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [357][885/32]	Time  0.679 ( 1.092)	Data  0.007 ( 0.477)	Loss 4.4549e+00 (4.0913e+00)	Clip_Loss 4.4549e+00 (4.0913e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 76.8446 (81.4137)	Acc@5 95.3125 (97.0982)	Acc@10 100.0000 (99.7768)
Epoch 357 running time:  0:00:32.858622
===> Building meters
DataParallel
4
Epoch: [358][897/32]	Time  5.932 ( 5.932)	Data  5.294 ( 5.294)	Loss 3.8848e+00 (3.8848e+00)	Clip_Loss 3.8848e+00 (3.8848e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 82.8057 (82.8057)	Acc@5 96.8750 (96.8750)	Acc@10 96.8750 (96.8750)
Epoch: [358][917/32]	Time  0.623 ( 1.071)	Data  0.008 ( 0.462)	Loss 3.4703e+00 (4.0345e+00)	Clip_Loss 3.4703e+00 (4.0345e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 89.3229 (83.0210)	Acc@5 100.0000 (97.8423)	Acc@10 100.0000 (99.5536)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 358 running time:  0:00:58.015016
====> Test::::/datasets/aicitychallenge2023/val.json
====> Query /datasets/aicitychallenge2023/val.json load
Test Epoch: [359][162/163]	Time 112.271 (112.271)	Data  0.000 ( 0.000)	Clip Loss 4.1915e+00 (4.1915e+00)	MRR 44.5600 (44.5600)	Acc@1 26.0000 (26.0000)	Acc@5 70.0000 (70.0000)
Epoch 359 running time:  0:01:52.276384
Logs dir: logs/dual_baseline_aug1 
====> results in csv format: 
| Method             | Dataset                                | Epoch   | Loss   | MRR    | Acc-5   | Acc-10   |
|:-------------------|:---------------------------------------|:--------|:-------|:-------|:--------|:---------|
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 19      | 4.418  | 18.029 | 6.000   | 29.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 39      | 4.318  | 25.640 | 12.000  | 39.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 59      | 4.308  | 26.601 | 10.000  | 45.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 79      | 4.256  | 32.901 | 16.000  | 53.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 99      | 4.248  | 35.485 | 19.000  | 54.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 119     | 4.278  | 36.260 | 19.000  | 60.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 139     | 4.258  | 34.736 | 18.000  | 56.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 159     | 4.232  | 35.243 | 21.000  | 51.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 179     | 4.187  | 43.807 | 26.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 199     | 4.184  | 45.585 | 27.000  | 71.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 219     | 4.183  | 41.780 | 22.000  | 67.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 239     | 4.190  | 44.424 | 26.000  | 68.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 259     | 4.200  | 44.491 | 27.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 279     | 4.198  | 44.826 | 30.000  | 61.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 299     | 4.192  | 46.921 | 32.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 319     | 4.192  | 45.967 | 29.000  | 70.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 339     | 4.192  | 45.717 | 29.000  | 66.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 359     | 4.192  | 44.560 | 26.000  | 70.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | Max_299 | 4.192  | 46.921 | 32.000  | 69.000   |
===> Building meters
DataParallel
4
Epoch: [359][929/32]	Time  6.707 ( 6.707)	Data  6.077 ( 6.077)	Loss 4.9837e+00 (4.9837e+00)	Clip_Loss 4.9837e+00 (4.9837e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.1823 (75.1823)	Acc@5 92.1875 (92.1875)	Acc@10 98.4375 (98.4375)
Epoch: [359][949/32]	Time  0.592 ( 1.179)	Data  0.007 ( 0.568)	Loss 3.6874e+00 (3.9757e+00)	Clip_Loss 3.6874e+00 (3.9757e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.9063 (81.9899)	Acc@5 96.8750 (98.1399)	Acc@10 98.4375 (99.7768)
Epoch 359 running time:  0:00:36.114364
===> Building meters
DataParallel
4
Epoch: [360][ 1/32]	Time  5.603 ( 5.603)	Data  4.971 ( 4.971)	Loss 4.2067e+00 (4.2067e+00)	Clip_Loss 4.2067e+00 (4.2067e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.8691 (83.8691)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [360][21/32]	Time  0.624 ( 0.988)	Data  0.007 ( 0.383)	Loss 4.4296e+00 (4.0940e+00)	Clip_Loss 4.4296e+00 (4.0940e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 82.7604 (81.4678)	Acc@5 98.4375 (97.6935)	Acc@10 100.0000 (99.7768)
Epoch 360 running time:  0:00:29.829406
===> Building meters
DataParallel
4
Epoch: [361][33/32]	Time  6.510 ( 6.510)	Data  5.915 ( 5.915)	Loss 3.9166e+00 (3.9166e+00)	Clip_Loss 3.9166e+00 (3.9166e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 79.5573 (79.5573)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [361][53/32]	Time  0.621 ( 1.136)	Data  0.007 ( 0.536)	Loss 3.8614e+00 (3.9657e+00)	Clip_Loss 3.8614e+00 (3.9657e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.5052 (82.9220)	Acc@5 96.8750 (97.4702)	Acc@10 98.4375 (99.6280)
Epoch 361 running time:  0:00:35.788840
===> Building meters
DataParallel
4
Epoch: [362][65/32]	Time  6.294 ( 6.294)	Data  5.652 ( 5.652)	Loss 3.5605e+00 (3.5605e+00)	Clip_Loss 3.5605e+00 (3.5605e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 86.6406 (86.6406)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [362][85/32]	Time  0.612 ( 1.049)	Data  0.007 ( 0.438)	Loss 5.0438e+00 (4.0567e+00)	Clip_Loss 5.0438e+00 (4.0567e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 75.8545 (81.8644)	Acc@5 93.7500 (97.9167)	Acc@10 96.8750 (99.4048)
Epoch 362 running time:  0:00:31.759297
===> Building meters
DataParallel
4
Epoch: [363][97/32]	Time  5.595 ( 5.595)	Data  4.940 ( 4.940)	Loss 4.0461e+00 (4.0461e+00)	Clip_Loss 4.0461e+00 (4.0461e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.9635 (80.9635)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [363][117/32]	Time  0.649 ( 1.009)	Data  0.007 ( 0.394)	Loss 4.5597e+00 (4.0407e+00)	Clip_Loss 4.5597e+00 (4.0407e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.7961 (82.6915)	Acc@5 96.8750 (98.0655)	Acc@10 100.0000 (99.8512)
Epoch 363 running time:  0:00:31.869974
===> Building meters
DataParallel
4
Epoch: [364][129/32]	Time  5.839 ( 5.839)	Data  5.240 ( 5.240)	Loss 3.9295e+00 (3.9295e+00)	Clip_Loss 3.9295e+00 (3.9295e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.8542 (83.8542)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [364][149/32]	Time  0.626 ( 1.095)	Data  0.007 ( 0.487)	Loss 4.2933e+00 (3.9970e+00)	Clip_Loss 4.2933e+00 (3.9970e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 82.2656 (83.1452)	Acc@5 96.8750 (98.1399)	Acc@10 100.0000 (99.7768)
Epoch 364 running time:  0:00:32.612880
===> Building meters
DataParallel
4
Epoch: [365][161/32]	Time  5.429 ( 5.429)	Data  4.795 ( 4.795)	Loss 4.2385e+00 (4.2385e+00)	Clip_Loss 4.2385e+00 (4.2385e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.3906 (80.3906)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [365][181/32]	Time  0.732 ( 1.022)	Data  0.117 ( 0.409)	Loss 4.3055e+00 (3.9921e+00)	Clip_Loss 4.3055e+00 (3.9921e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 77.7493 (81.8821)	Acc@5 98.4375 (97.3958)	Acc@10 100.0000 (99.4792)
Epoch 365 running time:  0:00:30.867157
===> Building meters
DataParallel
4
Epoch: [366][193/32]	Time  6.288 ( 6.288)	Data  5.676 ( 5.676)	Loss 3.8618e+00 (3.8618e+00)	Clip_Loss 3.8618e+00 (3.8618e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.8958 (84.8958)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [366][213/32]	Time  0.616 ( 1.124)	Data  0.008 ( 0.520)	Loss 3.5122e+00 (3.9109e+00)	Clip_Loss 3.5122e+00 (3.9109e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 87.6302 (83.0846)	Acc@5 100.0000 (98.3631)	Acc@10 100.0000 (99.7024)
Epoch 366 running time:  0:00:33.682327
===> Building meters
DataParallel
4
Epoch: [367][225/32]	Time  6.176 ( 6.176)	Data  5.557 ( 5.557)	Loss 4.5906e+00 (4.5906e+00)	Clip_Loss 4.5906e+00 (4.5906e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.0512 (78.0512)	Acc@5 95.3125 (95.3125)	Acc@10 100.0000 (100.0000)
Epoch: [367][245/32]	Time  0.591 ( 1.067)	Data  0.007 ( 0.466)	Loss 4.4565e+00 (3.9745e+00)	Clip_Loss 4.4565e+00 (3.9745e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.1441 (83.2326)	Acc@5 96.8750 (98.0655)	Acc@10 96.8750 (99.7024)
Epoch 367 running time:  0:00:32.282979
===> Building meters
DataParallel
4
Epoch: [368][257/32]	Time  6.386 ( 6.386)	Data  5.770 ( 5.770)	Loss 3.9471e+00 (3.9471e+00)	Clip_Loss 3.9471e+00 (3.9471e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 87.9427 (87.9427)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [368][277/32]	Time  0.639 ( 1.078)	Data  0.007 ( 0.471)	Loss 4.6499e+00 (4.1010e+00)	Clip_Loss 4.6499e+00 (4.1010e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.4245 (82.9749)	Acc@5 98.4375 (98.2143)	Acc@10 100.0000 (99.8512)
Epoch 368 running time:  0:00:32.283528
===> Building meters
DataParallel
4
Epoch: [369][289/32]	Time  6.214 ( 6.214)	Data  5.567 ( 5.567)	Loss 3.5561e+00 (3.5561e+00)	Clip_Loss 3.5561e+00 (3.5561e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.5327 (80.5327)	Acc@5 98.4375 (98.4375)	Acc@10 98.4375 (98.4375)
Epoch: [369][309/32]	Time  0.590 ( 1.064)	Data  0.007 ( 0.458)	Loss 3.7551e+00 (4.1309e+00)	Clip_Loss 3.7551e+00 (4.1309e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.8828 (81.1621)	Acc@5 98.4375 (97.9911)	Acc@10 100.0000 (99.5536)
Epoch 369 running time:  0:00:32.152876
===> Building meters
DataParallel
4
Epoch: [370][321/32]	Time  5.751 ( 5.751)	Data  5.132 ( 5.132)	Loss 3.6028e+00 (3.6028e+00)	Clip_Loss 3.6028e+00 (3.6028e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.2552 (83.2552)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [370][341/32]	Time  0.590 ( 1.034)	Data  0.007 ( 0.426)	Loss 3.9564e+00 (4.0293e+00)	Clip_Loss 3.9564e+00 (4.0293e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.9115 (82.4375)	Acc@5 98.4375 (97.8423)	Acc@10 100.0000 (99.7024)
Epoch 370 running time:  0:00:32.665975
===> Building meters
DataParallel
4
Epoch: [371][353/32]	Time  6.110 ( 6.110)	Data  5.479 ( 5.479)	Loss 3.7470e+00 (3.7470e+00)	Clip_Loss 3.7470e+00 (3.7470e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 87.0833 (87.0833)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [371][373/32]	Time  0.636 ( 1.095)	Data  0.007 ( 0.490)	Loss 4.1609e+00 (4.0326e+00)	Clip_Loss 4.1609e+00 (4.0326e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 82.6042 (82.6164)	Acc@5 98.4375 (97.9167)	Acc@10 100.0000 (99.7024)
Epoch 371 running time:  0:00:33.039833
===> Building meters
DataParallel
4
Epoch: [372][385/32]	Time  5.516 ( 5.516)	Data  4.870 ( 4.870)	Loss 4.4140e+00 (4.4140e+00)	Clip_Loss 4.4140e+00 (4.4140e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.0930 (80.0930)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [372][405/32]	Time  0.590 ( 1.053)	Data  0.007 ( 0.452)	Loss 4.4029e+00 (4.0468e+00)	Clip_Loss 4.4029e+00 (4.0468e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.6667 (82.6101)	Acc@5 100.0000 (98.4375)	Acc@10 100.0000 (99.8512)
Epoch 372 running time:  0:00:35.699016
===> Building meters
DataParallel
4
Epoch: [373][417/32]	Time  6.155 ( 6.155)	Data  5.529 ( 5.529)	Loss 3.7423e+00 (3.7423e+00)	Clip_Loss 3.7423e+00 (3.7423e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.6146 (81.6146)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [373][437/32]	Time  0.614 ( 1.077)	Data  0.007 ( 0.470)	Loss 3.7332e+00 (4.1241e+00)	Clip_Loss 3.7332e+00 (4.1241e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 85.6213 (81.3062)	Acc@5 95.3125 (97.1726)	Acc@10 98.4375 (99.3304)
Epoch 373 running time:  0:00:34.015994
===> Building meters
DataParallel
4
Epoch: [374][449/32]	Time  6.683 ( 6.683)	Data  6.052 ( 6.052)	Loss 3.4489e+00 (3.4489e+00)	Clip_Loss 3.4489e+00 (3.4489e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.7309 (84.7309)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [374][469/32]	Time  0.618 ( 1.096)	Data  0.007 ( 0.486)	Loss 4.2352e+00 (3.9638e+00)	Clip_Loss 4.2352e+00 (3.9638e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.6632 (81.8991)	Acc@5 98.4375 (98.0655)	Acc@10 100.0000 (99.8512)
Epoch 374 running time:  0:00:32.431612
===> Building meters
DataParallel
4
Epoch: [375][481/32]	Time  5.878 ( 5.878)	Data  5.257 ( 5.257)	Loss 3.7769e+00 (3.7769e+00)	Clip_Loss 3.7769e+00 (3.7769e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.7240 (83.7240)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [375][501/32]	Time  0.617 ( 1.042)	Data  0.008 ( 0.429)	Loss 3.2779e+00 (3.9065e+00)	Clip_Loss 3.2779e+00 (3.9065e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 88.8021 (82.6754)	Acc@5 100.0000 (98.2887)	Acc@10 100.0000 (99.7768)
Epoch 375 running time:  0:00:31.863557
===> Building meters
DataParallel
4
Epoch: [376][513/32]	Time  6.124 ( 6.124)	Data  5.513 ( 5.513)	Loss 3.5209e+00 (3.5209e+00)	Clip_Loss 3.5209e+00 (3.5209e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.5565 (83.5565)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [376][533/32]	Time  0.614 ( 1.073)	Data  0.007 ( 0.472)	Loss 4.9164e+00 (4.1665e+00)	Clip_Loss 4.9164e+00 (4.1665e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 71.9345 (82.1422)	Acc@5 96.8750 (97.3958)	Acc@10 96.8750 (99.7024)
Epoch 376 running time:  0:00:32.301872
===> Building meters
DataParallel
4
Epoch: [377][545/32]	Time  6.236 ( 6.236)	Data  5.616 ( 5.616)	Loss 3.9474e+00 (3.9474e+00)	Clip_Loss 3.9474e+00 (3.9474e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.2597 (84.2597)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [377][565/32]	Time  0.597 ( 1.075)	Data  0.009 ( 0.464)	Loss 4.2941e+00 (3.8908e+00)	Clip_Loss 4.2941e+00 (3.8908e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.2240 (84.0888)	Acc@5 98.4375 (98.2143)	Acc@10 100.0000 (99.9256)
s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
====> save checkpoint to s3://aicitychallenge2023/logs/dual_baseline_aug1/checkpoint_best.pth
Epoch 377 running time:  0:00:58.468349
===> Building meters
DataParallel
4
Epoch: [378][577/32]	Time  6.552 ( 6.552)	Data  5.901 ( 5.901)	Loss 3.6419e+00 (3.6419e+00)	Clip_Loss 3.6419e+00 (3.6419e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 87.5521 (87.5521)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [378][597/32]	Time  0.615 ( 1.161)	Data  0.007 ( 0.547)	Loss 4.0605e+00 (4.1707e+00)	Clip_Loss 4.0605e+00 (4.1707e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.5759 (80.6804)	Acc@5 96.8750 (97.7679)	Acc@10 98.4375 (99.4792)
Epoch 378 running time:  0:00:35.770462
====> Test::::/datasets/aicitychallenge2023/val.json
====> Query /datasets/aicitychallenge2023/val.json load
Test Epoch: [379][162/163]	Time 109.696 (109.696)	Data  0.000 ( 0.000)	Clip Loss 4.1923e+00 (4.1923e+00)	MRR 46.1141 (46.1141)	Acc@1 28.0000 (28.0000)	Acc@5 71.0000 (71.0000)
Epoch 379 running time:  0:01:49.701325
Logs dir: logs/dual_baseline_aug1 
====> results in csv format: 
| Method             | Dataset                                | Epoch   | Loss   | MRR    | Acc-5   | Acc-10   |
|:-------------------|:---------------------------------------|:--------|:-------|:-------|:--------|:---------|
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 19      | 4.418  | 18.029 | 6.000   | 29.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 39      | 4.318  | 25.640 | 12.000  | 39.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 59      | 4.308  | 26.601 | 10.000  | 45.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 79      | 4.256  | 32.901 | 16.000  | 53.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 99      | 4.248  | 35.485 | 19.000  | 54.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 119     | 4.278  | 36.260 | 19.000  | 60.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 139     | 4.258  | 34.736 | 18.000  | 56.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 159     | 4.232  | 35.243 | 21.000  | 51.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 179     | 4.187  | 43.807 | 26.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 199     | 4.184  | 45.585 | 27.000  | 71.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 219     | 4.183  | 41.780 | 22.000  | 67.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 239     | 4.190  | 44.424 | 26.000  | 68.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 259     | 4.200  | 44.491 | 27.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 279     | 4.198  | 44.826 | 30.000  | 61.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 299     | 4.192  | 46.921 | 32.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 319     | 4.192  | 45.967 | 29.000  | 70.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 339     | 4.192  | 45.717 | 29.000  | 66.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 359     | 4.192  | 44.560 | 26.000  | 70.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 379     | 4.192  | 46.114 | 28.000  | 71.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | Max_299 | 4.192  | 46.921 | 32.000  | 69.000   |
===> Building meters
DataParallel
4
Epoch: [379][609/32]	Time  7.181 ( 7.181)	Data  6.560 ( 6.560)	Loss 4.2338e+00 (4.2338e+00)	Clip_Loss 4.2338e+00 (4.2338e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.7574 (78.7574)	Acc@5 92.1875 (92.1875)	Acc@10 100.0000 (100.0000)
Epoch: [379][629/32]	Time  0.629 ( 1.215)	Data  0.007 ( 0.610)	Loss 4.0563e+00 (4.1316e+00)	Clip_Loss 4.0563e+00 (4.1316e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.3819 (81.4652)	Acc@5 98.4375 (97.0238)	Acc@10 100.0000 (99.7024)
Epoch 379 running time:  0:00:35.982817
===> Building meters
DataParallel
4
Epoch: [380][641/32]	Time  5.768 ( 5.768)	Data  5.120 ( 5.120)	Loss 4.2665e+00 (4.2665e+00)	Clip_Loss 4.2665e+00 (4.2665e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.2310 (83.2310)	Acc@5 95.3125 (95.3125)	Acc@10 100.0000 (100.0000)
Epoch: [380][661/32]	Time  0.591 ( 0.996)	Data  0.007 ( 0.395)	Loss 4.7352e+00 (3.9590e+00)	Clip_Loss 4.7352e+00 (3.9590e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.9583 (82.6109)	Acc@5 100.0000 (98.3631)	Acc@10 100.0000 (99.9256)
Epoch 380 running time:  0:00:30.521670
===> Building meters
DataParallel
4
Epoch: [381][673/32]	Time  5.995 ( 5.995)	Data  5.357 ( 5.357)	Loss 3.8086e+00 (3.8086e+00)	Clip_Loss 3.8086e+00 (3.8086e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 85.3906 (85.3906)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [381][693/32]	Time  0.609 ( 1.086)	Data  0.007 ( 0.481)	Loss 3.6028e+00 (3.9902e+00)	Clip_Loss 3.6028e+00 (3.9902e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 85.3516 (82.7390)	Acc@5 98.4375 (98.2143)	Acc@10 100.0000 (99.7024)
Epoch 381 running time:  0:00:33.340411
===> Building meters
DataParallel
4
Epoch: [382][705/32]	Time  5.970 ( 5.970)	Data  5.342 ( 5.342)	Loss 3.7247e+00 (3.7247e+00)	Clip_Loss 3.7247e+00 (3.7247e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 82.9948 (82.9948)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [382][725/32]	Time  0.711 ( 1.027)	Data  0.103 ( 0.416)	Loss 3.9805e+00 (3.9409e+00)	Clip_Loss 3.9805e+00 (3.9409e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.9844 (83.0461)	Acc@5 98.4375 (98.2887)	Acc@10 100.0000 (99.7024)
Epoch 382 running time:  0:00:31.188375
===> Building meters
DataParallel
4
Epoch: [383][737/32]	Time  5.942 ( 5.942)	Data  5.305 ( 5.305)	Loss 4.1476e+00 (4.1476e+00)	Clip_Loss 4.1476e+00 (4.1476e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.6138 (80.6138)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [383][757/32]	Time  0.617 ( 1.023)	Data  0.007 ( 0.415)	Loss 3.9036e+00 (3.9502e+00)	Clip_Loss 3.9036e+00 (3.9502e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 82.7344 (83.3446)	Acc@5 98.4375 (98.1399)	Acc@10 100.0000 (99.7768)
Epoch 383 running time:  0:00:31.565823
===> Building meters
DataParallel
4
Epoch: [384][769/32]	Time  6.497 ( 6.497)	Data  5.844 ( 5.844)	Loss 3.7453e+00 (3.7453e+00)	Clip_Loss 3.7453e+00 (3.7453e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 86.6815 (86.6815)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [384][789/32]	Time  0.613 ( 1.107)	Data  0.007 ( 0.503)	Loss 3.9653e+00 (3.9168e+00)	Clip_Loss 3.9653e+00 (3.9168e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.2240 (83.2828)	Acc@5 98.4375 (98.0655)	Acc@10 100.0000 (99.7768)
Epoch 384 running time:  0:00:33.129762
===> Building meters
DataParallel
4
Epoch: [385][801/32]	Time  5.730 ( 5.730)	Data  5.090 ( 5.090)	Loss 3.7654e+00 (3.7654e+00)	Clip_Loss 3.7654e+00 (3.7654e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 82.8404 (82.8404)	Acc@5 96.8750 (96.8750)	Acc@10 100.0000 (100.0000)
Epoch: [385][821/32]	Time  0.646 ( 1.013)	Data  0.007 ( 0.401)	Loss 4.0136e+00 (4.0465e+00)	Clip_Loss 4.0136e+00 (4.0465e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 82.8925 (81.7847)	Acc@5 95.3125 (97.8423)	Acc@10 100.0000 (99.6280)
Epoch 385 running time:  0:00:30.921414
===> Building meters
DataParallel
4
Epoch: [386][833/32]	Time  5.838 ( 5.838)	Data  5.217 ( 5.217)	Loss 4.2806e+00 (4.2806e+00)	Clip_Loss 4.2806e+00 (4.2806e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 79.7024 (79.7024)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [386][853/32]	Time  0.612 ( 1.043)	Data  0.007 ( 0.428)	Loss 3.6871e+00 (3.9355e+00)	Clip_Loss 3.6871e+00 (3.9355e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 85.6771 (83.7334)	Acc@5 100.0000 (98.8095)	Acc@10 100.0000 (99.7768)
Epoch 386 running time:  0:00:32.055452
===> Building meters
DataParallel
4
Epoch: [387][865/32]	Time  5.946 ( 5.946)	Data  5.270 ( 5.270)	Loss 3.9531e+00 (3.9531e+00)	Clip_Loss 3.9531e+00 (3.9531e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 85.5339 (85.5339)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [387][885/32]	Time  0.601 ( 1.045)	Data  0.009 ( 0.434)	Loss 3.6032e+00 (4.0382e+00)	Clip_Loss 3.6032e+00 (4.0382e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.2701 (81.9804)	Acc@5 98.4375 (98.3631)	Acc@10 100.0000 (99.8512)
Epoch 387 running time:  0:00:31.932343
===> Building meters
DataParallel
4
Epoch: [388][897/32]	Time  6.585 ( 6.585)	Data  5.959 ( 5.959)	Loss 4.3187e+00 (4.3187e+00)	Clip_Loss 4.3187e+00 (4.3187e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 85.2083 (85.2083)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [388][917/32]	Time  0.622 ( 1.089)	Data  0.007 ( 0.476)	Loss 3.9435e+00 (4.0569e+00)	Clip_Loss 3.9435e+00 (4.0569e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.2682 (81.4762)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (99.7024)
Epoch 388 running time:  0:00:32.474561
===> Building meters
DataParallel
4
Epoch: [389][929/32]	Time  5.963 ( 5.963)	Data  5.324 ( 5.324)	Loss 3.2773e+00 (3.2773e+00)	Clip_Loss 3.2773e+00 (3.2773e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 87.0313 (87.0313)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [389][949/32]	Time  0.591 ( 1.038)	Data  0.007 ( 0.431)	Loss 4.4315e+00 (4.0326e+00)	Clip_Loss 4.4315e+00 (4.0326e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 79.4940 (81.6398)	Acc@5 93.7500 (97.3958)	Acc@10 100.0000 (99.6280)
Epoch 389 running time:  0:00:32.098424
===> Building meters
DataParallel
4
Epoch: [390][ 1/32]	Time  7.047 ( 7.047)	Data  6.420 ( 6.420)	Loss 4.1191e+00 (4.1191e+00)	Clip_Loss 4.1191e+00 (4.1191e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.7429 (81.7429)	Acc@5 92.1875 (92.1875)	Acc@10 98.4375 (98.4375)
Epoch: [390][21/32]	Time  0.590 ( 1.110)	Data  0.007 ( 0.504)	Loss 3.8318e+00 (3.9494e+00)	Clip_Loss 3.8318e+00 (3.9494e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.2552 (82.8079)	Acc@5 100.0000 (97.8423)	Acc@10 100.0000 (99.6280)
Epoch 390 running time:  0:00:33.105126
===> Building meters
DataParallel
4
Epoch: [391][33/32]	Time  5.840 ( 5.840)	Data  5.222 ( 5.222)	Loss 3.3164e+00 (3.3164e+00)	Clip_Loss 3.3164e+00 (3.3164e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 87.1094 (87.1094)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [391][53/32]	Time  0.613 ( 1.058)	Data  0.007 ( 0.448)	Loss 3.6606e+00 (4.0899e+00)	Clip_Loss 3.6606e+00 (4.0899e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 81.8638 (81.4729)	Acc@5 98.4375 (97.9167)	Acc@10 100.0000 (99.6280)
Epoch 391 running time:  0:00:32.029475
===> Building meters
DataParallel
4
Epoch: [392][65/32]	Time  5.839 ( 5.839)	Data  5.222 ( 5.222)	Loss 3.7805e+00 (3.7805e+00)	Clip_Loss 3.7805e+00 (3.7805e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 88.0208 (88.0208)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [392][85/32]	Time  0.646 ( 1.043)	Data  0.007 ( 0.436)	Loss 4.1638e+00 (3.8246e+00)	Clip_Loss 4.1638e+00 (3.8246e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.3534 (83.0543)	Acc@5 98.4375 (98.5119)	Acc@10 100.0000 (99.7024)
Epoch 392 running time:  0:00:31.752861
===> Building meters
DataParallel
4
Epoch: [393][97/32]	Time  5.821 ( 5.821)	Data  5.228 ( 5.228)	Loss 3.5896e+00 (3.5896e+00)	Clip_Loss 3.5896e+00 (3.5896e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 88.9757 (88.9757)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [393][117/32]	Time  0.612 ( 1.049)	Data  0.007 ( 0.443)	Loss 4.4964e+00 (3.9766e+00)	Clip_Loss 4.4964e+00 (3.9766e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.7413 (82.5203)	Acc@5 98.4375 (98.1399)	Acc@10 100.0000 (99.9256)
Epoch 393 running time:  0:00:31.682376
===> Building meters
DataParallel
4
Epoch: [394][129/32]	Time  5.814 ( 5.814)	Data  5.171 ( 5.171)	Loss 3.3331e+00 (3.3331e+00)	Clip_Loss 3.3331e+00 (3.3331e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 87.2917 (87.2917)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [394][149/32]	Time  0.614 ( 1.071)	Data  0.007 ( 0.465)	Loss 4.2841e+00 (3.8976e+00)	Clip_Loss 4.2841e+00 (3.8976e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 74.7656 (82.9967)	Acc@5 96.8750 (97.9167)	Acc@10 100.0000 (99.9256)
Epoch 394 running time:  0:00:32.964915
===> Building meters
DataParallel
4
Epoch: [395][161/32]	Time  5.974 ( 5.974)	Data  5.380 ( 5.380)	Loss 3.7041e+00 (3.7041e+00)	Clip_Loss 3.7041e+00 (3.7041e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 89.3229 (89.3229)	Acc@5 100.0000 (100.0000)	Acc@10 100.0000 (100.0000)
Epoch: [395][181/32]	Time  0.593 ( 1.062)	Data  0.007 ( 0.455)	Loss 4.1895e+00 (4.0802e+00)	Clip_Loss 4.1895e+00 (4.0802e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.2969 (82.6079)	Acc@5 100.0000 (98.0655)	Acc@10 100.0000 (99.7024)
Epoch 395 running time:  0:00:32.599955
===> Building meters
DataParallel
4
Epoch: [396][193/32]	Time  5.901 ( 5.901)	Data  5.239 ( 5.239)	Loss 4.2943e+00 (4.2943e+00)	Clip_Loss 4.2943e+00 (4.2943e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.7805 (84.7805)	Acc@5 95.3125 (95.3125)	Acc@10 100.0000 (100.0000)
Epoch: [396][213/32]	Time  0.618 ( 1.063)	Data  0.007 ( 0.450)	Loss 3.9937e+00 (3.9318e+00)	Clip_Loss 3.9937e+00 (3.9318e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.1250 (83.0646)	Acc@5 100.0000 (98.2887)	Acc@10 100.0000 (99.7024)
Epoch 396 running time:  0:00:32.079549
===> Building meters
DataParallel
4
Epoch: [397][225/32]	Time  5.654 ( 5.654)	Data  5.013 ( 5.013)	Loss 4.4971e+00 (4.4971e+00)	Clip_Loss 4.4971e+00 (4.4971e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.2006 (78.2006)	Acc@5 90.6250 (90.6250)	Acc@10 98.4375 (98.4375)
Epoch: [397][245/32]	Time  0.611 ( 1.063)	Data  0.007 ( 0.455)	Loss 4.4358e+00 (4.0115e+00)	Clip_Loss 4.4358e+00 (4.0115e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.2031 (82.9702)	Acc@5 98.4375 (97.7679)	Acc@10 100.0000 (99.7024)
Epoch 397 running time:  0:00:32.133816
===> Building meters
DataParallel
4
Epoch: [398][257/32]	Time  6.154 ( 6.154)	Data  5.512 ( 5.512)	Loss 4.6202e+00 (4.6202e+00)	Clip_Loss 4.6202e+00 (4.6202e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 78.9692 (78.9692)	Acc@5 95.3125 (95.3125)	Acc@10 98.4375 (98.4375)
Epoch: [398][277/32]	Time  0.617 ( 1.076)	Data  0.007 ( 0.468)	Loss 3.9538e+00 (3.9223e+00)	Clip_Loss 3.9538e+00 (3.9223e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 80.7813 (83.5565)	Acc@5 100.0000 (98.2143)	Acc@10 100.0000 (99.5536)
Epoch 398 running time:  0:00:32.888501
====> Test::::/datasets/aicitychallenge2023/val.json
====> Query /datasets/aicitychallenge2023/val.json load
Test Epoch: [399][162/163]	Time 108.745 (108.745)	Data  0.000 ( 0.000)	Clip Loss 4.1920e+00 (4.1920e+00)	MRR 45.9045 (45.9045)	Acc@1 28.0000 (28.0000)	Acc@5 68.0000 (68.0000)
Epoch 399 running time:  0:01:48.750771
Logs dir: logs/dual_baseline_aug1 
====> results in csv format: 
| Method             | Dataset                                | Epoch   | Loss   | MRR    | Acc-5   | Acc-10   |
|:-------------------|:---------------------------------------|:--------|:-------|:-------|:--------|:---------|
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 19      | 4.418  | 18.029 | 6.000   | 29.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 39      | 4.318  | 25.640 | 12.000  | 39.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 59      | 4.308  | 26.601 | 10.000  | 45.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 79      | 4.256  | 32.901 | 16.000  | 53.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 99      | 4.248  | 35.485 | 19.000  | 54.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 119     | 4.278  | 36.260 | 19.000  | 60.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 139     | 4.258  | 34.736 | 18.000  | 56.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 159     | 4.232  | 35.243 | 21.000  | 51.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 179     | 4.187  | 43.807 | 26.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 199     | 4.184  | 45.585 | 27.000  | 71.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 219     | 4.183  | 41.780 | 22.000  | 67.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 239     | 4.190  | 44.424 | 26.000  | 68.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 259     | 4.200  | 44.491 | 27.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 279     | 4.198  | 44.826 | 30.000  | 61.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 299     | 4.192  | 46.921 | 32.000  | 69.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 319     | 4.192  | 45.967 | 29.000  | 70.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 339     | 4.192  | 45.717 | 29.000  | 66.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 359     | 4.192  | 44.560 | 26.000  | 70.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 379     | 4.192  | 46.114 | 28.000  | 71.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | 399     | 4.192  | 45.904 | 28.000  | 68.000   |
| dual_baseline_aug1 | /datasets/aicitychallenge2023/val.json | Max_299 | 4.192  | 46.921 | 32.000  | 69.000   |
===> Building meters
DataParallel
4
Epoch: [399][289/32]	Time  7.133 ( 7.133)	Data  6.533 ( 6.533)	Loss 3.6746e+00 (3.6746e+00)	Clip_Loss 3.6746e+00 (3.6746e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 83.7760 (83.7760)	Acc@5 98.4375 (98.4375)	Acc@10 100.0000 (100.0000)
Epoch: [399][309/32]	Time  0.646 ( 1.254)	Data  0.007 ( 0.652)	Loss 4.0482e+00 (4.0123e+00)	Clip_Loss 4.0482e+00 (4.0123e+00)	Cls_Loss 0.0000e+00 (0.0000e+00)	None 0.0000e+00 (0.0000e+00)	Nlp_View_Triplet_Loss 0.0000e+00 (0.0000e+00)	MRR 84.0136 (82.4146)	Acc@5 95.3125 (97.0982)	Acc@10 96.8750 (99.1071)
Epoch 399 running time:  0:00:37.308562
====> Test::::/datasets/aicitychallenge2023/val.json
====> Query /datasets/aicitychallenge2023/val.json load
====> results in csv format: 
| Method                   | Dataset                                | Epoch   | Loss   | MRR    | Acc-5   | Acc-10   |
|:-------------------------|:---------------------------------------|:--------|:-------|:-------|:--------|:---------|
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 19      | 4.418  | 18.029 | 6.000   | 29.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 39      | 4.318  | 25.640 | 12.000  | 39.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 59      | 4.308  | 26.601 | 10.000  | 45.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 79      | 4.256  | 32.901 | 16.000  | 53.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 99      | 4.248  | 35.485 | 19.000  | 54.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 119     | 4.278  | 36.260 | 19.000  | 60.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 139     | 4.258  | 34.736 | 18.000  | 56.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 159     | 4.232  | 35.243 | 21.000  | 51.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 179     | 4.187  | 43.807 | 26.000  | 69.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 199     | 4.184  | 45.585 | 27.000  | 71.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 219     | 4.183  | 41.780 | 22.000  | 67.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 239     | 4.190  | 44.424 | 26.000  | 68.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 259     | 4.200  | 44.491 | 27.000  | 69.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 279     | 4.198  | 44.826 | 30.000  | 61.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 299     | 4.192  | 46.921 | 32.000  | 69.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 319     | 4.192  | 45.967 | 29.000  | 70.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 339     | 4.192  | 45.717 | 29.000  | 66.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 359     | 4.192  | 44.560 | 26.000  | 70.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 379     | 4.192  | 46.114 | 28.000  | 71.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 399     | 4.192  | 45.904 | 28.000  | 68.000   |
| dual_baseline_aug1feat_0 | /datasets/aicitychallenge2023/val.json | 400     | 4.352  | 43.592 | 62.000  | 82.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | Max_299 | 4.192  | 46.921 | 32.000  | 69.000   |
====> results in csv format: 
| Method                   | Dataset                                | Epoch   | Loss   | MRR    | Acc-5   | Acc-10   |
|:-------------------------|:---------------------------------------|:--------|:-------|:-------|:--------|:---------|
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 19      | 4.418  | 18.029 | 6.000   | 29.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 39      | 4.318  | 25.640 | 12.000  | 39.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 59      | 4.308  | 26.601 | 10.000  | 45.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 79      | 4.256  | 32.901 | 16.000  | 53.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 99      | 4.248  | 35.485 | 19.000  | 54.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 119     | 4.278  | 36.260 | 19.000  | 60.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 139     | 4.258  | 34.736 | 18.000  | 56.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 159     | 4.232  | 35.243 | 21.000  | 51.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 179     | 4.187  | 43.807 | 26.000  | 69.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 199     | 4.184  | 45.585 | 27.000  | 71.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 219     | 4.183  | 41.780 | 22.000  | 67.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 239     | 4.190  | 44.424 | 26.000  | 68.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 259     | 4.200  | 44.491 | 27.000  | 69.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 279     | 4.198  | 44.826 | 30.000  | 61.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 299     | 4.192  | 46.921 | 32.000  | 69.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 319     | 4.192  | 45.967 | 29.000  | 70.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 339     | 4.192  | 45.717 | 29.000  | 66.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 359     | 4.192  | 44.560 | 26.000  | 70.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 379     | 4.192  | 46.114 | 28.000  | 71.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 399     | 4.192  | 45.904 | 28.000  | 68.000   |
| dual_baseline_aug1feat_0 | /datasets/aicitychallenge2023/val.json | 400     | 4.352  | 43.592 | 62.000  | 82.000   |
| dual_baseline_aug1feat_1 | /datasets/aicitychallenge2023/val.json | 400     | 4.348  | 37.405 | 53.000  | 74.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | Max_299 | 4.192  | 46.921 | 32.000  | 69.000   |
====> results in csv format: 
| Method                   | Dataset                                | Epoch   | Loss   | MRR    | Acc-5   | Acc-10   |
|:-------------------------|:---------------------------------------|:--------|:-------|:-------|:--------|:---------|
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 19      | 4.418  | 18.029 | 6.000   | 29.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 39      | 4.318  | 25.640 | 12.000  | 39.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 59      | 4.308  | 26.601 | 10.000  | 45.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 79      | 4.256  | 32.901 | 16.000  | 53.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 99      | 4.248  | 35.485 | 19.000  | 54.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 119     | 4.278  | 36.260 | 19.000  | 60.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 139     | 4.258  | 34.736 | 18.000  | 56.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 159     | 4.232  | 35.243 | 21.000  | 51.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 179     | 4.187  | 43.807 | 26.000  | 69.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 199     | 4.184  | 45.585 | 27.000  | 71.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 219     | 4.183  | 41.780 | 22.000  | 67.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 239     | 4.190  | 44.424 | 26.000  | 68.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 259     | 4.200  | 44.491 | 27.000  | 69.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 279     | 4.198  | 44.826 | 30.000  | 61.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 299     | 4.192  | 46.921 | 32.000  | 69.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 319     | 4.192  | 45.967 | 29.000  | 70.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 339     | 4.192  | 45.717 | 29.000  | 66.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 359     | 4.192  | 44.560 | 26.000  | 70.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 379     | 4.192  | 46.114 | 28.000  | 71.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | 399     | 4.192  | 45.904 | 28.000  | 68.000   |
| dual_baseline_aug1feat_0 | /datasets/aicitychallenge2023/val.json | 400     | 4.352  | 43.592 | 62.000  | 82.000   |
| dual_baseline_aug1feat_1 | /datasets/aicitychallenge2023/val.json | 400     | 4.348  | 37.405 | 53.000  | 74.000   |
| dual_baseline_aug1feat_2 | /datasets/aicitychallenge2023/val.json | 400     | 4.200  | 45.495 | 67.000  | 88.000   |
| dual_baseline_aug1       | /datasets/aicitychallenge2023/val.json | Max_299 | 4.192  | 46.921 | 32.000  | 69.000   |
====> results in csv format: 
| Method                     | Dataset                                | Epoch   | Loss   | MRR    | Acc-5   | Acc-10   |
|:---------------------------|:---------------------------------------|:--------|:-------|:-------|:--------|:---------|
| dual_baseline_aug1         | /datasets/aicitychallenge2023/val.json | 19      | 4.418  | 18.029 | 6.000   | 29.000   |
| dual_baseline_aug1         | /datasets/aicitychallenge2023/val.json | 39      | 4.318  | 25.640 | 12.000  | 39.000   |
| dual_baseline_aug1         | /datasets/aicitychallenge2023/val.json | 59      | 4.308  | 26.601 | 10.000  | 45.000   |
| dual_baseline_aug1         | /datasets/aicitychallenge2023/val.json | 79      | 4.256  | 32.901 | 16.000  | 53.000   |
| dual_baseline_aug1         | /datasets/aicitychallenge2023/val.json | 99      | 4.248  | 35.485 | 19.000  | 54.000   |
| dual_baseline_aug1         | /datasets/aicitychallenge2023/val.json | 119     | 4.278  | 36.260 | 19.000  | 60.000   |
| dual_baseline_aug1         | /datasets/aicitychallenge2023/val.json | 139     | 4.258  | 34.736 | 18.000  | 56.000   |
| dual_baseline_aug1         | /datasets/aicitychallenge2023/val.json | 159     | 4.232  | 35.243 | 21.000  | 51.000   |
| dual_baseline_aug1         | /datasets/aicitychallenge2023/val.json | 179     | 4.187  | 43.807 | 26.000  | 69.000   |
| dual_baseline_aug1         | /datasets/aicitychallenge2023/val.json | 199     | 4.184  | 45.585 | 27.000  | 71.000   |
| dual_baseline_aug1         | /datasets/aicitychallenge2023/val.json | 219     | 4.183  | 41.780 | 22.000  | 67.000   |
| dual_baseline_aug1         | /datasets/aicitychallenge2023/val.json | 239     | 4.190  | 44.424 | 26.000  | 68.000   |
| dual_baseline_aug1         | /datasets/aicitychallenge2023/val.json | 259     | 4.200  | 44.491 | 27.000  | 69.000   |
| dual_baseline_aug1         | /datasets/aicitychallenge2023/val.json | 279     | 4.198  | 44.826 | 30.000  | 61.000   |
| dual_baseline_aug1         | /datasets/aicitychallenge2023/val.json | 299     | 4.192  | 46.921 | 32.000  | 69.000   |
| dual_baseline_aug1         | /datasets/aicitychallenge2023/val.json | 319     | 4.192  | 45.967 | 29.000  | 70.000   |
| dual_baseline_aug1         | /datasets/aicitychallenge2023/val.json | 339     | 4.192  | 45.717 | 29.000  | 66.000   |
| dual_baseline_aug1         | /datasets/aicitychallenge2023/val.json | 359     | 4.192  | 44.560 | 26.000  | 70.000   |
| dual_baseline_aug1         | /datasets/aicitychallenge2023/val.json | 379     | 4.192  | 46.114 | 28.000  | 71.000   |
| dual_baseline_aug1         | /datasets/aicitychallenge2023/val.json | 399     | 4.192  | 45.904 | 28.000  | 68.000   |
| dual_baseline_aug1feat_0   | /datasets/aicitychallenge2023/val.json | 400     | 4.352  | 43.592 | 62.000  | 82.000   |
| dual_baseline_aug1feat_1   | /datasets/aicitychallenge2023/val.json | 400     | 4.348  | 37.405 | 53.000  | 74.000   |
| dual_baseline_aug1feat_2   | /datasets/aicitychallenge2023/val.json | 400     | 4.200  | 45.495 | 67.000  | 88.000   |
| dual_baseline_aug1feat_all | /datasets/aicitychallenge2023/val.json | 400     | 3.766  | 45.339 | 68.000  | 89.000   |
| dual_baseline_aug1         | /datasets/aicitychallenge2023/val.json | Max_299 | 4.192  | 46.921 | 32.000  | 69.000   |
Epoch 400 running time:  0:01:53.595329
Logs dir: logs/dual_baseline_aug1 
Total running time:  6:04:24.876586
Logs dir: logs/dual_baseline_aug1 
